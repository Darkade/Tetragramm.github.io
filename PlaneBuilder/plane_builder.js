var WARNING_COLOR;(function(a){a[a.WHITE=0]="WHITE";a[a.YELLOW=1]="YELLOW";a[a.RED=2]="RED"})(WARNING_COLOR||={});
class Stats{constructor(a){this.charge=this.fuel=this.bomb_mass=this.crashsafety=this.upkeep=this.toughness=this.wingarea=this.pitchboost=this.pitchspeed=this.structure=this.maxstrain=this.fuelconsumption=this.power=this.reliability=this.cooling=this.latstab=this.pitchstab=this.escape=this.flightstress=this.visibility=this.reqsections=this.cost=this.control=this.drag=this.mass=this.wetmass=this.liftbleed=0;this.warnings=[];this.era=[];a&&this.fromJSON(a,0)}toJSON(){return{liftbleed:this.liftbleed,
wetmass:this.wetmass,mass:this.mass,drag:this.drag,control:this.control,cost:this.cost,reqsections:this.reqsections,visibility:this.visibility,flightstress:this.flightstress,escape:this.escape,pitchstab:this.pitchstab,latstab:this.latstab,cooling:this.cooling,reliability:this.reliability,power:this.power,fuelconsumption:this.fuelconsumption,maxstrain:this.maxstrain,structure:this.structure,pitchboost:this.pitchboost,pitchspeed:this.pitchspeed,wingarea:this.wingarea,toughness:this.toughness,upkeep:this.upkeep,
crashsafety:this.crashsafety,bomb_mass:this.bomb_mass,fuel:this.fuel,charge:this.charge,warnings:this.warnings,eras:this.era}}fromJSON(a,b){a.liftbleed&&(this.liftbleed=a.liftbleed);a.wetmass&&(this.wetmass=a.wetmass);a.mass&&(this.mass=a.mass);a.drag&&(this.drag=a.drag);a.control&&(this.control=a.control);a.cost&&(this.cost=a.cost);a.reqsections&&(this.reqsections=a.reqsections);a.visibility&&(this.visibility=a.visibility);a.flightstress&&(this.flightstress=a.flightstress);a.escape&&(this.escape=
a.escape);a.pitchstab&&(this.pitchstab=a.pitchstab);a.latstab&&(this.latstab=a.latstab);a.cooling&&(this.cooling=a.cooling);a.reliability&&(this.reliability=a.reliability);a.power&&(this.power=a.power);a.fuelconsumption&&(this.fuelconsumption=a.fuelconsumption);a.maxstrain&&(this.maxstrain=a.maxstrain);a.structure&&(this.structure=a.structure);a.pitchspeed&&(this.pitchspeed=a.pitchspeed);a.pitchboost&&(this.pitchboost=a.pitchboost);a.wingarea&&(this.wingarea=a.wingarea);a.toughness&&(this.toughness=
a.toughness);a.upkeep&&(this.upkeep=a.upkeep);a.crashsafety&&(this.crashsafety=a.crashsafety);a.bomb_mass&&(this.bomb_mass=a.bomb_mass);a.fuel&&(this.fuel=a.fuel);a.charge&&(this.charge=a.charge);a.warning&&this.warnings.push({source:lu(a.name),warning:lu(a.warning),color:WARNING_COLOR.WHITE});if(a.warnings){b=a.warnings;let d=[];for(var c of b)d.push({source:c.source,warning:c.warning});this.warnings=this.MergeWarnings(d)}a.era&&this.era.push({name:lu(a.name),era:lu(a.era)});if(a.eras){a=a.eras;
c=[];for(let d of a)c.push({name:d.name,era:d.era});this.era=this.MergeEra(c)}}serialize(a){a.PushNum(this.liftbleed);a.PushNum(this.wetmass);a.PushNum(this.mass);a.PushNum(this.drag);a.PushNum(this.control);a.PushNum(this.cost);a.PushNum(this.reqsections);a.PushNum(this.visibility);a.PushNum(this.flightstress);a.PushNum(this.escape);a.PushNum(this.pitchstab);a.PushNum(this.latstab);a.PushNum(this.cooling);a.PushNum(this.reliability);a.PushNum(this.power);a.PushNum(this.fuelconsumption);a.PushNum(this.maxstrain);
a.PushNum(this.structure);a.PushFloat(this.pitchboost);a.PushFloat(this.pitchspeed);a.PushNum(this.wingarea);a.PushNum(this.toughness);a.PushNum(this.upkeep);a.PushNum(this.crashsafety);a.PushNum(this.bomb_mass);a.PushNum(this.fuel);a.PushNum(this.charge);a.PushNum(this.warnings.length);for(let b of this.warnings)a.PushString(b.source),a.PushString(b.warning);a.PushNum(this.era.length);for(let b of this.era)a.PushString(b.name),a.PushString(b.era)}deserialize(a){this.liftbleed=a.GetNum();this.wetmass=
a.GetNum();this.mass=a.GetNum();this.drag=a.GetNum();this.control=a.GetNum();this.cost=a.GetNum();this.reqsections=a.GetNum();this.visibility=a.GetNum();this.flightstress=a.GetNum();this.escape=a.GetNum();this.pitchstab=a.GetNum();this.latstab=a.GetNum();this.cooling=a.GetNum();this.reliability=a.GetNum();this.power=a.GetNum();this.fuelconsumption=a.GetNum();this.maxstrain=a.GetNum();this.structure=a.GetNum();this.pitchboost=a.GetFloat();this.pitchspeed=a.GetFloat();this.wingarea=a.GetNum();this.toughness=
a.GetNum();this.upkeep=a.GetNum();this.crashsafety=a.GetNum();this.bomb_mass=a.GetNum();this.fuel=a.GetNum();this.charge=a.GetNum();if(12.25<a.version){var b=a.GetNum();this.warnings=[];for(var c=0;c<b;c++)this.warnings.push({source:a.GetString(),warning:a.GetString(),color:WARNING_COLOR.WHITE});b=a.GetNum();this.era=[];for(c=0;c<b;c++)this.era.push({name:a.GetString(),era:a.GetString()})}}Add(a){var b=new Stats;b.liftbleed=this.liftbleed+a.liftbleed;b.wetmass=this.wetmass+a.wetmass;b.mass=this.mass+
a.mass;b.drag=this.drag+a.drag;b.control=this.control+a.control;b.cost=this.cost+a.cost;b.reqsections=this.reqsections+a.reqsections;b.visibility=this.visibility+a.visibility;b.flightstress=this.flightstress+a.flightstress;b.escape=this.escape+a.escape;b.pitchstab=this.pitchstab+a.pitchstab;b.latstab=this.latstab+a.latstab;b.cooling=this.cooling+a.cooling;b.reliability=this.reliability+a.reliability;b.power=this.power+a.power;b.fuelconsumption=this.fuelconsumption+a.fuelconsumption;b.maxstrain=this.maxstrain+
a.maxstrain;b.structure=this.structure+a.structure;b.pitchboost=this.pitchboost+a.pitchboost;b.pitchspeed=this.pitchspeed+a.pitchspeed;b.wingarea=this.wingarea+a.wingarea;b.toughness=this.toughness+a.toughness;b.upkeep=this.upkeep+a.upkeep;b.crashsafety=this.crashsafety+a.crashsafety;b.bomb_mass=this.bomb_mass+a.bomb_mass;b.fuel=this.fuel+a.fuel;b.charge=this.charge+a.charge;b.warnings=this.MergeWarnings(a.warnings);b.era=this.MergeEra(a.era);return b}MergeWarnings(a){var b=[];for(let c of this.warnings)b.push({source:c.source,
warning:c.warning,color:c.color});for(let c of a){a=!1;for(let d of this.warnings)c.source==d.source&&c.warning==d.warning&&(a=!0);a||b.push({source:c.source,warning:c.warning,color:c.color})}return b}MergeEra(a){var b=[];for(let c of this.era)b.push({name:c.name,era:c.era});for(let c of a){a=!1;for(let d of this.era)c.name==d.name&&c.era==d.era&&(a=!0);a||b.push({name:c.name,era:c.era})}return b}Multiply(a){var b=this.Clone();b.liftbleed=this.liftbleed*a;b.wetmass=this.wetmass*a;b.mass=this.mass*
a;b.drag=this.drag*a;b.control=this.control*a;b.cost=this.cost*a;b.reqsections=this.reqsections*a;b.visibility=this.visibility*a;b.flightstress=this.flightstress*a;b.escape=this.escape*a;b.pitchstab=this.pitchstab*a;b.latstab=this.latstab*a;b.cooling=this.cooling*a;b.reliability=this.reliability*a;b.power=this.power*a;b.fuelconsumption=this.fuelconsumption*a;b.maxstrain=this.maxstrain*a;b.structure=this.structure*a;b.wingarea=this.wingarea*a;b.toughness=this.toughness*a;b.upkeep=this.upkeep*a;b.crashsafety=
this.crashsafety*a;b.bomb_mass=this.bomb_mass*a;b.fuel=this.fuel*a;b.charge=this.charge*a;1E-6<Math.abs(a)&&(b.warnings=this.warnings,b.era=this.era);return b}Equal(a){return this.liftbleed==a.liftbleed&&this.wetmass==a.wetmass&&this.mass==a.mass&&this.drag==a.drag&&this.control==a.control&&this.cost==a.cost&&this.reqsections==a.reqsections&&this.visibility==a.visibility&&this.flightstress==a.flightstress&&this.escape==a.escape&&this.pitchstab==a.pitchstab&&this.latstab==a.latstab&&this.cooling==
a.cooling&&this.reliability==a.reliability&&this.power==a.power&&this.fuelconsumption==a.fuelconsumption&&this.maxstrain==a.maxstrain&&this.structure==a.structure&&this.pitchspeed==a.pitchspeed&&this.pitchboost==a.pitchboost&&this.wingarea==a.wingarea&&this.toughness==a.toughness&&this.upkeep==a.upkeep&&this.crashsafety==a.crashsafety&&this.bomb_mass==a.bomb_mass&&this.fuel==a.fuel&&this.charge==a.charge}rtz(a){return 0<a?Math.floor(1E-6+a):Math.ceil(-1E-6+a)}Round(){this.liftbleed=this.rtz(this.liftbleed);
this.wetmass=this.rtz(this.wetmass);this.mass=this.rtz(this.mass);this.drag=this.rtz(this.drag);this.control=this.rtz(this.control);this.cost=this.rtz(this.cost);this.reqsections=this.rtz(this.reqsections);this.visibility=this.rtz(this.visibility);this.flightstress=this.rtz(this.flightstress);this.escape=this.rtz(this.escape);this.pitchstab=this.rtz(this.pitchstab);this.latstab=this.rtz(this.latstab);this.cooling=this.rtz(this.cooling);this.reliability=this.rtz(this.reliability);this.power=this.rtz(this.power);
this.fuelconsumption=this.rtz(this.fuelconsumption);this.maxstrain=this.rtz(this.maxstrain);this.structure=this.rtz(this.structure);this.wingarea=this.rtz(this.wingarea);this.toughness=this.rtz(this.toughness);this.upkeep=this.rtz(this.upkeep);this.crashsafety=this.rtz(this.crashsafety);this.bomb_mass=this.rtz(this.bomb_mass);this.fuel=this.rtz(this.fuel);this.charge=this.rtz(this.charge)}Clone(){return this.Add(new Stats)}}
var era2numHh=a=>{switch(a){case "Pioneer":return 0;case "WWI":return 1;case "Roaring 20s":return 2;case "Coming Storm":return 3;case "WWII":return 4;case "Last Hurrah":return 5;case "Himmilgard":return 6}},era2numHl=a=>{switch(a){case "Pioneer":return 0;case "WWI":return 1;case "Roaring 20s":return 2;case "Coming Storm":return 3;case "WWII":return 4;case "Last Hurrah":return 5;case "Himmilgard":return-1}},num2era=a=>{switch(a){case 0:return"Pioneer";case 1:return"WWI";case 2:return"Roaring 20s";
case 3:return"Coming Storm";case 4:return"WWII";case 5:return"Last Hurrah";case 6:case -1:return"Himmilgard"}},AIRCRAFT_TYPE;(function(a){a[a.AIRPLANE=0]="AIRPLANE";a[a.HELICOPTER=1]="HELICOPTER";a[a.AUTOGYRO=2]="AUTOGYRO";a[a.ORNITHOPTER_BASIC=3]="ORNITHOPTER_BASIC";a[a.ORNITHOPTER_FLUTTER=4]="ORNITHOPTER_FLUTTER";a[a.ORNITHOPTER_BUZZER=5]="ORNITHOPTER_BUZZER"})(AIRCRAFT_TYPE||={});
function IsAnyOrnithopter(a){return a==AIRCRAFT_TYPE.ORNITHOPTER_BASIC||a==AIRCRAFT_TYPE.ORNITHOPTER_FLUTTER||a==AIRCRAFT_TYPE.ORNITHOPTER_BUZZER}class Part{FormatEquipment(a,b,c){.5<Math.abs(c)?a.push({source:lu(b),charge:c.toString()}):0<c&&1E-6>c&&a.push({source:lu(b),charge:"-"});return a}}
function MergeElectrics(a,b){for(let c=0;c<b.equipment.length;c++){let d=!1;for(let e=0;e<a.equipment.length;e++)if(a.equipment[e].source==b.equipment[c].source&&!isNaN(parseInt(a.equipment[e].charge))){a.equipment[e].charge=(parseInt(a.equipment[e].charge)+parseInt(b.equipment[c].charge)).toString();d=!0;break}d||a.equipment.push(b.equipment[c])}return{storage:a.storage+b.storage,equipment:a.equipment}}
class Localization{constructor(a){this.lang="en";this.languages=a}GetLanguages(){var a=[];for(let b of this.languages.languages)a.push(b);return a}SetLanguages(a){this.languages[a]&&(this.lang=a)}e(a){if(this.languages[this.lang][a])return this.languages[this.lang][a];if(this.languages.en[a])return this.languages.en[a];console.error("Failed to find "+a);return"!"+a+"!"}}function lu(a,...b){return StringFmt.Format(local.e(a),...b)}
class Serialize{constructor(a){this.array=new ArrayBuffer(51200);this.view=new DataView(this.array);this.offset=0}Check(){if(this.offset>=this.array.byteLength)throw"Serialization Way too long.";}PushNum(a){this.view.setInt16(this.offset,a,!1);this.offset+=2;this.Check()}PushBool(a){a?this.view.setUint8(this.offset,1):this.view.setUint8(this.offset,0);this.offset+=1;this.Check()}PushString(a){this.PushNum(a.length);for(let b=0;b<a.length;b++)this.view.setUint8(this.offset,a.charCodeAt(b)),this.offset++;
this.Check()}PushNumArr(a){this.PushNum(a.length);for(let b of a)this.PushNum(b);this.Check()}PushBoolArr(a){this.PushNum(a.length);for(let b of a)this.PushBool(b);this.Check()}PushFloat(a){this.view.setFloat32(this.offset,a,!1);this.offset+=4;this.Check()}FinalArray(){return this.array.slice(0,this.offset)}}
class Deserialize{constructor(a){this.array=a;this.view=new DataView(this.array);this.offset=0;this.version=parseFloat(this.GetString());this.Reset()}Reset(){this.offset=0}Check(){if(this.offset>=this.array.byteLength)throw"Deserialization Failed";}GetNum(){this.Check();var a=this.view.getInt16(this.offset,!1);this.offset+=2;return a}GetBool(){this.Check();var a=this.view.getUint8(this.offset);this.offset+=1;return 0<a}GetString(){this.Check();var a=this.GetNum(),b=[];for(let d=0;d<a;d++){var c=this.view.getUint8(this.offset);
b.push(c);this.offset+=1}return String.fromCharCode(...b)}GetNumArr(a){this.Check();var b=this.GetNum(),c=[];for(let d=0;d<b;d++)c.push(this.GetNum());for(;c.length<a;)c.push(0);return c}GetBoolArr(a){this.Check();var b=this.GetNum(),c=[];for(let d=0;d<b;d++)c.push(this.GetBool());for(;c.length<a;)c.push(!1);return c}GetFloat(){this.Check();var a=this.view.getFloat32(this.offset,!1);this.offset+=4;return a}CheckLastNum(){return this.view.getInt16(this.array.byteLength-2,!1)}}
function NumArr(a,b){for(;a.length<b;)a.push(0);return a}function BoolArr(a,b){for(;a.length<b;)a.push(!1);return a}var CompressorEnum;(function(a){a[a.NONE=0]="NONE";a[a.ALTITUDE_THROTTLE=1]="ALTITUDE_THROTTLE";a[a.SUPERCHARGER=2]="SUPERCHARGER";a[a.TURBOCHARGER=3]="TURBOCHARGER"})(CompressorEnum||={});
class EngineBuilder{constructor(){this.EraTable=[{name:"Pioneer",materials:3,cost:.5,maxRPM:30,powerdiv:8,fuelfactor:10},{name:"WWI",materials:2,cost:1,maxRPM:35,powerdiv:7,fuelfactor:8},{name:"Roaring 20s",materials:1.5,cost:2,maxRPM:40,powerdiv:6.8,fuelfactor:6},{name:"Coming Storm",materials:1.35,cost:2.25,maxRPM:45,powerdiv:6.6,fuelfactor:5},{name:"WWII",materials:1.25,cost:2.5,maxRPM:50,powerdiv:6.5,fuelfactor:4},{name:"Last Hurrah",materials:1,cost:3,maxRPM:50,powerdiv:6.2,fuelfactor:2}];this.CoolingTable=
[{name:"Liquid Cooled",forcefactor:1.2,RPMoff:0,thrustfactor:1,radiator:1,massfactor:1},{name:"Air Cooled",forcefactor:1,RPMoff:0,thrustfactor:1,radiator:0,massfactor:1},{name:"Rotary",forcefactor:1,RPMoff:8,thrustfactor:1.5,radiator:0,massfactor:1},{name:"Contrarotary",forcefactor:1,RPMoff:8,thrustfactor:1.25,radiator:0,massfactor:1},{name:"Semi-Radial",forcefactor:.8,RPMoff:0,thrustfactor:1,radiator:0,massfactor:1},{name:"Liquid Radial",forcefactor:1,RPMoff:0,thrustfactor:1,radiator:2.5,massfactor:1.3}];
this.CompressorTable=[{name:"None"},{name:"Altitude Throttle"},{name:"Supercharger"},{name:"Turbocharger"}];this.Upgrades=[{name:"Asperator Boost",powerfactor:.11,fuelfactor:0,massfactor:0,dragfactor:0,idealalt:-1,costfactor:3,reqsection:!1},{name:"War Emergency Power",powerfactor:0,fuelfactor:0,massfactor:0,dragfactor:0,idealalt:0,costfactor:5,reqsection:!1},{name:"Fuel Injector",powerfactor:0,fuelfactor:-.1,massfactor:0,dragfactor:0,idealalt:0,costfactor:2,reqsection:!1},{name:"Diesel",powerfactor:-.2,
fuelfactor:-.5,massfactor:0,dragfactor:0,idealalt:0,costfactor:0,reqsection:!1}];this.name="Default Name";this.cool_sel=this.era_sel=0;this.upg_sel=[...Array(this.Upgrades.length).fill(!1)];this.engine_displacement=1;this.compression_ratio=this.num_rows=this.num_cyl_per_row=2;this.quality_fudge=this.material_fudge=this.rpm_boost=1;this.compressor_type=CompressorEnum.NONE;this.min_IAF=this.compressor_count=0;this.rarity=ENGINE_RARITY.CUSTOM}CanUpgrade(){var a=[...Array(this.Upgrades.length).fill(!0)];
a[0]=!1;this.compressor_type==CompressorEnum.ALTITUDE_THROTTLE&&(a[0]=!1,a[1]=!1,a[2]=!1);return a}UpgradePower(){var a=1;for(let b=0;b<this.upg_sel.length;b++)this.upg_sel[b]&&(a+=this.Upgrades[b].powerfactor);this.upg_sel[0]&&(a*=1+this.Upgrades[0].powerfactor);return a}RPM(){return this.compression_ratio/10*(this.EraTable[this.era_sel].maxRPM-this.CoolingTable[this.cool_sel].RPMoff)}GearedRPM(){return this.RPM()*this.rpm_boost}CalcPower(){var a=this.EraTable[this.era_sel],b=this.engine_displacement*
this.compression_ratio*this.CoolingTable[this.cool_sel].forcefactor*this.UpgradePower()*(this.GearedRPM()/10);return Math.floor(1E-6+b/a.powerdiv)}UpgradeMass(){var a=1;for(let b=0;b<this.upg_sel.length;b++)this.upg_sel[b]&&(a+=this.Upgrades[b].massfactor);return a}CalcMass(){var a=this.CoolingTable[this.cool_sel];return Math.floor(1E-6+(Math.pow(this.engine_displacement,2)*this.compression_ratio/1E3+(this.engine_displacement*this.num_rows/10+1)+this.engine_displacement/5)*this.UpgradeMass()*this.material_fudge*
a.massfactor)}UpgradeDrag(){var a=1;for(let b=0;b<this.upg_sel.length;b++)this.upg_sel[b]&&(a+=this.Upgrades[b].dragfactor);return a}CoolDrag(){switch(this.CoolingTable[this.cool_sel].name){case "Liquid Cooled":return 1;case "Air Cooled":return 1;case "Rotary":return this.GearedRPM()/10;case "Contrarotary":return this.GearedRPM()/8;case "Semi-Radial":return 1;case "Liquid Radial":return 1.2}throw"Error in CoolDrag, no valid switch case.";}CalcDrag(){return Math.floor(1E-6+(3+this.engine_displacement/
this.num_rows/3)*this.CoolDrag()*this.UpgradeDrag())}CoolBurnout(){var a=this.EraTable[this.era_sel].materials/2;switch(this.CoolingTable[this.cool_sel].name){case "Liquid Cooled":return 2;case "Air Cooled":return(2+Math.pow(this.num_rows,2))*a;case "Rotary":return Math.pow(this.num_rows,2)/(this.GearedRPM()/10);case "Contrarotary":return Math.pow(this.num_rows,2)/(this.GearedRPM()/10);case "Semi-Radial":return(2+Math.pow(this.num_rows,2)/2)*a;case "Liquid Radial":return.5}throw"Error in CoolBurnout, no valid switch case.";
}MaterialModifier(){return this.engine_displacement/(this.num_cyl_per_row*this.num_rows)*this.rpm_boost*Math.pow(this.compression_ratio,2)*this.EraTable[this.era_sel].materials*this.CoolBurnout()*this.rpm_boost}IsRotary(){return"Rotary"==this.CoolingTable[this.cool_sel].name||"Contrarotary"==this.CoolingTable[this.cool_sel].name?!0:!1}CalcCooling(){return this.IsRotary()?0:Math.floor(1E-6+this.MaterialModifier()/20*this.CoolingTable[this.cool_sel].radiator)}CalcOverspeed(){return Math.round(1.5*this.RPM())}UpgradeFuel(){var a=
1;for(let b=0;b<this.upg_sel.length;b++)this.upg_sel[b]&&(a+=this.Upgrades[b].fuelfactor);return a*this.EraTable[this.era_sel].fuelfactor}CalcFuelConsumption(){var a=this.engine_displacement*this.RPM()/100;return Math.floor(1E-6+a*this.UpgradeFuel())}CalcAltitude(){var a=0;for(let b=0;b<this.upg_sel.length;b++)this.upg_sel[b]&&(a+=this.Upgrades[b].idealalt);return 10*(3+a)-1}CoolTorque(){return"Rotary"==this.CoolingTable[this.cool_sel].name?this.CalcMass():"Contrarotary"==this.CoolingTable[this.cool_sel].name?
Math.floor(1E-6+this.CalcMass()/2):1}CalcTorque(){return Math.floor(1E-6+this.CoolTorque()*this.GearedRPM()/5/4)}UpgradeCost(){var a=0;for(let b=0;b<this.upg_sel.length;b++)this.upg_sel[b]&&(a+=this.Upgrades[b].costfactor);return a}CalcCost(){var a=this.EraTable[this.era_sel],b=this.CoolingTable[this.cool_sel],c=Math.max(1,this.quality_fudge),d=this.engine_displacement*this.compression_ratio/10;d=this.UpgradeCost()+d;a=c*a.cost*d;0<b.radiator&&(a*=1.4);return Math.floor(1E-6+a)}VerifyValues(){this.engine_displacement=
Math.max(.01,this.engine_displacement);this.engine_displacement=Math.min(150,this.engine_displacement);this.era_sel=Math.max(0,Math.min(this.EraTable.length-1,this.era_sel));this.cool_sel=Math.max(0,Math.min(this.CoolingTable.length-1,this.cool_sel));this.num_cyl_per_row=Math.floor(Math.max(1,this.num_cyl_per_row));this.num_rows=Math.floor(Math.max(1,this.num_rows));this.compression_ratio=Math.max(.01,this.compression_ratio);this.compression_ratio=Math.min(25,this.compression_ratio);this.rpm_boost=
Math.max(.1,this.rpm_boost);this.rpm_boost=Math.min(2,this.rpm_boost);this.material_fudge=Math.max(.1,this.material_fudge);this.material_fudge=Math.min(2,this.material_fudge);this.quality_fudge=Math.max(.1,this.quality_fudge);for(this.quality_fudge=Math.min(2,this.quality_fudge);-.9>this.material_fudge-1+(this.quality_fudge-1);)this.material_fudge+=.1,this.quality_fudge+=.1;this.min_IAF=10*Math.round(1E-6+this.min_IAF/10);this.compressor_count=Math.floor(1E-6+this.compressor_count);this.compressor_count=
Math.min(5,this.compressor_count);this.compressor_type==CompressorEnum.NONE?this.min_IAF=this.compressor_count=0:this.compressor_type==CompressorEnum.ALTITUDE_THROTTLE?(this.compressor_count=1,this.min_IAF=0,this.upg_sel[0]=!1,this.upg_sel[1]=!1,this.upg_sel[2]=!1):(this.min_IAF=Math.max(0,this.min_IAF),this.compressor_count=Math.max(1,this.compressor_count))}EngineStats(){var a=new EngineStats;a.name=this.name;this.VerifyValues();a.stats.power=this.CalcPower();a.stats.mass=this.CalcMass();a.stats.drag=
this.CalcDrag();a.stats.reliability=Math.floor(-1.999999+this.era_sel+10*(this.quality_fudge+this.material_fudge-2));a.stats.cooling=this.CalcCooling();a.oiltank=this.IsRotary();a.overspeed=this.CalcOverspeed();a.stats.fuelconsumption=this.CalcFuelConsumption();a.altitude=this.CalcAltitude();a.torque=this.CalcTorque();a.stats.cost=this.CalcCost();a.pulsejet=!1;a.rumble=0;a.stats.era.push({name:this.name,era:lu(num2era(this.era_sel))});switch(this.compressor_type){case CompressorEnum.ALTITUDE_THROTTLE:a.stats.cost+=
3;a.altitude=49;a.stats.warnings.push({source:lu("Altitude Throttle"),warning:lu("Altitude Throttle Warning"),color:WARNING_COLOR.WHITE});break;case CompressorEnum.SUPERCHARGER:a.stats.power=Math.floor(1E-6+1.25*a.stats.power);a.stats.fuelconsumption=Math.floor(1E-6+1.25*a.stats.fuelconsumption);a.stats.mass=Math.floor(1E-6+1.2*a.stats.mass);a.stats.drag+=this.min_IAF/10;a.stats.cost+=1+Math.floor(1E-6+a.stats.power/50);var b=this.compressor_count-1;a.altitude=29+20*b;a.stats.reliability-=b;a.stats.mass+=
b;a.stats.drag+=b;a.stats.cost+=2*b;break;case CompressorEnum.TURBOCHARGER:a.stats.power=Math.floor(1E-6+1.25*a.stats.power),a.stats.mass=Math.floor(1E-6+1.2*a.stats.mass),a.stats.drag+=this.min_IAF/10*2,a.stats.cost+=1+Math.floor(1E-6+a.stats.power/50),b=this.compressor_count-1,a.altitude=49+20*b,a.stats.reliability-=b,a.stats.mass+=b,a.stats.drag+=b,a.stats.cost+=2*b,a.stats.reqsections+=1}a.stats.fuelconsumption=Math.max(1,a.stats.fuelconsumption);a.rarity=this.rarity;return a}EngineInputs(){var a=
new EngineInputs;a.engine_type=ENGINE_TYPE.PROPELLER;a.RPM_boost=this.rpm_boost;a.compression=this.compression_ratio;a.compressor_count=this.compressor_count;a.compressor_type=this.compressor_type;a.cyl_per_row=this.num_cyl_per_row;a.displacement=this.engine_displacement;a.era_sel=this.era_sel;a.material_fudge=this.material_fudge;a.min_IdealAlt=this.min_IAF;a.name=this.name;a.quality_fudge=this.quality_fudge;a.rows=this.num_rows;a.type=this.cool_sel;for(let b=0;b<a.upgrades.length;b++)a.upgrades[b]=
this.upg_sel[b];a.rarity=this.rarity;return a}fromJSON(a){this.engine_displacement=a.displacement;this.compression_ratio=a.compression;this.cool_sel=a.type;this.num_cyl_per_row=a.cyl_per_row;this.num_rows=a.rows;this.rpm_boost=a.RPM_boost;this.era_sel=a.era_sel;this.material_fudge=a.material_fudge;this.quality_fudge=a.quality_fudge;this.compressor_type=a.compressor_type;this.compressor_count=a.compressor_count;this.min_IAF=a.min_IAF;this.upg_sel=BoolArr(a.upgrades,this.upg_sel.length);this.rarity=
a.rarity?a.rarity:ENGINE_RARITY.CUSTOM;return this.EngineStats()}}
class PulsejetBuilder{constructor(){this.EraTable=[{name:"Pioneer",cost:1,drag:10,mass:10,fuel:4,vibe:2.5,material:2},{name:"WWI",cost:.75,drag:25,mass:24,fuel:3,vibe:3,material:3},{name:"Roaring 20s",cost:.5,drag:30,mass:50,fuel:2,vibe:4,material:9},{name:"Coming Storm",cost:.5,drag:30,mass:50,fuel:2,vibe:4,material:9},{name:"WWII",cost:.25,drag:40,mass:100,fuel:1,vibe:5,material:24},{name:"Last Hurrah",cost:.1,drag:50,mass:150,fuel:.7,vibe:6,material:50}];this.ValveTable=[{name:"Valved",scale:1,
rumble:1,designcost:2,reliability:1},{name:"Valveless",scale:1.1,rumble:.9,designcost:1,reliability:3}];this.desired_power=1;this.era_sel=this.valve_sel=0;this.overall_quality=this.build_quality=1;this.starter=!1;this.rarity=ENGINE_RARITY.CUSTOM}TempMass(){var a=this.EraTable[this.era_sel],b=this.ValveTable[this.valve_sel],c=0;this.starter&&(c=1);return this.technical_power/a.mass*b.scale+c}CalcMass(){return Math.floor(1E-6+this.TempMass())+1}CalcDrag(){var a=this.technical_power/this.EraTable[this.era_sel].drag*
this.ValveTable[this.valve_sel].scale+1;return Math.floor(1E-6+this.TempMass()+a+1)}CalcReliability(){return Math.trunc(-(this.technical_power/(this.EraTable[this.era_sel].material*this.ValveTable[this.valve_sel].reliability*this.overall_quality)-1))}CalcFuelConsumption(){return Math.floor(1E-6+this.technical_power*this.EraTable[this.era_sel].fuel)}CalcRumble(){return Math.floor(1E-6+this.technical_power*this.ValveTable[this.valve_sel].rumble/(2*this.EraTable[this.era_sel].vibe))}CalcCost(){var a=
this.EraTable[this.era_sel];return Math.floor(1E-6+this.TempMass()*this.build_quality*a.cost)+1}VerifyValues(){this.desired_power=Math.max(1,Math.floor(this.desired_power));this.valve_sel=Math.max(0,Math.min(this.ValveTable.length-1,this.valve_sel));this.era_sel=Math.max(0,Math.min(this.EraTable.length-1,this.era_sel));this.build_quality=Math.max(.01,this.build_quality);this.overall_quality=Math.max(.01,this.overall_quality);this.overall_quality=this.build_quality=Math.max(this.build_quality,this.overall_quality)}DesignCost(){var a=
this.EraTable[this.era_sel],b=this.ValveTable[this.valve_sel],c=0;this.starter&&(c=3);return Math.floor(1.000001+this.build_quality*(this.technical_power*a.cost/b.designcost+c))}EngineInputs(){var a=new EngineInputs,b="";0==this.valve_sel&&(b="V");a.name="Pulsejet P"+b+"-"+this.desired_power.toString()+" ("+this.EraTable[this.era_sel].name+")";a.engine_type=ENGINE_TYPE.PULSEJET;a.era_sel=this.era_sel;a.type=this.valve_sel;a.power=this.desired_power;a.starter=this.starter;a.quality_cost=this.build_quality;
a.quality_rely=this.overall_quality;a.rarity=this.rarity;return a}EngineStats(){var a=new EngineStats;this.VerifyValues();var b="";0==this.valve_sel&&(b="V");a.name="Pulsejet P"+b+"-"+this.desired_power.toString()+" ("+this.EraTable[this.era_sel].name+")";this.technical_power=a.stats.power=this.desired_power;a.stats.mass=this.CalcMass();a.stats.drag=this.CalcDrag();a.stats.reliability=this.CalcReliability();a.stats.fuelconsumption=this.CalcFuelConsumption();a.rumble=this.CalcRumble();a.stats.cost=
this.CalcCost();a.overspeed=100;a.altitude=29;a.pulsejet=!0;a.stats.era.push({name:a.name,era:lu(num2era(this.era_sel))});a.rarity=this.rarity;return a}}
class TurboBuilder{constructor(){this.TypeTable=[{name:"Turbojet",efficiency:0,massfactor:.8,costfactor:1},{name:"Turbofan",efficiency:0,massfactor:1,costfactor:1},{name:"Propfan",efficiency:-9,massfactor:.8,costfactor:1},{name:"Turboprop",efficiency:-3,massfactor:.8,costfactor:1}];this.EraTable=[{name:"Gen 1 1945-1955",max_temp:1100,efficiency:-2,costfactor:.5},{name:"Gen 1.5 1955-1965",max_temp:1100,efficiency:-1,costfactor:.6},{name:"Gen 2 1965-1975",max_temp:1400,efficiency:-1,costfactor:.7},
{name:"Gen 2.5 1975-1985",max_temp:1400,efficiency:0,costfactor:.8},{name:"Gen 3 1985-1995",max_temp:1800,efficiency:0,costfactor:.9},{name:"Gen 3.5 1995-2005",max_temp:1800,efficiency:1,costfactor:1},{name:"Gen 4 2005-2015",max_temp:2E3,efficiency:1,costfactor:1.1},{name:"Gen 4.5 2015-2025",max_temp:2E3,efficiency:2,costfactor:1.2},{name:"Gen 0 Himmilgard",max_temp:800,efficiency:-10,costfactor:.5}];this.name="Default";this.type_sel=this.era_sel=0;this.fuel_heat_value=43020;this.flow_adjustment=
0;this.diameter=.89;this.compression_ratio=3.5;this.bypass_ratio=0;this.afterburner=!1;this.rarity=ENGINE_RARITY.CUSTOM}TempMass(){return Math.log2(this.compression_ratio)*Math.PI*Math.pow(this.diameter/2,2)*633.0625/(1+this.bypass_ratio/3)*.75*this.TypeTable[this.type_sel].massfactor}CalcMass(){var a=this.TempMass();1==this.type_sel&&(a*=.4833*Math.log(this.compression_ratio)-.3168);a=a/25+95.684*this.flow_adjustment;if(2==this.type_sel||3==this.type_sel){var b=.5-this.flow_adjustment;a=Math.abs(a)*
(19.74*Math.pow(b,3)-11.462*b*b+1.0666*b+.4333)}return Math.max(1,Math.floor(1E-6+a))}CalcDrag(){return Math.floor(1E-6+5*Math.PI*Math.pow(this.diameter/2,2))}CalcReliability(){return Math.trunc(-Math.log2(this.compression_ratio)-20*this.flow_adjustment+1)}CalcStages(){var a=this.EraTable[this.era_sel];const b=.8+(a.efficiency+this.TypeTable[this.type_sel].efficiency)/20+this.flow_adjustment;var c=1+(1.4-1)/2*0,d=a.max_temp/288.15,e=Math.pow(this.compression_ratio,1-1/1.4),f=289.8789/this.fuel_heat_value*
(a.max_temp/288.15-288.15*Math.pow(108.9*this.compression_ratio/108.9,(1.4-1)/1.4)/288.15);c=340.3*(Math.sqrt(2*c/(1.4-1)*(d/(c*e)-1)*(e-1)+d/(c*e)*0)-0)*b/1E3/(1+this.bypass_ratio)+340.3*(Math.sqrt(2/(1.4-1)*(c*Math.pow(1.6,1-1/1.4)-1))-0)*b/1E3*this.bypass_ratio/(1+this.bypass_ratio);d=f/((1+this.bypass_ratio)*c)*1E3;f=108.9*Math.PI*Math.pow(this.diameter/2,2)*this.MFP(1)/(1+f);a=this.compression_ratio*f*Math.sqrt(1/a.max_temp)*b;if(!isFinite(c)||!isFinite(a)||!isFinite(d)||0>c||0>a||0>d)d=a=c=
0;return{thrust:c*a,fuel:d*c*a}}MFP(a){return Math.sqrt(1.4/.287058)*a*Math.pow(1+(1.4-1)/2*a*a,2.4/(2*(1.4-1)))}CalcCost(){var a=this.EraTable[this.era_sel],b=this.TypeTable[this.type_sel];return Math.floor(1E-6+.5*this.TempMass()*(1+this.flow_adjustment)*a.costfactor*b.costfactor)+1}VerifyValues(){this.era_sel=Math.max(0,Math.min(this.EraTable.length-1,this.era_sel));this.type_sel=Math.max(0,Math.min(this.TypeTable.length-1,this.type_sel));this.flow_adjustment=Math.max(-.5,Math.min(.5,this.flow_adjustment));
this.diameter=Math.max(.1,this.diameter);this.compression_ratio=Math.max(1,this.compression_ratio);this.bypass_ratio=Math.max(0,this.bypass_ratio);this.bypass_ratio=Math.min(20,this.bypass_ratio);2<this.type_sel&&(this.afterburner=!1)}EngineInputs(){var a=new EngineInputs;a.name=this.name;a.engine_type=ENGINE_TYPE.TURBOMACHINERY;a.era_sel=this.era_sel;a.type=this.type_sel;a.flow_adjustment=this.flow_adjustment;a.diameter=this.diameter;a.compression_ratio=this.compression_ratio;a.bypass_ratio=this.bypass_ratio;
a.upgrades[0]=this.afterburner;a.rarity=this.rarity;return a}GetPitchSpeed(){return 8<=this.bypass_ratio?1:3.5<=this.bypass_ratio?1.1:1<=this.bypass_ratio?1.2:1.3}EngineStats(){var a=new EngineStats;this.VerifyValues();var b=this.CalcStages();this.kN=b.thrust;this.tsfc=b.fuel/b.thrust;a.name=this.name;a.stats.power=Math.round(1E3*b.thrust/89);a.stats.mass=this.CalcMass();a.stats.drag=this.CalcDrag();a.stats.reliability=this.CalcReliability();a.stats.fuelconsumption=Math.round(200*b.fuel/1E3);a.rumble=
0;a.stats.cost=this.CalcCost();a.overspeed=100;a.altitude=59;8==this.era_sel?a.stats.era.push({name:a.name,era:lu(num2era(-1))}):a.stats.era.push({name:a.name,era:lu(num2era(5))});a.stats.pitchspeed=this.GetPitchSpeed();a.rarity=this.rarity;return a}}
class ElectricBuilder{constructor(){this.EraTable=[{name:"Pioneer",draw:3,drawfactor:.4,massfactor:.4,reliability:-1,costfactor:.4,overspeed:20},{name:"WWI",draw:1,drawfactor:.4,massfactor:1/3,reliability:0,costfactor:1/2.25,overspeed:25},{name:"Roaring 20s",draw:1,drawfactor:2/7,massfactor:2/7,reliability:1,costfactor:.5,overspeed:30},{name:"Coming Storm",draw:0,drawfactor:2/7,massfactor:.25,reliability:2,costfactor:1/1.9,overspeed:35},{name:"WWII",draw:0,drawfactor:.25,massfactor:.2,reliability:3,
costfactor:1/1.8,overspeed:40},{name:"Last Hurrah",draw:0,drawfactor:.2,massfactor:1/6,reliability:4,costfactor:1/1.75,overspeed:45}];this.Winding=[{name:"Aluminum",drawmod:1.1,mass:-2,drag:1,costfactor:1,reliabilty:0},{name:"Copper",drawmod:1,mass:0,drag:0,costfactor:1,reliabilty:0},{name:"Silver",drawmod:.95,mass:1,drag:0,costfactor:1.1,reliabilty:0},{name:"Electrum",drawmod:.9,mass:2,drag:0,costfactor:1.3,reliabilty:1},{name:"Platinum",drawmod:.75,mass:3,drag:0,costfactor:2,reliabilty:2},{name:"Screamer Sinew",
drawmod:.9,mass:0,drag:1,costfactor:1.75,reliabilty:4},{name:"Lightning Sprite Ephemera",drawmod:.5,mass:-2,drag:-2,costfactor:2,reliabilty:-3}];this.name="Default";this.winding_sel=this.era_sel=0;this.quality_fudge=this.chonk=this.power=1}EraMass(){return Math.floor(1E-6+this.EraTable[this.era_sel].massfactor*this.power)}CalcMass(){var a=this.Winding[this.winding_sel];return Math.max(0,Math.floor(1E-6+this.EraMass()+a.mass))}CalcDrag(){return Math.max(1,Math.floor(1.000001+this.power/10+this.chonk+
this.Winding[this.winding_sel].drag))}CalcOverspeed(){return Math.ceil(-1E-6+this.EraTable[this.era_sel].overspeed-this.chonk/2+7.5*(this.quality_fudge-1))}CalcDraw(){var a=this.EraTable[this.era_sel];return Math.ceil(-1E-6+(a.draw+Math.ceil(-1E-6+this.power*a.drawfactor))*this.Winding[this.winding_sel].drawmod)}CalcReliability(){return Math.trunc(1E-6+this.EraTable[this.era_sel].reliability+this.chonk-this.power/10+5*(this.quality_fudge-1))+this.Winding[this.winding_sel].reliabilty}CalcTorque(){var a=
1+this.EraMass()/10+this.chonk/4;return Math.max(1,Math.floor(1E-6+a))}CalcCost(){return Math.ceil(-1E-6+Math.ceil(-1E-6+this.EraTable[this.era_sel].costfactor*this.power*Math.max(.5,this.quality_fudge))*this.Winding[this.winding_sel].costfactor)}VerifyValues(){this.era_sel=Math.max(0,Math.min(this.EraTable.length-1,this.era_sel));this.winding_sel=Math.max(0,Math.min(this.Winding.length-1,this.winding_sel));this.power=Math.max(1,this.power);this.power=Math.floor(1E-6+this.power);this.chonk=Math.floor(1E-6+
this.chonk);this.chonk=Math.max(-10,this.chonk);this.chonk=Math.min(10,this.chonk);this.quality_fudge=Math.max(.5,this.quality_fudge);this.quality_fudge=Math.min(2,this.quality_fudge)}EngineStats(){var a=new EngineStats;a.name=this.name;this.VerifyValues();a.stats.power=this.power;a.stats.mass=this.CalcMass();a.stats.drag=this.CalcDrag();a.stats.reliability=this.CalcReliability();a.stats.cooling=0;a.oiltank=!1;a.overspeed=this.CalcOverspeed();a.stats.fuelconsumption=0;a.stats.charge=-this.CalcDraw();
a.altitude=100;a.torque=this.CalcTorque();a.stats.cost=this.CalcCost();a.pulsejet=!1;a.rumble=0;a.stats.era.push({name:this.name,era:lu(num2era(this.era_sel))});return a}EngineInputs(){var a=new EngineInputs;a.engine_type=ENGINE_TYPE.ELECTRIC;a.name=this.name;a.power=this.power;a.era_sel=this.era_sel;a.winding_sel=this.winding_sel;a.material_fudge=this.chonk;a.quality_fudge=this.quality_fudge;return a}}var ENGINE_TYPE;
(function(a){a[a.PROPELLER=0]="PROPELLER";a[a.PULSEJET=1]="PULSEJET";a[a.TURBOMACHINERY=2]="TURBOMACHINERY";a[a.ELECTRIC=3]="ELECTRIC"})(ENGINE_TYPE||={});var ENGINE_RARITY;(function(a){a[a.CUSTOM=0]="CUSTOM";a[a.COMMON=1]="COMMON";a[a.RARE=2]="RARE";a[a.LEGENDARY=3]="LEGENDARY"})(ENGINE_RARITY||={});
class EngineInputs{constructor(a){this.name="Default";this.engine_type=ENGINE_TYPE.PROPELLER;this.era_sel=this.type=0;this.rarity=ENGINE_RARITY.CUSTOM;this.min_IdealAlt=this.compressor_count=this.compressor_type=this.quality_fudge=this.material_fudge=this.RPM_boost=this.rows=this.cyl_per_row=this.compression=this.displacement=0;this.upgrades=[...Array(4).fill(!1)];this.quality_rely=this.quality_cost=this.power=0;this.starter=!1;this.winding_sel=this.bypass_ratio=this.compression_ratio=this.diameter=
this.flow_adjustment=0;a&&this.fromJSON(a)}toJSON(){switch(this.engine_type){case ENGINE_TYPE.PROPELLER:return{name:this.name,engine_type:this.engine_type,type:this.type,era_sel:this.era_sel,displacement:this.displacement,compression:this.compression,cyl_per_row:this.cyl_per_row,rows:this.rows,RPM_boost:this.RPM_boost,material_fudge:this.material_fudge,quality_fudge:this.quality_fudge,compressor_type:this.compressor_type,compressor_count:this.compressor_count,min_IAF:this.min_IdealAlt,upgrades:this.upgrades,
rarity:this.rarity};case ENGINE_TYPE.PULSEJET:return{name:this.name,engine_type:this.engine_type,type:this.type,era_sel:this.era_sel,power:this.power,quality_cost:this.quality_cost,quality_rely:this.quality_rely,starter:this.starter,rarity:this.rarity};case ENGINE_TYPE.TURBOMACHINERY:return{name:this.name,engine_type:this.engine_type,type:this.type,era_sel:this.era_sel,flow_adjustment:this.flow_adjustment,diameter:this.diameter,compression_ratio:this.compression_ratio,bypass_ratio:this.bypass_ratio,
upgrades:this.upgrades,rarity:this.rarity};case ENGINE_TYPE.ELECTRIC:return{name:this.name,engine_type:this.engine_type,power:this.power,era_sel:this.era_sel,winding_sel:this.winding_sel,diameter:this.diameter,material_fudge:this.material_fudge,quality_fudge:this.quality_fudge};default:throw"EngineInputs.toJSON: Oh dear, you have a new engine type.";}}fromJSON(a){this.name=a.name;this.engine_type=a.engine_type;this.type=a.type;this.era_sel=a.era_sel;switch(this.engine_type){case ENGINE_TYPE.PROPELLER:this.displacement=
a.displacement;this.compression=a.compression;this.cyl_per_row=a.cyl_per_row;this.rows=a.rows;this.RPM_boost=a.RPM_boost;this.material_fudge=a.material_fudge;this.quality_fudge=a.quality_fudge;this.compressor_type=a.compressor_type;this.compressor_count=a.compressor_count;this.min_IdealAlt=a.min_IAF;this.upgrades=BoolArr(a.upgrades,this.upgrades.length);break;case ENGINE_TYPE.PULSEJET:this.power=a.power;this.quality_cost=a.quality_cost;this.quality_rely=a.quality_rely;this.starter=a.starter;break;
case ENGINE_TYPE.TURBOMACHINERY:this.flow_adjustment=a.flow_adjustment;this.diameter=a.diameter;this.compression_ratio=a.compression_ratio;this.bypass_ratio=a.bypass_ratio;this.upgrades=a.upgrades;break;case ENGINE_TYPE.ELECTRIC:this.power=a.power;this.winding_sel=a.winding_sel;this.material_fudge=a.material_fudge;this.quality_fudge=a.quality_fudge;break;default:throw"EngineInputs.fromJSON: Oh dear, you have a new engine type.";}this.rarity=a.rarity?a.rarity:ENGINE_RARITY.CUSTOM}serialize(a){a.PushString(this.name);
a.PushNum(this.engine_type);a.PushNum(this.type);a.PushNum(this.era_sel);switch(this.engine_type){case ENGINE_TYPE.PROPELLER:a.PushFloat(this.displacement);a.PushFloat(this.compression);a.PushNum(this.cyl_per_row);a.PushNum(this.rows);a.PushFloat(this.RPM_boost);a.PushFloat(this.material_fudge);a.PushFloat(this.quality_fudge);a.PushNum(this.compressor_type);a.PushNum(this.compressor_count);a.PushNum(this.min_IdealAlt);a.PushBoolArr(this.upgrades);break;case ENGINE_TYPE.PULSEJET:a.PushNum(this.power);
a.PushFloat(this.quality_cost);a.PushFloat(this.quality_rely);a.PushBool(this.starter);break;case ENGINE_TYPE.TURBOMACHINERY:a.PushFloat(this.flow_adjustment);a.PushFloat(this.diameter);a.PushFloat(this.compression_ratio);a.PushFloat(this.bypass_ratio);a.PushBoolArr(this.upgrades);break;case ENGINE_TYPE.ELECTRIC:a.PushNum(this.power);a.PushNum(this.winding_sel);a.PushNum(this.material_fudge);a.PushFloat(this.quality_fudge);break;default:throw"EngineInputs.serialize: Oh dear, you have a new engine type.";
}a.PushNum(this.rarity)}deserialize(a){this.name=a.GetString();this.engine_type=a.GetNum();this.type=a.GetNum();this.era_sel=a.GetNum();switch(this.engine_type){case ENGINE_TYPE.PROPELLER:this.displacement=a.GetFloat();this.compression=a.GetFloat();this.cyl_per_row=a.GetNum();this.rows=a.GetNum();this.RPM_boost=a.GetFloat();this.material_fudge=a.GetFloat();this.quality_fudge=a.GetFloat();this.compressor_type=a.GetNum();this.compressor_count=a.GetNum();this.min_IdealAlt=a.GetNum();this.upgrades=a.GetBoolArr(this.upgrades.length);
break;case ENGINE_TYPE.PULSEJET:this.power=a.GetNum();this.quality_cost=a.GetFloat();this.quality_rely=a.GetFloat();this.starter=a.GetBool();break;case ENGINE_TYPE.TURBOMACHINERY:this.flow_adjustment=a.GetFloat();this.diameter=a.GetFloat();this.compression_ratio=a.GetFloat();this.bypass_ratio=a.GetFloat();this.upgrades=a.GetBoolArr(this.upgrades.length);break;case ENGINE_TYPE.ELECTRIC:this.power=a.GetNum();this.winding_sel=a.GetNum();this.material_fudge=a.GetNum();this.quality_fudge=a.GetFloat();
break;default:throw"EngineInputs.deserialize: Oh dear, you have a new engine type.";}this.rarity=12.35<a.version?a.GetNum():ENGINE_RARITY.CUSTOM}PartStats(){switch(this.engine_type){case ENGINE_TYPE.PROPELLER:var a=new EngineBuilder;a.name=this.name;a.cool_sel=this.type;a.era_sel=this.era_sel;a.engine_displacement=this.displacement;a.compression_ratio=this.compression;a.num_cyl_per_row=this.cyl_per_row;a.num_rows=this.rows;a.rpm_boost=this.RPM_boost;a.material_fudge=this.material_fudge;a.quality_fudge=
this.quality_fudge;a.compressor_type=this.compressor_type;a.compressor_count=this.compressor_count;a.min_IAF=this.min_IdealAlt;a.upg_sel=this.upgrades;a.rarity=this.rarity;return a.EngineStats();case ENGINE_TYPE.PULSEJET:return a=new PulsejetBuilder,a.valve_sel=this.type,a.era_sel=this.era_sel,a.desired_power=this.power,a.build_quality=this.quality_cost,a.overall_quality=this.quality_rely,a.starter=this.starter,a.rarity=this.rarity,a=a.EngineStats(),this.name=a.name,a;case ENGINE_TYPE.TURBOMACHINERY:return a=
new TurboBuilder,a.type_sel=this.type,a.era_sel=this.era_sel,a.flow_adjustment=this.flow_adjustment,a.diameter=this.diameter,a.compression_ratio=this.compression_ratio,a.bypass_ratio=this.bypass_ratio,a.afterburner=this.upgrades[0],a.name=this.name,a.rarity=this.rarity,a.EngineStats();case ENGINE_TYPE.ELECTRIC:return a=new ElectricBuilder,a.era_sel=this.era_sel,a.winding_sel=this.winding_sel,a.power=this.power,a.chonk=this.material_fudge,a.quality_fudge=this.quality_fudge,a.name=this.name,a.EngineStats();
default:throw"EngineInputs.PartStats: Oh dear, you have a new engine type.";}}Equal(a){return this.name==a.name}Clone(){var a=new EngineInputs;a.name=this.name;a.engine_type=this.engine_type;a.type=this.type;a.era_sel=this.era_sel;a.displacement=this.displacement;a.compression=this.compression;a.cyl_per_row=this.cyl_per_row;a.rows=this.rows;a.RPM_boost=this.RPM_boost;a.material_fudge=this.material_fudge;a.quality_fudge=this.quality_fudge;a.compressor_type=this.compressor_type;a.compressor_count=this.compressor_count;
a.min_IdealAlt=this.min_IdealAlt;a.power=this.power;a.quality_cost=this.quality_cost;a.quality_rely=this.quality_rely;a.starter=this.starter;for(let b=0;b<this.upgrades.length;b++)a.upgrades[b]=this.upgrades[b];a.flow_adjustment=this.flow_adjustment;a.diameter=this.diameter;a.compression_ratio=this.compression_ratio;a.bypass_ratio=this.bypass_ratio;a.winding_sel=this.winding_sel;a.rarity=this.rarity;return a}}var DRIVE_TYPE;
(function(a){a[a.PROPELLER=0]="PROPELLER";a[a.TURBINE=1]="TURBINE";a[a.PULSEJET=2]="PULSEJET"})(DRIVE_TYPE||={});
class EngineStats{constructor(a){this.name="Default";this.rumble=this.torque=this.altitude=this.overspeed=0;this.pulsejet=this.oiltank=!1;this.stats=new Stats;this.rarity=ENGINE_RARITY.CUSTOM;a&&this.fromJSON(a)}toJSON(){return Object.assign({name:this.name,overspeed:this.overspeed,altitude:this.altitude,torque:this.torque,rumble:this.rumble,oiltank:this.oiltank,pulsejet:this.pulsejet,rarity:this.rarity},this.stats.toJSON())}fromJSON(a,b){a.name&&(this.name=a.name);a.overspeed&&(this.overspeed=a.overspeed);
a.altitude&&(this.altitude=a.altitude);a.torque&&(this.torque=a.torque);a.rumble&&(this.rumble=a.rumble);a.oiltank&&(this.oiltank=a.oiltank);a.pulsejet&&(this.pulsejet=a.pulsejet);a.rarity&&(this.rarity=a.rarity);this.stats=new Stats(a)}serialize(a){a.PushString(this.name);a.PushNum(this.overspeed);a.PushNum(this.altitude);a.PushNum(this.torque);a.PushNum(this.rumble);a.PushBool(this.oiltank);a.PushBool(this.pulsejet);a.PushNum(this.rarity);this.stats.serialize(a)}deserialize(a){this.name=a.GetString();
this.overspeed=a.GetNum();this.altitude=a.GetNum();this.torque=a.GetNum();this.rumble=a.GetNum();this.oiltank=a.GetBool();this.pulsejet=a.GetBool();12.35<a.version&&(this.rarity=a.GetNum());this.stats.deserialize(a)}Clone(){var a=new EngineStats;a.fromJSON(JSON.parse(JSON.stringify(this.toJSON())));return a}Equal(a){return this.stats.Equal(a.stats)&&this.overspeed==a.overspeed&&this.altitude==a.altitude&&this.torque==a.torque&&this.rumble==a.rumble&&this.oiltank==a.oiltank&&this.pulsejet==a.pulsejet&&
this.rarity==a.rarity}Verify(){this.oiltank&&(this.stats.cooling=0);this.PulseJetCheck()}PulseJetCheck(){this.pulsejet?(this.stats.cooling=0,this.overspeed=100,this.altitude=3,this.torque=0):this.rumble=0}}
class EngineList{constructor(a){this.constant=!1;this.name=a;this.list=[];var b=window.localStorage.getItem("engines."+this.name);null!=b&&this.fromJSON(JSON.parse(b));var c=window.localStorage.getItem("engines_names");b=[];c&&(b=JSON.parse(c));c=!1;for(let d of b)if(d==a){c=!0;break}c||b.push(a);window.localStorage.setItem("engines_names",JSON.stringify(b))}toJSON(){var a=[];for(let b of this.list)a.push(b.toJSON());return{name:this.name,engines:a}}fromJSON(a,b=!1){a.name&&(this.name=a.name);b&&
(this.list=[]);for(let c of a.engines)try{this.push(new EngineInputs(c),b)}catch(d){console.error(d)}}deserializeEngine(a){if(this.constant)throw"Engine List is Constant";let b=new EngineInputs;b.deserialize(a);return this.push(b)}push(a,b=!1){if(this.constant)throw"Engine List is Constant";if(b)this.remove(a);else for(b=0;b<this.length;b++)if(this.list[b].Equal(a))return b;this.list.push(a.Clone());this.list=this.list.sort((c,d)=>(""+c.name).localeCompare(d.name));window.localStorage.setItem("engines."+
this.name,JSON.stringify(this.toJSON()));return this.find(a)}get(a){return 0>a||a>=this.length?new EngineInputs:this.list[a]}get_name(a){a=this.find_name(a);return this.get(a)}get_stats(a){return 0>a||a>=this.length?new EngineStats:this.list[a].PartStats()}get_stats_name(a){a=this.find_name(a);return this.get_stats(a)}find(a){for(let b=0;b<this.length;b++)if(a.Equal(this.list[b]))return b;return-1}find_name(a){for(let b=0;b<this.length;b++)if(this.list[b].name==a)return b;return-1}remove(a){if(this.constant)throw"Engine List is Constant";
a=this.find(a);0<=a&&this.list.splice(a,1);window.localStorage.setItem("engines."+this.name,JSON.stringify(this.toJSON()))}remove_name(a){if(this.constant)throw"Engine List is Constant";a=this.find_name(a);0<=a&&this.list.splice(a,1);window.localStorage.setItem("engines."+this.name,JSON.stringify(this.toJSON()))}get length(){return this.list.length}SetConstant(){this.constant=!0}}
function SearchAllEngineLists(a){for(let b of engine_list.keys())if("Custom"!=b&&0<=engine_list.get(b).find_name(a))return b;return 0<=engine_list.get("Custom").find_name(a)?"Custom":""}
class Era extends Part{constructor(a){super();this.selected=0;this.vals=[];for(let b of a.options)a={name:b.name,maxbomb:b.maxbomb,cant_lift:b.cant_lift,stats:new Stats(b)},this.vals.push(a)}toJSON(){return{selected:this.selected}}fromJSON(a,b){this.selected=a.selected;10.35>b&&2<this.selected&&this.selected++}serialize(a){a.PushNum(this.selected)}deserialize(a){this.selected=a.GetNum()}GetSelected(){return this.selected}GetSelectedText(){return this.vals[this.selected].name}SetSelected(a){this.selected=
a;this.CalculateStats()}GetEraOptions(){return this.vals}GetLiftBleed(){return this.vals[this.selected].stats.liftbleed}GetMaxBomb(){return this.vals[this.selected].maxbomb}GetCantLift(){return this.vals[this.selected].cant_lift}PartStats(){return(new Stats).Add(this.vals[this.selected].stats)}SetCalculateStats(a){this.CalculateStats=a}GetElectrics(){return{storage:0,equipment:[]}}}
class Cockpit extends Part{constructor(a,b,c,d){super();this.stats=new Stats;this.types=a;this.upgrades=b;this.safety=c;this.gunsights=d;this.selected_type=0;this.selected_upgrades=[...Array(this.upgrades.length).fill(!1)];this.selected_safety=[...Array(this.safety.length).fill(!1)];this.selected_gunsights=[...Array(this.gunsights.length).fill(!1)];this.total_stress=[0,0];this.bombsight=this.seat_index=this.total_visibility=this.total_escape=0;this.is_armed=!1}toJSON(){return{type:this.selected_type,
upgrades:this.selected_upgrades,safety:this.selected_safety,sights:this.selected_gunsights,bombsight:this.bombsight}}fromJSON(a,b){this.selected_type=a.type;this.selected_upgrades=BoolArr(a.upgrades,this.selected_upgrades.length);this.selected_safety=BoolArr(a.safety,this.selected_safety.length);this.selected_gunsights=BoolArr(a.sights,this.selected_gunsights.length);this.IsPrimary()&&(this.selected_upgrades[0]=!1);10.35<b&&(this.bombsight=a.bombsight)}serialize(a){a.PushNum(this.selected_type);a.PushBoolArr(this.selected_upgrades);
a.PushBoolArr(this.selected_safety);a.PushBoolArr(this.selected_gunsights);a.PushNum(this.bombsight)}deserialize(a){this.selected_type=a.GetNum();this.selected_upgrades=a.GetBoolArr(this.selected_upgrades.length);this.selected_safety=a.GetBoolArr(this.selected_safety.length);this.selected_gunsights=a.GetBoolArr(this.selected_gunsights.length);this.IsPrimary()&&(this.selected_upgrades[0]=!1);10.35<a.version&&(this.bombsight=a.GetNum())}GetTypeList(){return this.types}GetUpgradeList(){return this.upgrades}GetSafetyList(){return this.safety}GetGunsightList(){return this.gunsights}GetType(){return this.selected_type}SetType(a){if(a>=
this.types.length)throw"Selected type is not in range of actual types.";this.selected_type=a;this.CalculateStats()}GetSelectedUpgrades(){return this.selected_upgrades}SetUpgrade(a,b){if(a>=this.upgrades.length)throw"Selected type is not in range of actual upgrades.";this.selected_upgrades[a]=b;this.CalculateStats()}GetSelectedSafety(){return this.selected_safety}CanSafety(){let a=Array(this.safety.length).fill(!0);a[5]=!this.types[this.selected_type].exposed;return a}SetSafety(a,b){if(a>=this.safety.length)throw"Selected type is not in range of actual safties.";
this.selected_safety[a]=b;this.CalculateStats()}GetSelectedGunsights(){return this.selected_gunsights}SetGunsight(a,b){if(a>=this.safety.length)throw"Selected type is not in range of actual gunsights.";this.selected_gunsights[a]=b;this.CalculateStats()}GetVisibility(){return-10>this.types[this.selected_type].stats.visibility?-1/0:this.total_visibility}GetFlightStress(){return this.total_stress}GetEscape(){return this.total_escape}GetCrash(){return this.total_crash}GetAttack(){var a=0;for(let b=0;b<
this.gunsights.length;b++)this.selected_gunsights[b]&&(a=Math.max(a,this.gunsights[b].attack));return a}SetSeatIndex(a){this.seat_index=a}IsPrimary(){return 0==this.seat_index}CanUpgrades(){var a=[...Array(this.upgrades.length).fill(!0)];this.IsPrimary()&&(a[0]=!1);return a}IsOpen(){return"Open"==this.types[this.selected_type].name||"Windscreen"==this.types[this.selected_type].name}GetBombsightQuality(){return this.bombsight}SetBombsightQuality(a){a!=a&&(a=0);a==this.bombsight-1&&(a=this.bombsight-
3);a==this.bombsight+1&&(a=this.bombsight+3);2>a&&(a=0);0<a&&(a=a-a%3+1);this.bombsight=a;this.CalculateStats()}SetHasRotary(a){this.has_rotary=a}IsElectrics(){return 0!=this.stats.charge}IsCopilot(){return this.selected_upgrades[0]}SetArmed(a){this.is_armed=a}GetName(){return this.IsPrimary()?"Crew Pilot":0<this.bombsight?"Crew Bombadier":this.IsCopilot()?"Crew Co-Pilot":this.is_armed?"Crew Gunner":"Crew Aircrew"}PartStats(){let a=new Stats;a.reqsections=1;a=a.Add(this.types[this.selected_type].stats);
for(var b=0;b<this.selected_upgrades.length;b++)this.selected_upgrades[b]&&(a=a.Add(this.upgrades[b].stats));b=this.CanSafety();for(let c=0;c<this.selected_safety.length;c++)b[c]||(this.selected_safety[c]=!1),this.selected_safety[c]&&(a=a.Add(this.safety[c].stats));for(b=0;b<this.selected_gunsights.length;b++)this.selected_gunsights[b]&&(a=a.Add(this.gunsights[b].stats));0<this.bombsight&&(a.cost+=Math.floor(2.000001+(this.bombsight-4)/3),a.warnings.push({source:lu("Bombsight"),warning:lu("Bombsight Warning 1")+
this.bombsight.toString()+lu("Bombsight Warning 2"),color:WARNING_COLOR.WHITE}),this.IsCopilot()&&a.warnings.push({source:lu("Bombadier Controls"),warning:lu("Bombadier Controls Warning"),color:WARNING_COLOR.WHITE}));this.stats=a.Clone();this.selected_upgrades[0]?(a.flightstress=this.upgrades[0].stats.flightstress,this.stats.flightstress-=a.flightstress):a.flightstress=0;return a}CrewUpdate(a,b,c,d,e,f){this.total_escape=this.stats.escape+a;let g=a=this.stats.flightstress;if(this.IsPrimary()||this.selected_upgrades[0])a+=
b,g+=b-2*d;a=Math.max(0,a);g=Math.max(0,g);a+=c;g+=c;this.IsOpen()&&this.has_rotary&&(a+=1,g+=1);a=Math.max(0,a);g=Math.max(0,g);this.total_stress=[a,g];this.total_visibility=this.stats.visibility+e;this.total_crash=this.stats.crashsafety+f}SetCalculateStats(a){this.CalculateStats=a}GetElectrics(){for(var a=[],b=0;b<this.upgrades.length;b++)if(this.selected_upgrades[b]){var c=this.upgrades[b];a=this.FormatEquipment(a,c.name,c.stats.charge)}for(b=0;b<this.safety.length;b++)this.selected_safety[b]&&
(c=this.safety[b],a=this.FormatEquipment(a,c.name,c.stats.charge));for(b=0;b<this.gunsights.length;b++)this.selected_gunsights[b]&&(c=this.gunsights[b],a=this.FormatEquipment(a,c.name,c.stats.charge));return{storage:0,equipment:a}}}
class Cockpits extends Part{constructor(a){super();this.positions=[];this.types=[];for(var b of a.options){let d={name:b.name,exposed:b.exposed,stats:new Stats(b)};this.types.push(d)}this.upgrades=[];for(var c of a.upgrades)b={name:c.name,stats:new Stats(c)},this.upgrades.push(b);this.safety=[];for(let d of a.safety)c={name:d.name,stats:new Stats(d)},this.safety.push(c);this.gunsights=[];for(let d of a.gunsights)a={name:d.name,attack:d.attack,stats:new Stats(d)},this.gunsights.push(a)}toJSON(){var a=
[];for(let b of this.positions)a.push(b.toJSON());return{positions:a}}fromJSON(a,b){this.positions=[];for(let c of a.positions)a=new Cockpit(this.types,this.upgrades,this.safety,this.gunsights),a.SetSeatIndex(this.positions.length),a.fromJSON(c,b),a.SetCalculateStats(this.CalculateStats),this.positions.push(a)}serialize(a){a.PushNum(this.positions.length);for(let b of this.positions)b.serialize(a)}deserialize(a){var b=a.GetNum();this.positions=[];for(let c=0;c<b;c++){let d=new Cockpit(this.types,
this.upgrades,this.safety,this.gunsights);d.SetSeatIndex(this.positions.length);d.deserialize(a);d.SetCalculateStats(this.CalculateStats);this.positions.push(d)}}GetAttackList(){var a=[];for(let b of this.positions)a.push(b.GetAttack());return a}GetVisibilityList(){var a=[];for(let b of this.positions)a.push(b.GetVisibility());return a}GetStressList(){var a=[];for(let b of this.positions)a.push(b.GetFlightStress());return a}GetEscapeList(){var a=[];for(let b of this.positions)a.push(b.GetEscape());
return a}GetCrashList(){var a=[];for(let b of this.positions)a.push(b.GetCrash());return a}SetNumberOfCockpits(a){if(a!=a||1>a)a=1;for(a=Math.floor(1E-6+a);this.positions.length>a;)this.positions.pop();var b=null;for(0<this.positions.length&&(b=JSON.stringify(this.positions[this.positions.length-1].toJSON()));this.positions.length<a;){let c=new Cockpit(this.types,this.upgrades,this.safety,this.gunsights);c.SetSeatIndex(this.positions.length);b&&c.fromJSON(JSON.parse(b),1E3);c.SetCalculateStats(this.CalculateStats);
this.positions.push(c)}this.CalculateStats()}GetNumberOfCockpits(){return this.positions.length}GetCockpit(a){return this.positions[a]}SetHasRotary(a){for(let b of this.positions)b.SetHasRotary(a)}IsElectrics(){for(let a of this.positions)if(a.IsElectrics())return!0;return!1}PartStats(){var a=new Stats;let b=new Map;for(let d=0;d<this.positions.length;d++){var c=this.positions[d].PartStats();a=a.Add(c);for(let e of c.warnings)(c=b.get(e.source))?(c.push(d+1),b.set(e.source,c)):b.set(e.source,[d+1])}for(let d of a.warnings)d.source=
lu("Seats #",StringFmt.Join(",",b.get(d.source)))+" "+d.source;a.escape=0;a.visibility=0;a.crashsafety=0;return a}SetArmed(a){for(let b=0;b<this.positions.length;b++)this.positions[b].SetArmed(a[b])}UpdateCrewStats(a,b,c,d,e){let f=0;for(let g of this.positions)g.IsCopilot()&&(f+=1);for(let g of this.positions)g.CrewUpdate(a,b,c,f,d,e)}SetCalculateStats(a){this.CalculateStats=a}GetElectrics(){let a={storage:0,equipment:[]};for(let b of this.positions)a=MergeElectrics(a,b.GetElectrics());return a}}
class Passengers extends Part{constructor(a){super();this.beds=this.seats=0;this.connected=!1}toJSON(){return{seats:this.seats,beds:this.beds,connected:this.connected}}fromJSON(a,b){this.seats=a.seats;this.beds=a.beds;this.connected=a.connected}serialize(a){a.PushNum(this.seats);a.PushNum(this.beds);a.PushBool(this.connected)}deserialize(a){this.seats=a.GetNum();this.beds=a.GetNum();this.connected=a.GetBool()}GetSeats(){return this.seats}SetSeats(a){if(a!=a||0>a)a=0;this.seats=Math.floor(1E-6+a);
this.CalculateStats()}GetBeds(){return this.beds}SetBeds(a){if(a!=a||0>a)a=0;this.beds=Math.floor(1E-6+a);this.CalculateStats()}PossibleConnection(){return 0<this.seats+this.beds}GetConnected(){return this.connected}SetConnected(a){this.connected=a;this.CalculateStats()}PartStats(){var a=new Stats;a.reqsections=2*Math.ceil(-1E-6+(this.seats+2*this.beds)/5);0<this.seats+this.beds&&this.connected&&(a.mass=1);a.bomb_mass+=this.seats+this.beds;0<a.bomb_mass%5&&(a.bomb_mass+=5-a.bomb_mass%5);0<this.seats+
this.beds&&a.warnings.push({source:lu("Passengers Section Title"),warning:lu("Passengers Count",this.seats,this.beds),color:WARNING_COLOR.WHITE});return a}SetCalculateStats(a){this.CalculateStats=a}GetElectrics(){return{storage:0,equipment:[]}}}
class Engine extends Part{constructor(a,b){super();this.elist_idx="Custom";this.etype_stats=engine_list.get(this.elist_idx).get_stats(0);this.etype_inputs=engine_list.get(this.elist_idx).get(0);this.cooling_count=this.etype_stats.stats.cooling;this.radiator_index=-1;0<this.cooling_count&&(this.radiator_index=0);this.num_radiators=0;this.mount_list=a;this.mount_sel=0;this.torque_to_struct=this.use_pp=this.intake_fan=!1;this.cowl_list=b;this.cowl_sel=0;this.outboard_prop=this.use_ds=!1;this.total_reliability=
this.gpr_count=this.gp_count=0;this.has_alternator=this.is_generator=!1;if(0>=engine_list.get(this.elist_idx).length)throw"No Engine Stats Found.  Should be at least one.";}toJSON(){return{selected_stats:this.etype_stats.toJSON(),selected_inputs:this.etype_inputs.toJSON(),cooling_count:this.cooling_count,radiator_index:this.radiator_index,selected_mount:this.mount_sel,use_pushpull:this.use_pp,pp_torque_to_struct:this.torque_to_struct,use_driveshafts:this.use_ds,geared_propeller_ratio:this.gp_count,
geared_propeller_reliability:this.gpr_count,cowl_sel:this.cowl_sel,is_generator:this.is_generator,has_alternator:this.has_alternator,intake_fan:this.intake_fan,outboard_prop:this.outboard_prop}}oldJSON(a,b){a=a.selected_stats;this.etype_stats.fromJSON(a,b);this.etype_inputs=new EngineInputs;this.etype_stats.pulsejet&&a.input_pj?(this.etype_inputs=new EngineInputs,this.etype_inputs.name=this.etype_stats.name,this.etype_inputs.engine_type=ENGINE_TYPE.PULSEJET,b=a.input_pj,this.etype_inputs.type=b.type,
this.etype_inputs.power=b.power,this.etype_inputs.era_sel=b.era_sel,this.etype_inputs.quality_cost=b.quality_cost,this.etype_inputs.quality_rely=b.quality_rely,this.etype_inputs.starter=b.starter):a.input_eb?(this.etype_inputs.name=this.etype_stats.name,this.etype_inputs.engine_type=ENGINE_TYPE.PROPELLER,b=a.input_eb,this.etype_inputs.displacement=b.displacement,this.etype_inputs.compression=b.compression,this.etype_inputs.type=b.type,this.etype_inputs.cyl_per_row=b.cyl_per_row,this.etype_inputs.rows=
b.rows,this.etype_inputs.RPM_boost=b.RPM_boost,this.etype_inputs.era_sel=b.era_sel,this.etype_inputs.material_fudge=b.material_fudge,this.etype_inputs.quality_fudge=b.quality_fudge,this.etype_inputs.upgrades=b.upgrades,6==this.etype_inputs.upgrades.length?(this.etype_stats.altitude=10*this.etype_stats.altitude-1,this.etype_inputs.upgrades[0]&&(this.etype_inputs.compressor_type=2,this.etype_inputs.compressor_count=1),this.etype_inputs.upgrades[1]&&(this.etype_inputs.compressor_type=3,this.etype_inputs.compressor_count=
1),this.etype_inputs.upgrades.splice(0,2)):(this.etype_inputs.compressor_type=b.compressor_type,this.etype_inputs.compressor_count=b.compressor_count,this.etype_inputs.min_IdealAlt=b.min_IAF)):this.etype_stats.altitude=10*this.etype_stats.altitude-1;return this.etype_inputs}fromJSON(a,b){var c="";if(10.55<b){this.etype_stats.fromJSON(a.selected_stats,b);var d=new EngineInputs(a.selected_inputs);c=SearchAllEngineLists(this.etype_stats.name);""==c&&(c="Custom","Default"!=d.name&&engine_list.get(c).push(d));
this.etype_stats=engine_list.get(c).get_stats_name(this.etype_stats.name);this.etype_inputs=engine_list.get(c).get_name(this.etype_stats.name)}else d=this.oldJSON(a,b),"Default"!=d.name&&(c=SearchAllEngineLists(this.etype_stats.name),""==c&&(c="Custom",engine_list.get(c).push(d)),this.etype_stats=engine_list.get(c).get_stats_name(this.etype_stats.name),this.etype_inputs=engine_list.get(c).get_name(this.etype_stats.name));this.elist_idx=c;this.cooling_count=a.cooling_count;this.radiator_index=a.radiator_index;
this.mount_sel=a.selected_mount;this.use_pp=a.use_pushpull;this.torque_to_struct=a.pp_torque_to_struct;this.use_ds=a.use_driveshafts;this.gp_count=a.geared_propeller_ratio;this.gpr_count=a.geared_propeller_reliability;this.cowl_sel=a.cowl_sel;this.is_generator=a.is_generator;this.has_alternator=a.has_alternator;this.intake_fan=a.intake_fan;this.outboard_prop=12.15<=b?a.outboard_prop:!1}serialize(a){this.etype_stats.serialize(a);this.etype_inputs.serialize(a);a.PushNum(this.cooling_count);a.PushNum(this.radiator_index);
a.PushNum(this.mount_sel);a.PushBool(this.use_pp);a.PushBool(this.torque_to_struct);a.PushBool(this.use_ds);a.PushNum(this.gp_count);a.PushNum(this.gpr_count);a.PushNum(this.cowl_sel);a.PushBool(this.is_generator);a.PushBool(this.has_alternator);a.PushBool(this.intake_fan);a.PushBool(this.outboard_prop)}oldDeserialize(a){this.etype_stats.name=a.GetString();this.etype_stats.overspeed=a.GetNum();this.etype_stats.altitude=a.GetNum();this.etype_stats.torque=a.GetNum();this.etype_stats.rumble=a.GetNum();
this.etype_stats.oiltank=a.GetBool();this.etype_stats.pulsejet=a.GetBool();this.etype_inputs=new EngineInputs;10.45<a.version?(this.etype_inputs.name=this.etype_stats.name,this.etype_stats.pulsejet?(this.etype_inputs.engine_type=ENGINE_TYPE.PULSEJET,this.etype_inputs.power=a.GetNum(),this.etype_inputs.type=a.GetNum(),this.etype_inputs.era_sel=a.GetNum(),this.etype_inputs.quality_cost=a.GetNum(),this.etype_inputs.quality_rely=a.GetNum(),this.etype_inputs.starter=a.GetBool()):(this.etype_inputs.displacement=
a.GetNum(),this.etype_inputs.compression=a.GetNum(),this.etype_inputs.type=a.GetNum(),this.etype_inputs.cyl_per_row=a.GetNum(),this.etype_inputs.rows=a.GetNum(),this.etype_inputs.RPM_boost=a.GetNum(),this.etype_inputs.era_sel=a.GetNum(),this.etype_inputs.material_fudge=a.GetNum(),this.etype_inputs.quality_fudge=a.GetNum(),this.etype_inputs.upgrades=a.GetBoolArr(0),6==this.etype_inputs.upgrades.length?(this.etype_stats.altitude=10*this.etype_stats.altitude-1,this.etype_inputs.upgrades[0]&&(this.etype_inputs.compressor_type=
2,this.etype_inputs.compressor_count=1),this.etype_inputs.upgrades[1]&&(this.etype_inputs.compressor_type=3,this.etype_inputs.compressor_count=1),this.etype_inputs.upgrades.splice(0,2)):(this.etype_inputs.compressor_type=a.GetNum(),this.etype_inputs.compressor_count=a.GetNum(),this.etype_inputs.min_IdealAlt=a.GetNum()))):this.etype_stats.altitude=10*this.etype_stats.altitude-1;this.etype_stats.stats.deserialize(a);return this.etype_inputs}deserialize(a){var b="";if(10.55<a.version){this.etype_stats.deserialize(a);
var c=new EngineInputs;c.deserialize(a);b=SearchAllEngineLists(this.etype_stats.name);""==b&&(b="Custom","Default"!=c.name&&engine_list.get(b).push(c));this.etype_stats=engine_list.get(b).get_stats_name(this.etype_stats.name);this.etype_inputs=engine_list.get(b).get_name(this.etype_stats.name)}else c=this.oldDeserialize(a),"Default"!=c.name&&(b=SearchAllEngineLists(this.etype_stats.name),""==b&&(b="Custom",engine_list.get(b).push(c)),this.etype_stats=engine_list.get(b).get_stats_name(this.etype_stats.name),
this.etype_inputs=engine_list.get(b).get_name(this.etype_stats.name));this.cooling_count=a.GetNum();this.radiator_index=a.GetNum();this.mount_sel=a.GetNum();this.use_pp=a.GetBool();this.torque_to_struct=a.GetBool();this.use_ds=a.GetBool();this.gp_count=a.GetNum();this.gpr_count=a.GetNum();this.cowl_sel=a.GetNum();this.is_generator=a.GetBool();this.has_alternator=a.GetBool();this.intake_fan=a.GetBool();this.outboard_prop=12.15<=a.version?a.GetBool():!1;this.elist_idx=b}GetMinAltitude(){return this.etype_inputs.min_IdealAlt}GetMaxAltitude(){return this.GetMinAltitude()+
this.etype_stats.altitude}GetMinIAF(){return Math.floor(1E-6+this.GetMinAltitude()/10)}GetMaxIAF(){return Math.floor(1E-6+this.GetMaxAltitude()/10)}CanSelectIndex(){var a=engine_list.get(this.elist_idx),b=[...Array(a.length).fill(!0)];if(this.is_internal)for(let c=0;c<a.length;c++)if(a.get(c).engine_type==ENGINE_TYPE.PULSEJET||a.get(c).engine_type==ENGINE_TYPE.TURBOMACHINERY&&(1==a.get(c).type||2==a.get(c).type))b[c]=!1;return b}SetSelectedIndex(a){this.etype_stats=engine_list.get(this.elist_idx).get_stats(a);
this.etype_inputs=engine_list.get(this.elist_idx).get(a);this.cooling_count=this.use_pp?2*this.etype_stats.stats.cooling:this.etype_stats.stats.cooling;0>this.radiator_index&&(this.radiator_index=0);this.PulseJetCheck();this.VerifyCowl(this.cowl_sel);this.CalculateStats()}GetSelectedIndex(){return engine_list.get(this.elist_idx).find_name(this.etype_stats.name)}GetCurrentStats(){return this.etype_stats.Clone()}NeedCooling(){return 0<this.etype_stats.stats.cooling}WarnCoolingReliability(){return this.cooling_count<
this.etype_stats.stats.cooling}SetCooling(a){if(a!=a||0>a)a=0;this.cooling_count=Math.floor(1E-6+a);this.NeedCooling()&&(this.cooling_count=Math.max(1,this.cooling_count));this.CalculateStats()}GetCooling(){return this.cooling_count}GetMaxCooling(){return this.use_pp?2*this.etype_stats.stats.cooling:this.etype_stats.stats.cooling}SetNumRadiators(a){this.num_radiators=a;this.radiator_index>=a&&(this.radiator_index=a-1);0>this.radiator_index&&0<a&&(this.radiator_index=0)}GetNumRadiators(){return this.num_radiators}SetRadiator(a){this.radiator_index=
a;this.CalculateStats()}GetRadiator(){return this.radiator_index}CanIntakeFan(){return this.IsAirCooled()}SetIntakeFan(a){this.intake_fan=a;this.CalculateStats()}GetIntakeFan(){return this.intake_fan}CanOutboardProp(){return this.use_ds&&(this.IsTractor()||"Fuselage Push-Pull"==this.mount_list[this.mount_sel].name)}GetOutboardProp(){return this.outboard_prop}SetOutboardProp(a){this.outboard_prop=a&&this.use_ds?!0:!1;this.CalculateStats()}SetSelectedList(a){a!=this.elist_idx&&(this.elist_idx=a,this.SetSelectedIndex(0))}GetSelectedList(){return this.elist_idx}GetListOfEngines(){return engine_list.get(this.elist_idx)}RequiresExtendedDriveshafts(){return this.is_internal?
!1:this.mount_list[this.mount_sel].reqED}SetTailMods(a,b,c){!this.mount_list[this.mount_sel].reqTail||a||b||this.GetGenerator()||(this.use_ds=!0);!this.mount_list[this.mount_sel].reqED||this.GetGenerator()||c&&(a||b)||(this.use_ds=!0)}CanMountIndex(){var a=[...Array(this.mount_list.length).fill(!0)];if(this.is_internal)for(var b=0;b<a.length;++b)a[b]=this.mount_list[b].helicopter;else if(this.GetIsTurbine()&&!this.GetIsTurboprop())for(b=0;b<a.length;++b)a[b]=this.mount_list[b].turbine;else if(this.is_generator)a=
[...Array(this.mount_list.length).fill(!1)],a[0]=!0;else if(this.use_pp)for(b=0;b<a.length;++b)"fuselage"==this.mount_list[b].mount_type&&"Fuselage Push-Pull"!=this.mount_list[b].name&&(a[b]=!1),this.mount_list[b].turbine&&(a[b]=!1);else for(b=0;b<a.length;++b)"Fuselage Push-Pull"==this.mount_list[b].name&&(a[b]=!1),this.mount_list[b].turbine&&(a[b]=!1);return a}SetMountIndex(a){if(a>=this.mount_list.length)throw"Index outside of mount_list range.";this.mount_sel=a;this.mount_list[this.mount_sel].reqED&&
this.SetUseExtendedDriveshaft(!0);this.CalculateStats()}GetMountIndex(){return this.GetIsPulsejet()?-1:this.mount_sel}CanUsePushPull(){return!(this.is_generator||this.GetIsJet()||this.is_internal||this.mount_list[this.mount_sel].helicopter)}SetUsePushPull(a){(this.use_pp=a)?(this.cooling_count*=2,"fuselage"==this.mount_list[this.mount_sel].mount_type&&(this.mount_sel=8)):(this.cooling_count=Math.floor(1E-6+this.cooling_count/2),"Fuselage Push-Pull"==this.mount_list[this.mount_sel].name&&(this.mount_sel=
0));this.CalculateStats()}GetUsePushPull(){return this.use_pp}GetMountList(){return this.mount_list}CanUseExtendedDriveshaft(){return!(0==this.GetNumPropellers()||this.is_internal||this.GetGenerator()||this.mount_list[this.mount_sel].helicopter)}SetUseExtendedDriveshaft(a){this.GetGenerator()||this.is_internal?this.use_ds=!1:this.use_ds=a;this.CalculateStats()}GetUseExtendedDriveshaft(){return this.use_ds}CanUseGears(){return!(0==this.GetNumPropellers()||this.GetGenerator())}SetGearCount(a){if(a!=
a||0>a)a=0;this.gp_count=Math.floor(1E-6+a);this.SetGearReliability(this.gpr_count)}GetGearCount(){return this.gp_count}SetGearReliability(a){if(a!=a||0>a)a=0;a=Math.floor(1E-6+a);this.gpr_count=Math.min(a,this.gp_count);this.CalculateStats()}GetGearReliability(){return this.gpr_count}SetTorqueToStruct(a){this.torque_to_struct=a;this.use_pp||(this.torque_to_struct=!1);this.CalculateStats()}GetTorqueToStruct(){return this.torque_to_struct}CanTorqueToStruct(){return this.use_pp&&0<this.etype_stats.torque&&
"pod"!=this.mount_list[this.mount_sel].mount_type}UpdateReliability(a){this.total_reliability=this.etype_stats.stats.reliability;this.total_reliability-=this.gp_count-this.gpr_count;this.total_reliability+=this.cowl_list[this.cowl_sel].stats.reliability;this.NeedCooling()&&(this.total_reliability-=this.GetMaxCooling()-this.cooling_count);this.GetIntakeFan()&&(this.total_reliability+=6);this.total_reliability+=a}GetReliability(){return this.use_pp?this.outboard_prop?this.total_reliability.toString()+
"/"+(this.total_reliability-2).toString():this.total_reliability.toString()+"/"+this.total_reliability.toString():this.outboard_prop?(this.total_reliability-2).toString():this.total_reliability.toString()}GetOverspeed(){return this.is_generator?1E3:this.etype_stats.overspeed+Math.floor(1E-6+this.gp_count*this.etype_stats.overspeed/2)}GetIsPulsejet(){return this.etype_stats.pulsejet}GetIsJet(){return this.GetIsPulsejet()||this.GetIsTurbine()&&!this.GetIsTurboprop()}PulseJetCheck(){this.GetIsPulsejet()&&
(this.use_ds=this.use_pp=!1,this.cooling_count=this.gpr_count=this.gp_count=0,this.is_generator=this.has_alternator=!1,this.cowl_sel=0,this.radiator_index=-1)}GetIsTurbine(){return this.etype_inputs.engine_type==ENGINE_TYPE.TURBOMACHINERY}GetIsTurboprop(){return this.etype_inputs.engine_type==ENGINE_TYPE.TURBOMACHINERY&&3==this.etype_inputs.type}TurbineCheck(){this.GetIsTurbine()&&(0==this.GetNumPropellers()&&(this.use_ds=!1,this.gpr_count=this.gp_count=0),this.cowl_sel=this.cooling_count=0,this.radiator_index=
-1)}GetNumPropellers(){return!(this.GetIsPulsejet()||this.GetIsTurbine()||this.GetGenerator())||this.GetIsTurboprop()||this.is_internal?this.use_pp?2:1:0}GetIsTractorNacelle(){return 0<this.GetNumPropellers()&&!this.GetUsePushPull()&&.8==this.mount_list[this.mount_sel].powerfactor&&!this.is_internal?!0:!1}IsLiquidCooled(){return this.NeedCooling()}IsRotary(){return this.etype_stats.oiltank}IsContraRotary(){return this.GetIsPulsejet()||this.GetIsTurbine()||""==this.elist_idx||3!=this.etype_inputs.type?
!1:!0}IsAirCooled(){return!this.GetIsPulsejet()&&!this.GetIsTurbine()&&!this.IsLiquidCooled()&&!this.IsRotary()}GetCowlList(){return this.cowl_list}GetCowl(){return this.cowl_sel}GetCowlEnabled(){let a=[];for(let b of this.cowl_list)this.GetIsPulsejet()||this.GetIsTurbine()?a.push(b.air&&b.rotary&&b.liquid):this.IsLiquidCooled()?a.push(b.liquid):this.IsRotary()?a.push(b.rotary):a.push(b.air);return a}GetHasOilTank(){return this.etype_stats.oiltank}GetHasOilCooler(){return 0<this.etype_stats.stats.cooling}GetHasOilPan(){return this.IsAirCooled()}VerifyCowl(a){var b=
this.GetCowlEnabled();b[a]&&(this.cowl_sel=a);b[this.cowl_sel]||(this.cowl_sel=0)}SetCowl(a){this.VerifyCowl(a);this.CalculateStats()}GetGeneratorEnabled(){return!(this.GetIsPulsejet()||this.use_pp)}GetGenerator(){return this.is_generator}SetGenerator(a){this.GetGeneratorEnabled()?this.is_generator=a:this.is_generator=!1;this.is_generator&&(this.gpr_count=this.gp_count=0,this.use_ds=!1);this.CalculateStats()}GetAlternatorEnabled(){return!this.GetIsPulsejet()&&!this.is_generator&&this.etype_inputs.engine_type!=
ENGINE_TYPE.ELECTRIC}GetAlternator(){return this.has_alternator}SetAlternator(a){this.GetAlternatorEnabled()?this.has_alternator=a:this.has_alternator=!1;this.CalculateStats()}GetRumble(){return this.etype_stats.rumble}IsTractor(){return this.is_internal||this.GetGenerator()?!1:"Tractor"==this.mount_list[this.mount_sel].name||"Center-Mounted Tractor"==this.mount_list[this.mount_sel].name||"Fuselage Push-Pull"==this.mount_list[this.mount_sel].name}GetTractorSpinner(){return{has:this.IsTractor()&&!(this.outboard_prop&&
!this.use_pp),spinner:this.GetSpinner()}}IsPusher(){return this.is_internal||this.GetGenerator()?!1:"Rear-Mounted Pusher"==this.mount_list[this.mount_sel].name||"Center-Mounted Pusher"==this.mount_list[this.mount_sel].name||"Fuselage Push-Pull"==this.mount_list[this.mount_sel].name}GetPusherSpinner(){return{has:this.IsPusher()&&!this.outboard_prop,spinner:this.GetSpinner()}}GetSpinner(){if(0<this.gp_count&&!this.GetGenerator()&&!this.outboard_prop){if(this.use_ds&&("Center-Mounted Tractor"==this.mount_list[this.mount_sel].name||
"Center-Mounted Pusher"==this.mount_list[this.mount_sel].name||"Fuselage Push-Pull"==this.mount_list[this.mount_sel].name))return[!0,!0];if(!this.etype_stats.oiltank)return[!0,!1]}return[!1,!1]}IsElectrics(){return this.has_alternator||this.GetGenerator()}GetEngineHeight(){return this.GetGenerator()?5:"Pod"==this.mount_list[this.mount_sel].name||this.etype_stats.pulsejet||this.is_internal||this.outboard_prop?2:"Nacelle (Offset)"==this.mount_list[this.mount_sel].name?1:"Nacelle (Inside)"==this.mount_list[this.mount_sel].name||
"Channel Tractor"==this.mount_list[this.mount_sel].name||"Wing Pod"==this.mount_list[this.mount_sel].name?0:-1}IsTractorRotary(){return this.GetGenerator()?!1:this.IsRotary()&&("Tractor"==this.mount_list[this.mount_sel].name||"Fuselage Push-Pull"==this.mount_list[this.mount_sel].name)}IsDiesel(){return this.etype_inputs.upgrades[3]}SetCalculateStats(a){this.CalculateStats=a}SetInternal(a){if(this.is_internal=a)this.use_ds=!1}VerifyMount(){if(this.GetIsTurbine()&&!this.GetIsTurboprop())for(;!this.mount_list[this.mount_sel].turbine;)this.mount_sel++;
else if(this.GetIsPulsejet()){if("fuselage"==this.mount_list[this.mount_sel].mount_type)for(let a=0;a<this.mount_list.length&&(this.mount_sel=a,"fuselage"==this.mount_list[this.mount_sel].mount_type);a++);}else this.is_internal?this.CanMountIndex()[this.mount_sel]||(this.mount_sel=1):this.is_generator?this.mount_sel=0:this.mount_list[this.mount_sel].turbine&&(this.mount_sel=this.use_pp?8:0)}VerifyCooling(){this.NeedCooling()&&0>this.radiator_index?this.radiator_index=0:this.NeedCooling()||(this.radiator_index=
-1)}ElectricCheck(){this.etype_inputs.engine_type==ENGINE_TYPE.ELECTRIC&&(this.has_alternator=!1)}PartStats(){this.VerifyMount();this.VerifyCooling();this.PulseJetCheck();this.TurbineCheck();this.ElectricCheck();this.CanUseExtendedDriveshaft()||(this.use_ds=!1);this.CanOutboardProp()||(this.outboard_prop=!1);let a=new Stats;a=a.Add(this.etype_stats.stats);a.upkeep=a.power/10;this.etype_stats.oiltank&&(a.mass+=1);this.mount_list[this.mount_sel].helicopter&&this.IsRotary();this.torque_to_struct?a.structure-=
this.etype_stats.torque:"wing"==this.mount_list[this.mount_sel].mount_type?a.maxstrain-=this.etype_stats.torque:"fuselage"==this.mount_list[this.mount_sel].mount_type&&(a.latstab-=this.etype_stats.torque);this.IsContraRotary()&&(this.gp_count=Math.max(1,this.gp_count));a.cost+=this.gp_count+this.gpr_count;0<this.gp_count&&a.era.push({name:"Propeller Gearing",era:"WWI"});0<this.gpr_count&&a.era.push({name:"Reliable Gearing",era:"Roaring 20s"});this.use_ds&&(a.mass+=1);a=a.Add(this.cowl_list[this.cowl_sel].stats);
a.mass+=Math.floor(1E-6+a.drag*this.cowl_list[this.cowl_sel].mpd);a.drag=Math.floor(1E-6+a.drag*this.cowl_list[this.cowl_sel].ed);this.use_pp&&(a.power*=2,a.mass*=2,a.cooling*=2,a.fuelconsumption*=2,a.cost*=2,a.latstab*=2,a.structure*=2,a.maxstrain*=2,a.upkeep*=2,a.reqsections*=2,a.power=Math.floor(1E-6+this.mount_list[this.mount_sel].powerfactor*a.power));0==this.cowl_sel||"Rear-Mounted Pusher"!=this.mount_list[this.mount_sel].name&&"Center-Mounted Pusher"!=this.mount_list[this.mount_sel].name&&
"Fuselage Push-Pull"!=this.mount_list[this.mount_sel].name||(a.cost+=2);this.IsAirCooled()&&this.intake_fan?(a.mass+=3,a.latstab*=2,a.structure*=2,a.maxstrain*=2,a.cost+=4,a.era.push({name:"Air Cooling Fan",era:"WWII"})):this.intake_fan=!1;this.GetHasOilCooler()&&(a.drag+=Math.floor(a.power/15));this.GetIsPulsejet()||(a=a.Add(this.mount_list[this.mount_sel].stats),a.maxstrain-=Math.floor(1E-6+this.mount_list[this.mount_sel].strainfactor*this.etype_stats.stats.mass),a.drag+=Math.floor(1E-6+this.mount_list[this.mount_sel].dragfactor*
this.etype_stats.stats.mass));this.is_generator?(a.charge=Math.floor(1E-6+2*a.power/10)+2,a.power=0):this.has_alternator&&(a.charge=Math.floor(1E-6+a.power/10)+1,a.mass+=1,a.cost+=2);this.outboard_prop&&(a.drag+=3,this.use_pp&&(a.escape+=2));a.pitchspeed=0;a.reliability=0;return a}GetElectrics(){return{storage:0,equipment:[]}}}
class Radiator extends Part{constructor(a,b,c){super();this.need_cool=0;this.idx_mount=this.idx_type=1;this.engine_count=this.metal_area=this.idx_coolant=0;this.type_list=a;this.mount_list=b;this.coolant_list=c;this.harden_cool=!1}toJSON(){return{type:this.idx_type,mount:this.idx_mount,coolant:this.idx_coolant,harden_cool:this.harden_cool}}fromJSON(a,b){this.idx_type=a.type;this.idx_mount=a.mount;this.idx_coolant=a.coolant;10.85<b&&(this.harden_cool=a.harden_cool)}serialize(a){a.PushNum(this.idx_type);
a.PushNum(this.idx_mount);a.PushNum(this.idx_coolant);a.PushBool(this.harden_cool)}derserialize(a){this.idx_type=a.GetNum();this.idx_mount=a.GetNum();this.idx_coolant=a.GetNum();10.85<a.version&&(this.harden_cool=a.GetBool())}GetTypeList(){return this.type_list}GetMountList(){return this.mount_list}GetCoolantList(){return this.coolant_list}CanType(){var a=[...Array(this.type_list.length).fill(!0)];for(let b=0;b<this.type_list.length;b++)"Evaporation"==this.type_list[b].name&&this.metal_area<5*this.engine_count&&
(a[b]=!1);return a}SetTypeIndex(a){this.idx_type=a;this.CalculateStats()}GetTypeIndex(){return this.idx_type}SetParasol(a){this.has_parasol=a;this.CanMount()[this.idx_mount]||(this.idx_mount=0)}CanMount(){var a=[...Array(this.mount_list.length).fill(!0)];for(let b=0;b<this.mount_list.length;b++)"High Offset"!=this.mount_list[b].name||this.has_parasol||(a[b]=!1);return a}SetMountIndex(a){this.CanMount()[a]&&(this.idx_mount=a,this.CalculateStats())}GetMountIndex(){return this.idx_mount}SetCoolantIndex(a){this.idx_coolant=
a;this.CalculateStats()}GetCoolantIndex(){return this.idx_coolant}SetNeedCool(a,b){this.need_cool=a;this.engine_count=b}SetMetalArea(a){this.metal_area=a;this.CanType()[this.idx_type]||(this.idx_type=0)}GetHarden(){return this.harden_cool}SetHarden(a){this.harden_cool=a;this.CalculateStats()}VerifyHarden(){this.coolant_list[this.idx_coolant].harden&&(this.harden_cool=!0)}GetIsFlammable(){return this.coolant_list[this.idx_coolant].flammable}PartStats(){this.VerifyHarden();var a=new Stats;a.mass=3;
a=a.Add(this.type_list[this.idx_type].stats);a=a.Add(this.mount_list[this.idx_mount].stats);a=a.Add(this.coolant_list[this.idx_coolant].stats);a.drag+=Math.ceil(-1E-6+this.type_list[this.idx_type].dragpercool*(this.need_cool-a.cooling));this.harden_cool&&(a.cost+=2);return a}SetCalculateStats(a){this.CalculateStats=a}GetElectrics(){return{storage:0,equipment:[]}}}
class Engines extends Part{constructor(a){super();this.engines=[];this.radiators=[];this.mount_list=[];for(let b of a.mounts){let c={name:b.name,stats:new Stats(b),strainfactor:b.strainfactor,dragfactor:b.dragfactor,mount_type:b.location,powerfactor:b.powerfactor,reqED:!1,reqTail:!1,helicopter:b.helicopter,turbine:b.turbine};b.reqED&&(c.reqED=!0);b.reqTail&&(c.reqTail=!0);this.mount_list.push(c)}this.is_asymmetric=!1;this.r_type_list=[];for(let b of a["radiator-type"])this.r_type_list.push({name:b.name,
stats:new Stats(b),dragpercool:parseFloat(b.dragpercool)});this.r_mount_list=[];for(let b of a["radiator-mount"])this.r_mount_list.push({name:b.name,stats:new Stats(b)});this.r_coolant_list=[];for(let b of a["radiator-coolant"])this.r_coolant_list.push({name:b.name,harden:b.harden,flammable:b.flammable,stats:new Stats(b)});this.cowl_list=[];for(let b of a.cowling)this.cowl_list.push({name:b.name,stats:new Stats(b),ed:b.ed,mpd:b.mpd,air:b.air,liquid:b.liquid,rotary:b.rotary})}toJSON(){var a=[];for(b of this.engines)a.push(b.toJSON());
var b=[];for(let c of this.radiators)b.push(c.toJSON());return{engines:a,radiators:b,is_asymmetric:this.is_asymmetric}}fromJSON(a,b){this.radiators=[];for(var c of a.radiators){let d=new Radiator(this.r_type_list,this.r_mount_list,this.r_coolant_list);d.fromJSON(c,b);d.SetCalculateStats(this.CalculateStats);this.radiators.push(d)}this.engines=[];for(let d of a.engines)c=new Engine(this.mount_list,this.cowl_list),c.fromJSON(d,b),c.SetCalculateStats(this.CalculateStats),this.engines.push(c),c.SetNumRadiators(this.GetNumberOfRadiators());
this.is_asymmetric=a.is_asymmetric}serialize(a){a.PushNum(this.engines.length);for(let b of this.engines)b.serialize(a);a.PushNum(this.radiators.length);for(let b of this.radiators)b.serialize(a);a.PushBool(this.is_asymmetric)}deserialize(a){var b=a.GetNum();this.engines=[];for(var c=0;c<b;c++){var d=new Engine(this.mount_list,this.cowl_list);d.deserialize(a);d.SetCalculateStats(this.CalculateStats);this.engines.push(d)}b=a.GetNum();this.radiators=[];for(c=0;c<b;c++)d=new Radiator(this.r_type_list,
this.r_mount_list,this.r_coolant_list),d.derserialize(a),d.SetCalculateStats(this.CalculateStats),this.radiators.push(d);this.is_asymmetric=a.GetBool();for(let e of this.engines)e.SetNumRadiators(this.GetNumberOfRadiators())}GetHasOilTank(){for(let a of this.engines)if(a.GetCurrentStats().oiltank)return!0;return!1}GetReliabilityList(){var a=[];for(let b of this.engines)a.push(b.GetReliability());return a}GetMinIAF(){var a=0;for(let b of this.engines)a=Math.max(a,b.GetMinIAF());return a}GetMaxIAF(){var a=
100;for(let b of this.engines)a=Math.min(a,b.GetMaxIAF());return a}GetMinAltitude(){var a=0;for(let b of this.engines)a=Math.max(a,b.GetMinAltitude());return a}GetMaxAltitude(){var a=1E3;for(let b of this.engines)a=Math.min(a,b.GetMaxAltitude());return a}SetNumberOfEngines(a){if(a!=a||0>a)a=0;a=Math.floor(1E-6+a);for(a=Math.min(20,a);this.engines.length>a;)this.engines.pop();var b=null;for(0<this.engines.length&&(b=JSON.stringify(this.engines[this.engines.length-1].toJSON()));this.engines.length<
a;){let c=new Engine(this.mount_list,this.cowl_list);c.SetCalculateStats(this.CalculateStats);b&&c.fromJSON(JSON.parse(b),1E3);this.engines.push(c);c.SetNumRadiators(this.GetNumberOfRadiators())}this.CalculateStats()}GetNumberOfEngines(){var a=0;for(let b of this.engines)b.GetGenerator()||a++;return a}GetNumberOfItems(){return this.engines.length}GetEngine(a){return this.engines[a]}GetRadiator(a){return this.radiators[a]}SetNumberOfRadiators(a){if(a!=a||0>a)a=0;for(a=Math.floor(1E-6+a);this.radiators.length>
a;)this.radiators.pop();for(;this.radiators.length<a;){let b=new Radiator(this.r_type_list,this.r_mount_list,this.r_coolant_list);b.SetCalculateStats(this.CalculateStats);this.radiators.push(b)}for(let b of this.engines)b.SetNumRadiators(a);this.CalculateStats()}GetNumberOfRadiators(){0==this.radiators.length&&this.NeedCooling()?this.SetNumberOfRadiators(1):0<this.radiators.length&&!this.NeedCooling()&&this.SetNumberOfRadiators(0);return this.radiators.length}NeedCooling(){var a=!1;for(let b of this.engines)a=
a||b.NeedCooling();return a}UpdateReliability(a){for(let b of this.engines){let c=new Stats;b.GetRadiator()<this.radiators.length&&0<=b.GetRadiator()&&(c=this.radiators[b.GetRadiator()].PartStats());b.UpdateReliability(a.reliability+c.reliability)}}SetAsymmetry(a){this.is_asymmetric=a;this.CalculateStats()}GetAsymmetry(){return this.is_asymmetric}GetNumPropellers(){var a=0;for(let b of this.engines)a+=b.GetNumPropellers();return a}GetOverspeed(){var a=100;for(let b of this.engines)a=Math.min(a,b.GetOverspeed());
return a}GetRumble(){var a=0;for(let b of this.engines)a+=b.GetRumble();return a}GetMaxRumble(){var a=0;for(let b of this.engines)a=Math.max(a,b.GetRumble());return a}GetTractorSpinner(){var a={have:!1,spin_count:0,arty_spin_count:0};for(let c of this.engines){var b=c.GetTractorSpinner();b.has&&(a.have=!0,b.spinner[0]&&a.spin_count++,b.spinner[1]&&a.arty_spin_count++)}return a}GetPusherSpinner(){var a={have:!1,spin_count:0,arty_spin_count:0};for(let c of this.engines){var b=c.GetPusherSpinner();b.has&&
(a.have=!0,b.spinner[0]&&a.spin_count++,b.spinner[1]&&a.arty_spin_count++)}return a}IsElectrics(){for(let a of this.engines)if(a.IsElectrics())return!0;return!1}HaveParasol(a){for(let b of this.radiators)b.SetParasol(a)}SetMetalArea(a){for(let b of this.radiators)b.SetMetalArea(a)}SetTailMods(a,b,c){for(let d of this.engines)d.SetTailMods(a,b,c)}GetEngineHeight(){var a=2;for(let b of this.engines)a=Math.min(a,b.GetEngineHeight());return a}HasTractorRotary(){for(let a of this.engines)if(a.IsTractorRotary())return!0;
return!1}SetInternal(a){for(let b of this.engines)b.SetInternal(a);if(a)for(let b of this.radiators)b.SetMetalArea(0),b.SetParasol(!1)}HasPulsejet(){for(let a of this.engines)if(a.GetIsPulsejet())return!0;return!1}HasTurbineNoProp(){for(let a of this.engines)if(a.GetIsTurbine()&&0==a.GetNumPropellers())return!0;return!1}HasDiesel(){for(let a of this.engines)if(a.IsDiesel())return!0;return!1}GetEngineTypes(){var a=[];for(let b of this.engines)0<b.GetNumPropellers()?a.push({type:DRIVE_TYPE.PROPELLER,
num:b.GetNumPropellers()}):b.GetIsPulsejet()?a.push({type:DRIVE_TYPE.PULSEJET,num:0}):b.GetIsTurbine()&&a.push({type:DRIVE_TYPE.TURBINE,num:b.GetCurrentStats().stats.pitchspeed});return a}GetIsFlammable(){for(let a of this.radiators)if(a.GetIsFlammable())return!0;return!1}PartStats(){var a=new Stats,b=Array(this.GetNumberOfRadiators()).fill(null).map(()=>({cool:0,count:0})),c=0,d=100,e;for(e of this.engines){var f=e.PartStats();a=a.Add(f);e.NeedCooling()&&(b[e.GetRadiator()].cool+=e.GetCooling(),
b[e.GetRadiator()].count+=1);c+=e.GetCurrentStats().stats.cost;0<f.pitchspeed&&(d=Math.min(d,f.pitchspeed))}100>d&&(a.pitchspeed=d);a.upkeep=Math.floor(1E-6+Math.min(a.upkeep,c));c=new Stats;d=new Map;for(e=0;e<this.radiators.length;e++){f=this.radiators[e];f.SetNeedCool(b[e].cool,b[e].count);f=f.PartStats();c=c.Add(f);for(let g of f.warnings)(f=d.get(g.source))?(f.push(e+1),d.set(g.source,f)):d.set(g.source,[e+1])}for(let g of c.warnings)g.source=lu("Radiators #",StringFmt.Join(",",d.get(g.source)))+
" "+g.source;a=a.Add(c);this.is_asymmetric&&(a.latstab-=3);this.HasPulsejet()&&a.warnings.push({source:lu("Pulsejets"),warning:lu("Pulsejet Boost Warning"),color:WARNING_COLOR.WHITE});this.HasTurbineNoProp()&&a.warnings.push({source:lu("Turbine"),warning:lu("Turbine Boost Warning"),color:WARNING_COLOR.WHITE});this.HasDiesel()&&a.warnings.push({source:lu("Diesel"),warning:lu("Diesel Warning"),color:WARNING_COLOR.WHITE});b=0;for(let g of this.engines)!g.IsRotary()||g.GetUsePushPull()&&g.GetTorqueToStruct()||
(g.GetUsePushPull()&&g.IsTractor()?b+=2:g.IsTractor()?b++:g.IsPusher()&&b--);0<b?a.warnings.push({source:lu("Rotary"),warning:lu("Rotary Right Warning"),color:WARNING_COLOR.WHITE}):0>b&&a.warnings.push({source:lu("Rotary"),warning:lu("Rotary Left Warning"),color:WARNING_COLOR.WHITE});a.reliability=0;return a}SetCalculateStats(a){this.CalculateStats=a}GetHasTractorNacelles(){let a=0;for(let b of this.engines)b.GetIsTractorNacelle()&&a++;return 1<a}GetElectrics(){let a={storage:0,equipment:[]};for(let b=
0;b<this.engines.length;b++){let c=this.engines[b].PartStats();0!=c.charge&&a.equipment.push({source:lu("Vital Part Engine",b),charge:c.charge.toString()})}for(let b of this.radiators)a=MergeElectrics(a,b.GetElectrics());return a}}
class Propeller extends Part{constructor(a){super();this.engines=[];this.idx_prop=2;this.prop_list=[];for(let b of a.props)this.prop_list.push({name:b.name,stats:new Stats(b),energy:b.energy,turn:b.turn});this.idx_upg=0;this.upg_list=[];for(let b of a.upgrades)this.upg_list.push({name:b.name,stats:new Stats(b),energy:b.energy,turn:b.turn})}toJSON(){return{type:this.idx_prop,upgrade:this.idx_upg}}fromJSON(a,b){this.idx_prop=a.type;11.35>b?(this.idx_upg=0,a.use_variable&&(this.idx_upg=1),5==this.idx_prop&&
(this.idx_prop=this.idx_upg=2)):this.idx_upg=a.upgrade}serialize(a){a.PushNum(this.idx_prop);a.PushNum(this.idx_upg)}deserialize(a){this.idx_prop=a.GetNum();11.35>a.version?(this.idx_upg=0,a.GetBool()&&(this.idx_upg=1),5==this.idx_prop&&(this.idx_prop=this.idx_upg=2)):this.idx_upg=a.GetNum()}GetPropList(){return this.prop_list}GetUpgradeList(){return this.upg_list}SetPropIndex(a){this.idx_prop=a;this.CalculateStats()}GetPropIndex(){return this.idx_prop}SetUpgradeIndex(a){this.idx_upg=a;this.CalculateStats()}GetUpgradeIndex(){return this.idx_upg}SetEngineTypes(a){this.engines=
a}GetNumPropellers(){var a=0;for(let b of this.engines)b.type==DRIVE_TYPE.PROPELLER&&(a+=b.num);return a}GetEnergy(){if(this.acft_type==AIRCRAFT_TYPE.HELICOPTER)return 2.5;if(this.acft_type==AIRCRAFT_TYPE.ORNITHOPTER_BASIC)return 6;if(this.acft_type==AIRCRAFT_TYPE.ORNITHOPTER_FLUTTER)return 8;if(this.acft_type==AIRCRAFT_TYPE.ORNITHOPTER_BUZZER)return 5;if(0==this.engines.length)return 2.5;var a=999;for(let b of this.engines)switch(b.type){case DRIVE_TYPE.PROPELLER:a=Math.min(a,this.prop_list[this.idx_prop].energy+
this.upg_list[this.idx_upg].energy);break;case DRIVE_TYPE.PULSEJET:a=Math.min(a,5);break;case DRIVE_TYPE.TURBINE:a=Math.min(a,9);break;default:throw"Not a known Engine Type.";}return a}GetTurn(){if(this.acft_type==AIRCRAFT_TYPE.HELICOPTER)return 6;if(this.acft_type==AIRCRAFT_TYPE.ORNITHOPTER_BASIC)return 7;if(this.acft_type==AIRCRAFT_TYPE.ORNITHOPTER_FLUTTER)return 8;if(this.acft_type==AIRCRAFT_TYPE.ORNITHOPTER_BUZZER)return 5;if(0==this.engines.length)return 6;var a=999;for(let b of this.engines)switch(b.type){case DRIVE_TYPE.PROPELLER:a=
Math.min(a,this.prop_list[this.idx_prop].turn+this.upg_list[this.idx_upg].turn);break;case DRIVE_TYPE.PULSEJET:a=Math.min(a,7);break;case DRIVE_TYPE.TURBINE:a=Math.min(a,4);break;default:throw"Not a known Engine Type.";}return a}SetAcftType(a){this.acft_type=a}PartStats(){var a=new Stats;0!=this.GetNumPropellers()&&(a=a.Add(this.prop_list[this.idx_prop].stats.Multiply(this.GetNumPropellers())),a=a.Add(this.upg_list[this.idx_upg].stats.Multiply(this.GetNumPropellers())));if(this.acft_type==AIRCRAFT_TYPE.HELICOPTER)a.pitchboost=
.6,a.pitchspeed=1;else if(this.acft_type==AIRCRAFT_TYPE.ORNITHOPTER_BASIC)a.pitchboost=.6,a.pitchspeed=.8;else if(this.acft_type==AIRCRAFT_TYPE.ORNITHOPTER_FLUTTER)a.pitchboost=.8,a.pitchspeed=.8;else if(this.acft_type==AIRCRAFT_TYPE.ORNITHOPTER_BUZZER)a.pitchboost=1,a.pitchspeed=.6;else if(0==this.engines.length)a.pitchboost=.6,a.pitchspeed=1;else{a.pitchboost=999;a.pitchspeed=999;for(let b of this.engines)switch(b.type){case DRIVE_TYPE.PROPELLER:a.pitchboost=Math.min(a.pitchboost,this.prop_list[this.idx_prop].stats.pitchboost+
this.upg_list[this.idx_upg].stats.pitchboost);a.pitchspeed=Math.min(a.pitchspeed,this.prop_list[this.idx_prop].stats.pitchspeed+this.upg_list[this.idx_upg].stats.pitchspeed);break;case DRIVE_TYPE.PULSEJET:a.pitchboost=Math.min(a.pitchboost,.6);a.pitchspeed=Math.min(a.pitchspeed,1);break;case DRIVE_TYPE.TURBINE:a.pitchboost=Math.min(a.pitchboost,.2);a.pitchspeed=Math.min(a.pitchspeed,b.num);break;default:throw"Not a known Engine Type.";}}return a}SetCalculateStats(a){this.CalculateStats=a}GetElectrics(){return{storage:0,
equipment:[]}}}
class Frames extends Part{constructor(a){super();this.frame_list=[];for(let b of a.frames)this.frame_list.push({name:b.name,stats:new Stats(b),basestruct:b.basestructure,basecost:b.basecost,geodesic:b.geodesic});this.sel_skin=0;this.skin_list=[];for(let b of a.skin)this.skin_list.push({name:b.name,stats:new Stats(b),monocoque:b.monocoque,monocoque_structure:b.monocoque_structure,flammable:b.flammable,dragfactor:b.dragfactor,massfactor:b.massfactor});this.has_tractor_nacelles=this.boom=this.farman=
!1;this.sel_tail=2;this.tail_list=[];for(let b of a.tail)this.tail_list.push({name:b.name,stats:new Stats(b)});this.is_tandem=this.flying_wing=!1;this.section_list=[];this.tail_section_list=[];this.SetRequiredSections(1)}toJSON(){return{sections:this.section_list,tail_sections:this.tail_section_list,tail_index:this.sel_tail,use_farman:this.farman,use_boom:this.boom,flying_wing:this.flying_wing,sel_skin:this.sel_skin}}fromJSON(a,b){this.section_list=[];for(let c of a.sections)this.section_list.push({frame:c.frame,
geodesic:c.geodesic,monocoque:c.monocoque,lifting_body:c.lifting_body,internal_bracing:c.internal_bracing}),10.25>b&&(this.sel_skin=c.skin);this.tail_section_list=[];for(let c of a.tail_sections)this.tail_section_list.push({frame:c.frame,geodesic:c.geodesic,monocoque:c.monocoque,lifting_body:c.lifting_body,internal_bracing:c.internal_bracing}),10.25>b&&(this.sel_skin=c.skin);this.farman=a.use_farman;this.boom=a.use_boom;this.sel_tail=a.tail_index;this.flying_wing=a.flying_wing;10.25<b&&(this.sel_skin=
a.sel_skin)}serialize(a){a.PushNum(this.section_list.length);for(var b=0;b<this.section_list.length;b++){var c=this.section_list[b];a.PushNum(c.frame);a.PushBool(c.geodesic);a.PushBool(c.monocoque);a.PushBool(c.lifting_body);a.PushBool(c.internal_bracing)}a.PushNum(this.tail_section_list.length);for(b=0;b<this.tail_section_list.length;b++)c=this.tail_section_list[b],a.PushNum(c.frame),a.PushBool(c.geodesic),a.PushBool(c.monocoque),a.PushBool(c.lifting_body),a.PushBool(c.internal_bracing);a.PushNum(this.sel_tail);
a.PushBool(this.farman);a.PushBool(this.boom);a.PushBool(this.flying_wing);a.PushNum(this.sel_skin)}deserialize(a){var b=a.GetNum();this.section_list=[];for(var c=0;c<b;c++){var d={frame:0,skin:0,geodesic:!1,monocoque:!1,lifting_body:!1,internal_bracing:!1};d.frame=a.GetNum();10.25>a.version&&(this.sel_skin=a.GetNum());d.geodesic=a.GetBool();d.monocoque=a.GetBool();d.lifting_body=a.GetBool();d.internal_bracing=a.GetBool();this.section_list.push(d)}b=a.GetNum();this.tail_section_list=[];for(c=0;c<
b;c++)d={frame:0,skin:0,geodesic:!1,monocoque:!1,lifting_body:!1,internal_bracing:!1},d.frame=a.GetNum(),10.25>a.version&&(this.sel_skin=a.GetNum()),d.geodesic=a.GetBool(),d.monocoque=a.GetBool(),d.lifting_body=a.GetBool(),d.internal_bracing=a.GetBool(),this.tail_section_list.push(d);this.sel_tail=a.GetNum();this.farman=a.GetBool();this.boom=a.GetBool();this.flying_wing=a.GetBool();10.25<a.version&&(this.sel_skin=a.GetNum())}DuplicateSection(a,b=1){var c=this.section_list[a];c={frame:c.frame,geodesic:c.geodesic,
monocoque:c.monocoque,lifting_body:c.lifting_body,internal_bracing:c.internal_bracing};if(!c.internal_bracing||this.CountSections()+this.tail_section_list.length!=this.CountInternalBracing()){for(let d=0;d<b;d++)this.section_list.splice(a,0,c);this.CalculateStats()}}DuplicateTailSection(a,b=1){var c=this.tail_section_list[a];c={frame:c.frame,geodesic:c.geodesic,monocoque:c.monocoque,lifting_body:c.lifting_body,internal_bracing:c.internal_bracing};if(!c.internal_bracing||this.CountSections()!=this.CountInternalBracing()){for(let d=
0;d<b;d++)this.tail_section_list.splice(a,0,c);this.CalculateStats()}}DeleteSection(a){if(this.required_sections!=this.CountSections()||this.section_list[a].internal_bracing){this.section_list.splice(a,1);if(this.CountInternalBracing()>this.CountSections()+this.tail_section_list.length)for(a=this.section_list.length-1;0<=a;a--)if(this.section_list[a].internal_bracing){this.section_list.splice(a,1);break}this.CalculateStats()}}SetRequiredSections(a){this.required_sections=a;if(this.required_sections>
this.CountSections()&&(0==this.section_list.length&&this.section_list.push({frame:0,geodesic:!1,monocoque:!1,lifting_body:!1,internal_bracing:!1}),0<this.required_sections-this.CountSections()))for(a=this.section_list.length-1;0<=a;a--)if(!this.section_list[a].internal_bracing){this.DuplicateSection(a,this.required_sections-this.CountSections());break}}SetRequiredTailSections(a){for(a>this.tail_section_list.length&&(0==this.tail_section_list.length&&this.tail_section_list.push({frame:0,geodesic:!1,
monocoque:!1,lifting_body:!1,internal_bracing:!1}),0<a-this.tail_section_list.length&&this.DuplicateTailSection(this.tail_section_list.length-1,a-this.tail_section_list.length));a<this.tail_section_list.length;)this.tail_section_list.pop();for(;this.CountSections()+a<this.CountInternalBracing();){let b=this.section_list.length-1;for(;0<b&&!this.section_list[b].internal_bracing;b--);this.DeleteSection(b)}this.CalculateStats()}CountSections(){var a=0;for(let b of this.section_list)b.internal_bracing||
a++;return a}GetNumFrames(){return this.CountSections()+this.tail_section_list.length}CountInternalBracing(){var a=0;for(let b of this.section_list)b.internal_bracing&&a++;return a}BaseType(){var a=[...Array(this.frame_list.length).fill(0)],b;for(b of this.section_list)b.internal_bracing||a[b.frame]++;for(var c of this.tail_section_list)c.internal_bracing||a[c.frame]++;c=b=0;for(let d=a.length-1;0<=d;d--)a[d]>c&&(c=a[d],b=d);return b}GetFrameList(){return this.frame_list}GetSkinList(){return this.skin_list}GetSectionList(){return this.section_list}SetFrame(a,
b){this.section_list[a].frame=b;this.frame_list[b].geodesic||(this.section_list[a].geodesic=!1);this.CalculateStats()}SetGeodesic(a,b){this.frame_list[this.section_list[a].frame].geodesic&&(this.section_list[a].geodesic=b,this.CalculateStats())}SetMonocoque(a,b){this.skin_list[this.sel_skin].monocoque&&(this.section_list[a].monocoque=b,this.CalculateStats())}SetLiftingBody(a,b){this.skin_list[this.sel_skin].monocoque&&(this.section_list[a].lifting_body=b,this.CalculateStats())}SetInternalBracing(a,
b){b&&!this.section_list[a].internal_bracing&&this.PossibleInternalBracing(!0)&&this.CountSections()>this.required_sections?(this.section_list[a].internal_bracing=!0,this.section_list[a].monocoque=!1,this.section_list[a].lifting_body=!1,this.CalculateStats()):b||(this.section_list[a].internal_bracing=!1,this.CalculateStats())}PossibleInternalBracing(a=!1){var b=this.CountSections();this.farman||(b+=this.tail_section_list.length);a&&--b;return this.CountInternalBracing()+1<=b}PossibleGeodesic(a){return this.frame_list[this.section_list[a].frame].geodesic&&
!this.section_list[a].monocoque}PossibleMonocoque(a){return this.skin_list[this.sel_skin].monocoque&&!this.section_list[a].internal_bracing&&!this.section_list[a].lifting_body}PossibleLiftingBody(a){return this.skin_list[this.sel_skin].monocoque&&!this.section_list[a].internal_bracing&&!this.section_list[a].monocoque}PossibleTailGeodesic(a){return this.frame_list[this.tail_section_list[a].frame].geodesic&&!this.tail_section_list[a].monocoque}PossibleTailMonocoque(a){return this.skin_list[this.sel_skin].monocoque&&
!this.farman&&!this.tail_section_list[a].lifting_body}PossibleTailLiftingBody(a){return this.skin_list[this.sel_skin].monocoque&&!this.farman&&!this.tail_section_list[a].monocoque}PossibleRemoveSections(){return this.CountSections()>this.required_sections}GetFarmanOrBoom(){return this.farman||this.boom}SectionStats(a){var b=new Stats;b=b.Add(this.frame_list[a.frame].stats);a.geodesic&&(b.structure*=1.5,b.cost*=2,b.era.push({name:"Geodesic",era:"Coming Storm"}));a.lifting_body&&(b.wingarea+=3);a.internal_bracing||
(b.drag+=4,a.monocoque&&(b.mass=0,b.cost+=1,b.structure=this.skin_list[this.sel_skin].monocoque_structure),b=b.Add(this.skin_list[this.sel_skin].stats));return b}TailSectionStats(a){var b=new Stats;b=b.Add(this.frame_list[a.frame].stats);a.geodesic&&(b.structure*=1.5,b.cost*=2,b.era.push({name:"Geodesic",era:"Coming Storm"}));a.lifting_body&&(b.wingarea+=3);b.drag+=4;this.farman||(a.monocoque&&(b.mass=0,b.cost+=1,b.structure=this.skin_list[this.sel_skin].monocoque_structure),b=b.Add(this.skin_list[this.sel_skin].stats));
return b}CountMainLiftingBody(){var a=0;for(let b of this.section_list)b.lifting_body&&a++;return a}CountTailLiftingBody(){var a=0;for(let b of this.tail_section_list)b.lifting_body&&a++;return a}CountLiftingBody(){return this.CountMainLiftingBody()+this.CountTailLiftingBody()}SetIsTandem(a){this.is_tandem!=a&&(this.is_tandem=a,this.SetTailType(this.sel_tail))}SetTailType(a){0==this.tail_list[a].stats.reqsections&&this.is_tandem&&a++;this.sel_tail=a;this.SetRequiredTailSections(this.tail_list[a].stats.reqsections)}GetTailType(){return this.sel_tail}GetTailList(){return this.tail_list}GetTailSectionList(){return this.tail_section_list}SetUseFarman(a){(this.farman=
a)&&this.boom&&(this.boom=!1);if(this.farman)for(let b of this.tail_section_list)b.monocoque=!1,b.lifting_body=!1;this.CalculateStats()}GetUseFarman(){return this.farman}SetUseBoom(a){(this.boom=a)&&this.farman&&(this.farman=!1);this.CalculateStats()}GetUseBoom(){return this.boom}SetTailFrame(a,b){this.tail_section_list[a].frame=b;this.frame_list[b].geodesic||(this.tail_section_list[a].geodesic=!1);this.CalculateStats()}SetTailGeodesic(a,b){this.frame_list[this.tail_section_list[a].frame].geodesic&&
(this.tail_section_list[a].geodesic=b,this.CalculateStats())}SetTailMonocoque(a,b){this.skin_list[this.sel_skin].monocoque&&!this.farman&&(this.tail_section_list[a].monocoque=b,this.CalculateStats())}SetTailLiftingBody(a,b){this.skin_list[this.sel_skin].monocoque&&!this.farman&&(this.tail_section_list[a].lifting_body=b,this.CalculateStats())}SetHasTractorNacelles(a){this.has_tractor_nacelles=a}GetHasTractorNacelles(){return this.has_tractor_nacelles}CanFlyingWing(){for(let a of this.section_list)if(a.lifting_body)return!0;
for(let a of this.tail_section_list)if(a.lifting_body)return!0;return!1}GetFlyingWing(){return this.flying_wing}SetFlyingWing(a){a&&this.CanFlyingWing()?this.flying_wing=!0:this.flying_wing=!1;this.CalculateStats()}GetIsTailless(){return 0==this.tail_section_list.length}SetAllFrame(a){for(let b of this.section_list)b.frame=a,this.frame_list[a].geodesic||(b.geodesic=!1);for(let b of this.tail_section_list)b.frame=a,this.frame_list[a].geodesic||(b.geodesic=!1);this.CalculateStats()}SetAllSkin(a){this.sel_skin=
a;for(let b of this.section_list)b.internal_bracing||this.skin_list[a].monocoque||(b.monocoque=!1,b.lifting_body=!1);for(let b of this.tail_section_list)b.internal_bracing||this.skin_list[a].monocoque||(b.monocoque=!1,b.lifting_body=!1);this.CalculateStats()}GetArmor(){return"Dragon Skin"==this.skin_list[this.sel_skin].name?5:0}GetIsFlammable(){return this.skin_list[this.sel_skin].flammable?!0:!1}GetSkin(){return this.sel_skin}CanCutout(){let a=this.section_list.length*this.skin_list[this.sel_skin].stats.visibility;
a=this.farman?a+this.tail_section_list.length:a+this.tail_section_list.length*this.skin_list[this.sel_skin].stats.visibility;return 3>a}SetCalculateStats(a){this.CalculateStats=a}PartStats(){this.CanFlyingWing()||(this.flying_wing=!1);var a=new Stats,b=this.BaseType();a.structure=this.frame_list[b].basestruct;a.cost=this.frame_list[b].basecost;b=0>this.skin_list[this.sel_skin].monocoque_structure;for(var c of this.section_list)a=a.Add(this.SectionStats(c)),b=b&&(c.internal_bracing||c.monocoque);c=
new Stats;for(var d of this.tail_section_list)c=c.Add(this.TailSectionStats(d)),this.farman||(b=b&&(d.internal_bracing||d.monocoque));b&&(a.structure+=30);a=a.Add(this.tail_list[this.sel_tail].stats);this.boom&&(c.maxstrain-=c.mass,this.has_tractor_nacelles||(c.drag=Math.floor(1E-6+1.5*c.drag)));this.farman?(a.drag*=this.skin_list[this.sel_skin].dragfactor,a.mass*=this.skin_list[this.sel_skin].massfactor,a.visibility+=this.tail_section_list.length,c.mass=Math.floor(1E-6+.5*c.mass),a=a.Add(c)):(a=
a.Add(c),a.drag*=this.skin_list[this.sel_skin].dragfactor,a.mass*=this.skin_list[this.sel_skin].massfactor);d=this.CountLiftingBody();a.cost+=d;this.flying_wing?a.liftbleed+=5:a.drag+=d;this.PossibleRemoveSections()&&this.CountMainLiftingBody()<this.CountSections()&&a.warnings.push({source:lu("Frame Count"),warning:lu("Frame Count Warning"),color:WARNING_COLOR.YELLOW});a.structure=Math.floor(1E-6+a.structure);a.cost=Math.floor(1E-6+a.cost);a.visibility=Math.min(a.visibility,3);a.Round();return a}GetElectrics(){return{storage:0,
equipment:[]}}}var WING_DECK;(function(a){a[a.PARASOL=0]="PARASOL";a[a.SHOULDER=1]="SHOULDER";a[a.MID=2]="MID";a[a.LOW=3]="LOW";a[a.GEAR=4]="GEAR"})(WING_DECK||={});
class Wings extends Part{constructor(a){super();this.skin_list=[];for(let b of a.surface)this.skin_list.push({name:b.name,flammable:b.flammable,stats:new Stats(b),strainfactor:b.strainfactor,dragfactor:b.dragfactor,metal:b.metal,transparent:b.transparent});this.stagger_list=[];for(let b of a.stagger)this.stagger_list.push({name:b.name,inline:b.inline,wing_count:b.wing_count,hstab:b.hstab,stats:new Stats(b)});this.deck_list=[];for(let b of a.decks)this.deck_list.push({name:b.name,limited:b.limited,
stats:new Stats(b)});this.long_list=[];for(let b of a.largest)this.long_list.push({dragfactor:b.dragfactor,stats:new Stats(b)});this.wing_list=[];this.mini_wing_list=[];this.wing_stagger=Math.floor(1E-6+this.stagger_list.length/2);this.is_closed=this.is_swept=!1;this.rotor_span=0}toJSON(){return{wing_list:this.wing_list,mini_wing_list:this.mini_wing_list,wing_stagger:this.wing_stagger,is_swept:this.is_swept,is_closed:this.is_closed}}fromJSON(a,b){11.15<b?(this.wing_list=a.wing_list,this.mini_wing_list=
a.mini_wing_list):(this.wing_list=this.OldtoNew(a.wing_list),this.mini_wing_list=this.OldtoNew(a.mini_wing_list));this.wing_stagger=a.wing_stagger;this.is_swept=a.is_swept;this.is_closed=a.is_closed}OldtoNew(a){var b=[];for(let c of a)b.push({surface:c.surface,area:c.area,span:c.span,anhedral:c.anhedral,dihedral:c.dihedral,gull:!1,deck:c.deck});return b}serialize(a){a.PushNum(this.wing_list.length);for(var b=0;b<this.wing_list.length;b++){var c=this.wing_list[b];a.PushNum(c.surface);a.PushNum(c.area);
a.PushNum(c.span);a.PushNum(c.dihedral);a.PushNum(c.anhedral);a.PushBool(c.gull);a.PushNum(c.deck)}a.PushNum(this.mini_wing_list.length);for(b=0;b<this.mini_wing_list.length;b++)c=this.mini_wing_list[b],a.PushNum(c.surface),a.PushNum(c.area),a.PushNum(c.span),a.PushNum(c.dihedral),a.PushNum(c.anhedral),a.PushBool(c.gull),a.PushNum(c.deck);a.PushNum(this.wing_stagger);a.PushBool(this.is_swept);a.PushBool(this.is_closed)}deserialize(a){var b=a.GetNum();this.wing_list=[];for(var c=0;c<b;c++){var d={surface:0,
area:0,span:0,anhedral:0,dihedral:0,gull:!1,deck:0};d.surface=a.GetNum();d.area=a.GetNum();d.span=a.GetNum();11.15<a.version?(d.dihedral=a.GetNum(),d.anhedral=a.GetNum(),d.gull=a.GetBool()):(d.dihedral=a.GetNum(),d.anhedral=a.GetNum(),d.gull=!1);d.deck=a.GetNum();this.wing_list.push(d)}b=a.GetNum();this.mini_wing_list=[];for(c=0;c<b;c++)d={surface:0,area:0,span:0,anhedral:0,dihedral:0,gull:!1,deck:0},d.surface=a.GetNum(),d.area=a.GetNum(),d.span=a.GetNum(),11.15<a.version?(d.dihedral=a.GetNum(),d.anhedral=
a.GetNum(),d.gull=a.GetBool()):(d.dihedral=a.GetNum(),d.anhedral=a.GetNum(),d.gull=!1),d.deck=a.GetNum(),this.mini_wing_list.push(d);this.wing_stagger=a.GetNum();this.is_swept=a.GetBool();this.is_closed=a.GetBool()}SetRotorSpan(a){this.rotor_span=a}GetWingList(){return this.wing_list}GetMiniWingList(){return this.mini_wing_list}GetSkinList(){return this.skin_list}GetStaggerList(){return this.stagger_list}GetDeckList(){return this.deck_list}DeckCountFull(){var a=[...Array(this.deck_list.length).fill(0)];
for(let b of this.wing_list)a[b.deck]++;return a}DeckCountMini(){var a=[...Array(this.deck_list.length).fill(0)];for(let b of this.mini_wing_list)a[b.deck]++;return a}CanStagger(){var a=[...Array(this.stagger_list.length).fill(!1)];if(this.acft_type==AIRCRAFT_TYPE.ORNITHOPTER_FLUTTER)1<this.wing_list.length?a[1]=!0:a[0]=!0;else{if(1<this.wing_list.length)for(let b=1;b<this.stagger_list.length;b++)a[b]=!0;1==this.wing_list.length&&(a[0]=!0)}return a}SetAcftType(a){this.acft_type=a;a==AIRCRAFT_TYPE.ORNITHOPTER_FLUTTER&&
(this.wing_stagger=1<this.wing_list.length?1:0)}SetStagger(a){for(this.wing_stagger=a;this.stagger_list[a].wing_count<this.wing_list.length;)this.wing_list.pop();if(!this.stagger_list[a].inline){a=this.DeckCountFull();for(let b=this.wing_list.length-1;0<=b;b--){let c=this.wing_list[b];1<a[c.deck]&&(a[c.deck]--,this.wing_list.splice(b,1))}}this.CalculateStats()}GetStagger(){return 0<this.wing_list.length?this.wing_stagger:-1}CanAddFullWing(a){a>=this.deck_list.length&&console.log("Deck out of Bounds");
return!this.stagger_list[this.wing_stagger].inline&&(a==WING_DECK.SHOULDER&&this.HasPolishWing()||this.DeckCountFull()[a]==WING_DECK.SHOULDER&&this.deck_list[a].limited)||0!=this.DeckCountMini()[a]?!1:!0}CanAddMiniWing(a){var b=this.DeckCountFull(),c=this.DeckCountMini();return 0!=b[a]||0!=c[a]?!1:!0}CanMoveFullWing(a,b){var c=this.wing_list[a];this.wing_list.splice(a,1);b=this.CanAddFullWing(b);this.wing_list.splice(a,0,c);return b}CanMoveMiniWing(a,b){var c=this.mini_wing_list[a];this.mini_wing_list.splice(a,
1);b=this.CanAddMiniWing(b);this.mini_wing_list.splice(a,0,c);return b}GetWingHeight(){var a=0;for(let b of this.wing_list)a=Math.max(a,4-b.deck);return a}CanClosed(){return 1<this.wing_list.length}SetClosed(a){this.is_closed=0<this.wing_list.length?a:!1;this.CalculateStats()}GetClosed(){return this.is_closed}CanSwept(){return 0<this.wing_list.length}SetSwept(a){this.is_swept=0<this.wing_list.length?a:!1;this.CalculateStats()}GetSwept(){return this.is_swept}GetTandem(){return this.stagger_list[this.wing_stagger].inline&&
1<this.wing_list.length}GetMonoplane(){return 1==this.wing_list.length}GetStaggered(){return 0!=this.stagger_list[this.wing_stagger].stats.liftbleed}SetFullWing(a,b){this.wing_list.length!=a&&this.wing_list.splice(a,1);b.area!=b.area&&(b.area=3);b.area=Math.floor(1E-6+b.area);b.span!=b.span&&(b.span=1);b.span=Math.floor(1E-6+b.span);0<=b.deck&&(b.area=Math.max(b.area,3),b.span=Math.max(b.span,1),this.CanAddFullWing(b.deck)&&this.wing_list.splice(a,0,b));1<this.wing_list.length&&0==this.wing_stagger?
this.wing_stagger=4:1>=this.wing_list.length&&(this.wing_stagger=0);b.dihedral=Math.min(b.dihedral,b.span-1);b.anhedral=Math.min(b.anhedral,b.span-1-b.dihedral);this.CalculateStats()}SetMiniWing(a,b){this.mini_wing_list.length!=a&&this.mini_wing_list.splice(a,1);b.area!=b.area&&(b.area=2);b.area=Math.floor(1E-6+b.area);b.span!=b.span&&(b.span=1);b.span=Math.floor(1E-6+b.span);0<=b.deck&&(b.area=Math.max(b.area,1),b.area=Math.min(b.area,2),b.span=Math.max(b.span,1),this.CanAddMiniWing(b.deck)&&this.mini_wing_list.splice(a,
0,b));this.CalculateStats()}HasNonGullDeck(a){for(let b of this.wing_list)if(b.deck==a&&!b.gull)return!0;return!1}CanGull(a){if(a==WING_DECK.PARASOL){if(!this.GetTandem()&&this.HasNonGullDeck(WING_DECK.SHOULDER))return!1}else if(a==WING_DECK.SHOULDER||!this.GetTandem()&&this.HasNonGullDeck(a-1))return!1;return!0}IsFlammable(){for(let a of this.wing_list)if(this.skin_list[a.surface].flammable)return!0;for(let a of this.mini_wing_list)if(this.skin_list[a.surface].flammable)return!0;return!1}NeedHStab(){return this.stagger_list[this.wing_stagger].hstab}NeedTail(){return this.NeedHStab()||
!this.is_swept}GetSpan(){var a=0;for(let b of this.wing_list)a=Math.max(a,b.span);for(let b of this.mini_wing_list)a=Math.max(a,b.span);return a}GetArea(){var a=0;for(let b of this.wing_list)a+=b.area;for(let b of this.mini_wing_list)a+=b.area;return a}GetParasol(){for(let a of this.wing_list)if(a.deck==WING_DECK.PARASOL)return!0;for(let a of this.mini_wing_list)if(a.deck==WING_DECK.PARASOL)return!0;return!1}GetMetalArea(){var a=0;for(let b of this.wing_list)this.skin_list[b.surface].metal&&(a+=b.area);
for(let b of this.mini_wing_list)this.skin_list[b.surface].metal&&(a+=b.area);return a}GetWingDrag(){var a=0,b=this.DeckCountFull();for(let e of this.wing_list){var c=e.span;let f=e.area;e.gull&&(f=Math.floor(1E-6+1.1*f));c=Math.max(1,6*f*f/(c*c));c=Math.max(1,c*this.skin_list[e.surface].dragfactor);this.stagger_list[this.wing_stagger].inline&&1<b[e.deck]&&(c=Math.floor(1E-6+.75*c),c=Math.max(1,c));c=Math.floor(1E-6+c);a+=c}for(var d of this.mini_wing_list)b=d.span,c=Math.max(1,6*d.area*d.area/(b*
b)),c=Math.max(1,c*this.skin_list[d.surface].dragfactor),c=Math.floor(1E-6+c),a+=c;d=this.GetIsSesquiplane();(d.is||this.GetMonoplane())&&-1!=d.deck&&(a-=Math.floor(1E-6+0*(1-this.long_list[d.deck].dragfactor)));return a}GetIsFlammable(){for(let a of this.wing_list)if(this.skin_list[a.surface].flammable)return!0;for(let a of this.mini_wing_list)if(this.skin_list[a.surface].flammable)return!0;return!1}SetAircraftMass(a){this.plane_mass=a}GetPaperMass(){var a=0;for(let c of this.wing_list){var b=this.skin_list[c.surface].stats.Multiply(c.area);
b.Round();0>b.mass&&(a+=b.mass)}for(let c of this.mini_wing_list)b=this.skin_list[c.surface].stats.Multiply(c.area),b.Round(),0>b.mass&&(a+=b.mass);return Math.max(-Math.floor(1E-6+.25*this.plane_mass),a)}GetIsSesquiplane(){var a=0,b=-1,c=0,d=1E100,e=0;for(let f of this.wing_list)f.area>a?(a=f.area,b=f.deck,c=f.span):f.area==a&&(b=-1),d>f.area&&(d=f.area,e=f.span);return(a=a>=2*d&&!this.GetMonoplane()&&!this.GetTandem())?{is:a,deck:b,super_small:.75*c>=e}:{is:!1,deck:b,super_small:!1}}HasPolishWing(){for(let a of this.wing_list)if(a.deck==
WING_DECK.PARASOL&&1==a.gull)return!0;return!1}HasInvertedGull(){var a=-1;for(let b of this.wing_list)b.gull&&b.deck>WING_DECK.SHOULDER&&(a=Math.max(a,b.deck));return a}CanCutout(){let a=0;for(let b of this.wing_list)this.skin_list[b.surface].transparent&&(a+=1);return 3>a}PartStats(){this.CanClosed()||(this.is_closed=!1);this.CanSwept()||(this.is_swept=!1);var a=new Stats,b=!1,c=this.DeckCountFull(),d=!1,e=this.rotor_span,f=0,g=0;for(let k of this.wing_list){e=Math.max(e,k.span);b?(a.control+=3,
a.liftbleed+=5,--a.visibility):b=!0;var h=new Stats;h=h.Add(this.skin_list[k.surface].stats.Multiply(k.area));h.wingarea=k.area;h.maxstrain+=Math.min(0,-(2*k.span+k.area-10));this.acft_type==AIRCRAFT_TYPE.ORNITHOPTER_BUZZER&&(h.maxstrain+=Math.min(0,-(2*k.span+k.area-10)));h.maxstrain*=this.skin_list[k.surface].strainfactor;this.skin_list[k.surface].transparent&&3>g&&(h.visibility+=1,g+=1);let l=k.span,n=k.area;k.gull&&(n=Math.floor(1E-6+1.1*n));h.drag+=Math.max(1,6*n*n/(l*l));h.drag=Math.max(1,h.drag*
this.skin_list[k.surface].dragfactor);this.stagger_list[this.wing_stagger].inline&&1<c[k.deck]&&(h.drag=Math.floor(1E-6+.75*h.drag),h.drag=Math.max(1,h.drag));a=a.Add(this.deck_list[k.deck].stats);h.latstab+=k.dihedral-k.anhedral;h.liftbleed+=k.dihedral+k.anhedral;h.Round();e==k.span&&(f=h.drag);0>h.mass&&(h.mass=0);a=a.Add(h)}for(let k of this.mini_wing_list)e=Math.max(e,k.span),a.control+=1,d?a.liftbleed+=1:d=!0,h=this.skin_list[k.surface].stats.Multiply(k.area),h.wingarea=k.area,h.maxstrain+=Math.min(0,
-(2*k.span+k.area-10)),h.maxstrain*=this.skin_list[k.surface].strainfactor,b=k.span,h.drag=Math.max(1,h.drag+6*k.area*k.area/(b*b)),h.drag=Math.max(1,h.drag*this.skin_list[k.surface].dragfactor),h.latstab+=k.dihedral-k.anhedral,h.liftbleed+=k.dihedral+k.anhedral,h.Round(),0>h.mass&&(h.mass=0),a=a.Add(h);a.control+=8-e;a.latstab+=Math.min(0,e-8);d=this.GetIsSesquiplane();(d.is||this.GetMonoplane())&&-1!=d.deck&&(a=a.Add(this.long_list[d.deck].stats),a.drag-=Math.floor(1E-6+(1-this.long_list[d.deck].dragfactor)*
f));d.is&&(a.liftbleed-=2,a.control+=2);if(this.stagger_list[this.wing_stagger].inline)for(let k of c)1<k&&(a.liftbleed+=3*(k-1));this.HasPolishWing()&&(a.visibility+=1,a.maxstrain+=10);switch(this.HasInvertedGull()){case 4:a.maxstrain+=10,a.crashsafety+=1}(0<this.HasInvertedGull()||this.HasPolishWing())&&a.era.push({name:"Gull Wing",era:"Coming Storm"});this.is_swept&&(a.liftbleed+=5,a.latstab--);this.is_closed&&(c=Math.floor(1E-6+this.wing_list.length/2),a.mass+=1*c,a.control-=5*c,a.maxstrain+=
20*c);1<this.wing_list.length&&(a=a.Add(this.stagger_list[this.wing_stagger].stats));return a}SetCalculateStats(a){this.CalculateStats=a}GetElectrics(){let a={storage:0,equipment:[]};var b=0,c="";for(let d of this.wing_list){let e=this.skin_list[d.surface];0!=e.stats.charge&&(c=lu(e.name),b+=e.stats.charge*d.area)}b=Math.floor(1E-6+b);0!=b&&a.equipment.push({source:c,charge:b.toString()});return a}}
class Stabilizers extends Part{constructor(a){super();this.have_tail=!0;this.is_heli=this.is_swept=this.is_tandem=!1;this.hstab_sel=0;this.hstab_count=1;this.hstab_list=[];for(let b of a.hstab)this.hstab_list.push({name:b.name,is_canard:b.is_canard,increment:b.increment,stats:new Stats(b),dragfactor:b.dragfactor,is_vtail:b.is_vtail,is_tail:b.is_tail});this.vstab_sel=0;this.vstab_count=1;this.vstab_list=[];for(let b of a.vstab)this.vstab_list.push({name:b.name,increment:b.increment,stats:new Stats(b),
dragfactor:b.dragfactor,is_vtail:b.is_vtail,is_tail:b.is_tail})}toJSON(){return{hstab_sel:this.hstab_sel,hstab_count:this.hstab_count,vstab_sel:this.vstab_sel,vstab_count:this.vstab_count}}fromJSON(a,b){this.hstab_sel=a.hstab_sel;this.hstab_count=a.hstab_count;this.vstab_sel=a.vstab_sel;this.vstab_count=a.vstab_count}serialize(a){a.PushNum(this.hstab_sel);a.PushNum(this.hstab_count);a.PushNum(this.vstab_sel);a.PushNum(this.vstab_count)}deserialize(a){this.hstab_sel=a.GetNum();this.hstab_count=a.GetNum();
this.vstab_sel=a.GetNum();this.vstab_count=a.GetNum()}GetHStabList(){return this.hstab_list}GetVStabList(){return this.vstab_list}GetHStabType(){return this.hstab_sel}SetHStabType(a){if("The Wings"!=this.hstab_list[a].name||this.is_tandem||this.is_swept)this.hstab_list[a].is_vtail?this.SetVTail():this.hstab_list[this.hstab_sel].is_vtail&&(this.vstab_sel=0,this.vstab_count=1),this.hstab_sel=a,this.SetHStabCount(this.hstab_count),this.CalculateStats()}GetHValidList(){var a=[];if(this.is_heli)a=Array(this.hstab_list.length).fill(!1),
this.have_tail?a[0]=!0:a[1]=!0;else for(let b of this.hstab_list)"The Wings"!=b.name&&"Outboard"!=b.name||this.is_tandem||this.is_swept?b.is_tail&&!this.have_tail?a.push(!1):a.push(!0):a.push(!1);return a}GetIsVTail(){return this.hstab_list[this.hstab_sel].is_vtail}SetVTail(){for(var a=0;a<this.hstab_list.length;a++)this.hstab_list[a].is_vtail&&(this.hstab_sel=a);for(a=0;a<this.vstab_list.length;a++)this.vstab_list[a].is_vtail&&(this.vstab_sel=a);this.hstab_count=1;this.vstab_count=0}GetVStabType(){return this.vstab_sel}SetVStabType(a){if("Outboard"!=
this.vstab_list[a].name||this.CanVOutboard())this.vstab_list[a].is_vtail?this.SetVTail():this.vstab_list[this.vstab_sel].is_vtail&&(this.hstab_sel=0,this.vstab_count=1),this.vstab_sel=a,this.SetVStabCount(this.vstab_count),this.CalculateStats()}GetVValidList(){var a=[];if(this.is_heli)a=Array(this.vstab_list.length).fill(!1),a[0]=!0;else for(let b of this.vstab_list)"Outboard"!=b.name||this.CanVOutboard()?b.is_tail&&!this.have_tail?a.push(!1):a.push(!0):a.push(!1);return a}GetHStabCount(){return this.hstab_count}SetHStabCount(a){if(a!=
a||0>a)a=0;this.hstab_count=Math.floor(1E-6+a);if(0!=this.hstab_list[this.hstab_sel].increment)for(;0!=this.hstab_count%this.hstab_list[this.hstab_sel].increment;)this.hstab_count++;else this.hstab_count=0;this.CalculateStats()}GetHStabIncrement(){return 0<=this.hstab_sel?this.hstab_list[this.hstab_sel].increment:1}GetVStabCount(){return this.vstab_count}SetVStabCount(a){if(a!=a||0>a)a=0;this.vstab_count=Math.floor(1E-6+a);if(0!=this.vstab_list[this.vstab_sel].increment)for(;0!=this.vstab_count%this.vstab_list[this.vstab_sel].increment;)this.vstab_count++;
else this.vstab_count=0;this.CalculateStats()}GetVStabIncrement(){return 0<=this.vstab_sel?this.vstab_list[this.vstab_sel].increment:1}SetEngineCount(a){this.engine_count=a}GetIsTandem(){return this.is_tandem}SetIsTandem(a){this.is_tandem=a}SetIsSwept(a){this.is_swept=a}CanVOutboard(){return this.is_swept||this.is_tandem||this.hstab_list[this.hstab_sel].is_canard&&0<this.hstab_count}GetVOutboard(){return"Outboard"==this.vstab_list[this.vstab_sel].name}GetCanard(){return this.hstab_list[this.hstab_sel].is_canard}SetLiftingArea(a){this.lifting_area=
a}SetHaveTail(a){(this.have_tail=a)||(this.GetHValidList()[this.hstab_sel]||(this.hstab_sel=2),a=this.GetVValidList(),a[this.vstab_sel]||(a[1]||(this.hstab_sel=2),this.vstab_sel=1,0!=this.vstab_count%2&&this.vstab_count++));this.is_heli&&(this.hstab_sel=this.have_tail?0:1,this.hstab_count=1)}SetHelicopter(a){if(this.is_heli=a)this.have_tail=!0,this.is_swept=this.is_tandem=!1,this.hstab_sel=this.engine_count=this.lifting_area=0,this.hstab_count=1,this.vstab_sel=0,this.vstab_count=1}SetCalculateStats(a){this.CalculateStats=
a}PartStats(){var a=this.GetHValidList();a[this.hstab_sel]||(this.hstab_sel=0,a[this.hstab_sel]||(this.hstab_count=this.hstab_sel=0));a=this.GetVValidList();a[this.vstab_sel]||(this.vstab_sel=0,a[this.vstab_sel]||(this.vstab_count=this.vstab_sel=0));a=new Stats;if(0<this.hstab_count)if(a=a.Add(this.hstab_list[this.hstab_sel].stats),this.is_heli){var b=Math.floor(1E-6+this.wing_drag/8*this.hstab_list[this.hstab_sel].dragfactor);a.drag+=Math.max(Math.ceil(1*this.hstab_list[this.hstab_sel].dragfactor),
b)}else b=Math.floor(1E-6+this.wing_drag/4*this.hstab_list[this.hstab_sel].dragfactor),a.drag+=Math.max(1,b);else if(0>this.hstab_sel||0!=this.hstab_list[this.hstab_sel].increment)a.pitchstab-=Math.floor(1E-6+this.lifting_area/2),a.liftbleed+=5;if(0<this.vstab_count)a=a.Add(this.vstab_list[this.vstab_sel].stats),this.is_heli?(b=Math.floor(1E-6+this.wing_drag/16*this.vstab_list[this.vstab_sel].dragfactor),a.drag+=Math.max(Math.ceil(1*this.hstab_list[this.hstab_sel].dragfactor),b)):(b=Math.floor(1E-6+
this.wing_drag/8*this.vstab_list[this.vstab_sel].dragfactor),a.drag+=Math.max(1,b));else if(0>this.vstab_sel||0!=this.vstab_list[this.vstab_sel].increment||0==this.vstab_list[this.vstab_sel].increment&&0==this.hstab_count)a.latstab-=this.lifting_area;a.drag+=2*(Math.max(0,this.hstab_count-1)+Math.max(0,this.vstab_count-1));if(0<=this.vstab_sel&&0!=this.vstab_list[this.vstab_sel].increment){b=Math.max(0,this.hstab_count-1);var c=Math.min(this.engine_count-1,this.vstab_count-1);b+=Math.max(0,this.vstab_count-
1-c)}else c=Math.max(0,Math.min(this.engine_count-1,this.hstab_count-1)),b=Math.max(0,this.hstab_count-1-c);a.control+=3*c+b;return a}GetElectrics(){return{storage:0,equipment:[]}}}
class ControlSurfaces extends Part{constructor(a){super();this.mp=this.wing_area=this.is_cantilever=this.span=0;this.is_boom=!1;this.acft_type=AIRCRAFT_TYPE.AIRPLANE;this.aileron_sel=0;this.aileron_list=[];for(let b of a.ailerons)this.aileron_list.push({name:b.name,warping:b.warping,stats:new Stats(b)});this.rudder_sel=0;this.rudder_list=[];for(let b of a.rudders)this.rudder_list.push({name:b.name,stats:new Stats(b)});this.elevator_sel=0;this.elevator_list=[];for(let b of a.elevators)this.elevator_list.push({name:b.name,
stats:new Stats(b)});this.flaps_sel=0;this.flaps_list=[];for(let b of a.flaps)this.flaps_list.push({name:b.name,costfactor:b.costfactor,stats:new Stats(b)});this.slats_sel=0;this.slats_list=[];for(let b of a.slats)this.slats_list.push({name:b.name,stats:new Stats(b)});this.drag_list=[];for(let b of a.drag_inducers)this.drag_list.push({name:b.name,stats:new Stats(b)});this.drag_sel=[...Array(this.drag_list.length).fill(!1)]}toJSON(){return{aileron_sel:this.aileron_sel,rudder_sel:this.rudder_sel,elevator_sel:this.elevator_sel,
flaps_sel:this.flaps_sel,slats_sel:this.slats_sel,drag_sel:this.drag_sel}}fromJSON(a,b){this.aileron_sel=a.aileron_sel;this.rudder_sel=a.rudder_sel;this.elevator_sel=a.elevator_sel;this.flaps_sel=a.flaps_sel;this.slats_sel=a.slats_sel;this.drag_sel=BoolArr(a.drag_sel,this.drag_sel.length)}serialize(a){a.PushNum(this.aileron_sel);a.PushNum(this.rudder_sel);a.PushNum(this.elevator_sel);a.PushNum(this.flaps_sel);a.PushNum(this.slats_sel);a.PushBoolArr(this.drag_sel)}deserialize(a){this.aileron_sel=a.GetNum();
this.rudder_sel=a.GetNum();this.elevator_sel=a.GetNum();this.flaps_sel=a.GetNum();this.slats_sel=a.GetNum();this.drag_sel=a.GetBoolArr(this.drag_sel.length)}GetAileronList(){return this.aileron_list}CanAileron(){var a=[];if(IsAnyOrnithopter(this.acft_type))for(let b of this.aileron_list)a.push(b.warping);else for(let b of this.aileron_list)b.warping&&0==this.wing_area?a.push(!1):a.push(!0);return a}GetAileron(){return this.aileron_sel}SetAileron(a){this.aileron_sel=a;this.CalculateStats()}GetRudderList(){return this.rudder_list}CanRudder(){return this.can_rudder}SetCanRudder(a){(this.can_rudder=
a)||(this.rudder_sel=0)}GetRudder(){return this.rudder_sel}SetRudder(a){this.rudder_sel=a;this.CalculateStats()}GetElevatorList(){return this.elevator_list}CanElevator(){return this.can_elevator}SetCanElevator(a){(this.can_elevator=a)||(this.elevator_sel=0)}GetElevator(){return this.elevator_sel}SetElevator(a){this.elevator_sel=a;this.CalculateStats()}GetFlapsList(){return this.flaps_list}GetFlaps(){return this.flaps_sel}SetFlaps(a){this.flaps_sel=a;this.CalculateStats()}GetFlapCost(a){a&&(this.mp=
a);return 0<this.flaps_list[this.flaps_sel].costfactor?Math.max(1,Math.floor(1E-6+this.flaps_list[this.flaps_sel].costfactor*this.mp)):0}GetSlatsList(){return this.slats_list}GetSlats(){return this.slats_sel}SetSlats(a){this.slats_sel=a;this.CalculateStats()}GetDragList(){return this.drag_list}GetDrag(){return this.drag_sel}SetDrag(a,b){this.drag_sel[a]=b;this.CalculateStats()}SetNumCantilever(a){this.is_cantilever=a}SetSpan(a){this.span=a}SetWingArea(a){this.wing_area=a}SetAcftType(a){this.acft_type=
a;if(this.acft_type==AIRCRAFT_TYPE.HELICOPTER){for(a=this.slats_sel=this.flaps_sel=this.elevator_sel=this.rudder_sel=this.aileron_sel=0;a<this.drag_sel.length;a++)this.drag_sel[a]=!1;this.wing_area=this.is_cantilever=this.span=0}else IsAnyOrnithopter(this.acft_type)&&(this.aileron_sel=this.CanAileron().findIndex(b=>b),this.is_cantilever=0)}SetBoomTail(a){this.is_boom=a}SetIsVTail(a){a&&(this.rudder_sel=this.elevator_sel)}SetCalculateStats(a){this.CalculateStats=a}PartStats(){var a=new Stats;this.aileron_list[this.aileron_sel].warping&&
0==this.wing_area&&(this.aileron_sel=0);a=a.Add(this.aileron_list[this.aileron_sel].stats);this.aileron_list[this.aileron_sel].warping&&(a.maxstrain-=this.span,this.is_cantilever&&(a.cost+=2*this.is_cantilever,a.era.push({name:lu("Cantilever Wing Warping"),era:"Last Hurrah"})),this.is_boom&&(a.pitchstab-=2,a.latstab-=2,a.warnings.push({source:lu("Wing Warping"),warning:lu("Wing Warping Warning"),color:WARNING_COLOR.WHITE})));a=a.Add(this.rudder_list[this.rudder_sel].stats);a=a.Add(this.elevator_list[this.elevator_sel].stats);
a=a.Add(this.flaps_list[this.flaps_sel].stats);a=a.Add(this.slats_list[this.slats_sel].stats);for(let b=0;b<this.drag_list.length;b++)this.drag_sel[b]&&(a=a.Add(this.drag_list[b].stats));return a}GetElectrics(){return{storage:0,equipment:[]}}}
class Reinforcement extends Part{constructor(a){super();this.ext_wood_list=[];for(let b of a.external_wood)this.ext_wood_list.push({name:b.name,tension:b.tension,config:b.config,first:b.first,small_sqp:b.small_sqp,ornith:b.ornith,stats:new Stats(b)});this.ext_wood_count=[...Array(this.ext_wood_list.length).fill(0)];this.ext_steel_list=[];for(let b of a.external_steel)this.ext_steel_list.push({name:b.name,tension:b.tension,config:b.config,first:b.first,small_sqp:b.small_sqp,ornith:b.ornith,stats:new Stats(b)});
this.ext_steel_count=[...Array(this.ext_steel_list.length).fill(0)];this.ext_cabane_list=[];for(let b of a.cabane)this.ext_cabane_list.push({name:b.name,tension:b.tension,stats:new Stats(b)});this.cabane_sel=0;this.cant_list=[];for(let b of a.cantilever)this.cant_list.push({name:b.name,limited:b.limited,stats:new Stats(b)});this.cant_count=[...Array(this.cant_list.length).fill(0)];this.is_monoplane=this.is_tandem=this.is_staggered=this.wing_blades=this.wires=!1;this.can_external=!0;this.cant_lift=
this.acft_structure=0;this.acft_type=AIRCRAFT_TYPE.AIRPLANE}toJSON(){return{ext_wood_count:this.ext_wood_count,ext_steel_count:this.ext_steel_count,cant_count:this.cant_count,wires:this.wires,cabane_sel:this.cabane_sel,wing_blades:this.wing_blades}}fromJSON(a,b){this.ext_wood_count=NumArr(a.ext_wood_count,this.ext_wood_count.length);this.ext_steel_count=NumArr(a.ext_steel_count,this.ext_steel_count.length);this.cant_count=NumArr(a.cant_count,this.cant_count.length);this.wires=a.wires;this.cabane_sel=
a.cabane_sel;this.wing_blades=10.25<b?a.wing_blades:!1;10.45>b&&(this.cant_count[0]*=2,this.cant_count[1]*=2,this.cant_count[2]*=3,this.cant_count[3]*=2)}serialize(a){a.PushNumArr(this.ext_wood_count);a.PushNumArr(this.ext_steel_count);a.PushNumArr(this.cant_count);a.PushBool(this.wires);a.PushNum(this.cabane_sel);a.PushBool(this.wing_blades)}deserialize(a){this.ext_wood_count=a.GetNumArr(this.ext_wood_count.length);this.ext_steel_count=a.GetNumArr(this.ext_steel_count.length);this.cant_count=a.GetNumArr(this.cant_count.length);
this.wires=a.GetBool();this.cabane_sel=a.GetNum();this.wing_blades=10.25<a.version?a.GetBool():!1;10.45>a.version&&(this.cant_count[0]*=2,this.cant_count[1]*=2,this.cant_count[2]*=3,this.cant_count[3]*=2)}GetExternalList(){return this.ext_wood_list}GetCantileverList(){return this.cant_list}CanExternalWood(){var a=[...Array(this.ext_wood_list.length).fill(this.can_external)];for(let b=0;b<this.ext_wood_list.length;b++)this.acft_type==AIRCRAFT_TYPE.ORNITHOPTER_FLUTTER?a[b]=this.ext_wood_list[b].ornith:
this.limited_sqp&&(a[b]=this.ext_wood_list[b].small_sqp),this.wires||"Wing Truss"!=this.ext_wood_list[b].name&&"Wire Root"!=this.ext_wood_list[b].name||(a[b]=!1);return a}GetExternalWoodCount(){return this.ext_wood_count}SetExternalWoodCount(a,b){if(b!=b||0>b)b=0;b=Math.floor(1E-6+b);this.ext_wood_count[a]=b;this.CalculateStats()}CanExternalSteel(){var a=[...Array(this.ext_steel_list.length).fill(this.can_external)];for(let b=0;b<this.ext_steel_list.length;b++)this.acft_type==AIRCRAFT_TYPE.ORNITHOPTER_FLUTTER?
a[b]=this.ext_steel_list[b].ornith:this.limited_sqp&&(a[b]=this.ext_steel_list[b].small_sqp),this.wires||"Steel Wing Truss"!=this.ext_steel_list[b].name&&"Steel Wire Root"!=this.ext_steel_list[b].name||(a[b]=!1);return a}GetExternalSteelCount(){return this.ext_steel_count}SetExternalSteelCount(a,b){if(b!=b||0>b)b=0;b=Math.floor(1E-6+b);this.ext_steel_count[a]=b;this.CalculateStats()}GetCantileverCount(){return this.cant_count}GetTotalCantilevers(){var a=0;for(let b=0;b<this.cant_count.length;b++)a+=
this.cant_count[b];return a}GetIsCantilever(){var a=0;for(let b of this.cant_count)a+=b;return 0<a}SetCantileverCount(a,b){if(b!=b||0>b)b=0;b=Math.floor(1E-6+b);this.ImplSCC(a,b);this.CalculateStats()}ImplSCC(a,b){var c=b-this.cant_count[a];if(this.cant_list[a].limited&&0<b){b=this.TotalStructure();for(let d=0;d<this.cant_list.length;d++)this.cant_list[d].limited&&(b-=5*this.cant_count[d]*this.cant_list[d].stats.mass);c=Math.min(c,Math.floor(1E-6+b/(5*this.cant_list[a].stats.mass)))}this.cant_count[a]+=
c;return 0!=c}GetWires(){return this.wires}SetWires(a){this.wires=a;this.CalculateStats()}SetStaggered(a){this.is_staggered=a}SetTandem(a){this.is_tandem=a}SetMonoplane(a){this.is_monoplane=a}SetCanUseExternal(a){this.can_external=a}SetAcftStructure(a){var b=this.acft_structure;this.acft_structure=a;a=!1;if(b>this.acft_structure)for(b=this.cant_list.length-1;0<=b;b--)a=a||this.ImplSCC(b,this.cant_count[b]);a&&this.CalculateStats()}TotalStructure(){var a=this.ext_cabane_list[this.cabane_sel].stats.structure,
b=!1;for(let c=0;c<this.ext_wood_list.length;c++)if(a+=this.ext_wood_count[c]*this.ext_wood_list[c].stats.structure,a+=this.ext_steel_count[c]*this.ext_steel_list[c].stats.structure,0<this.ext_wood_count[c]||0<this.ext_steel_count[c])b=!0;b&&(a+=5);return this.acft_structure+a}GetCantileverType(){var a=this.cant_count[0]+this.cant_count[4];return 0<this.cant_count[1]+this.cant_count[2]+this.cant_count[3]?2:0<a?1:0}GetCabaneList(){return this.ext_cabane_list}GetCabane(){return this.cabane_sel}SetCabane(a){this.cabane_sel=
a;this.CalculateStats()}SetCantLift(a){this.cant_lift=a}CanWingBlade(){for(let a of this.ext_wood_count)if(0<a)return!1;for(let a of this.ext_steel_count)if(0<a)return!1;return 0==this.cabane_sel&&0<this.cant_count[2]}GetWingBlade(){return this.wing_blades}SetWingBlade(a){this.wing_blades=a;this.CalculateStats()}SetAircraftType(a){this.acft_type=a;a==AIRCRAFT_TYPE.HELICOPTER&&(this.is_staggered=this.is_tandem=this.is_monoplane=this.can_external=!1);a==AIRCRAFT_TYPE.ORNITHOPTER_BUZZER&&(this.can_external=
!1);a=this.CanExternalWood();for(var b=0;b<this.ext_wood_count.length;b++)a[b]||(this.ext_wood_count[b]=0);a=this.CanExternalSteel();for(b=0;b<this.ext_steel_count.length;b++)a[b]||(this.ext_steel_count[b]=0)}SetSesquiplane(a){this.tension_sqp=a.is&&a.super_small;if(this.limited_sqp=a.is&&!a.super_small){for(a=0;a<this.ext_wood_list.length;a++)this.ext_wood_list[a].small_sqp||(this.ext_wood_count[a]=0);for(a=0;a<this.ext_steel_list.length;a++)this.ext_steel_list[a].small_sqp||(this.ext_steel_count[a]=
0)}}SetCalculateStats(a){this.CalculateStats=a}PartStats(){var a=new Stats;switch(this.acft_type){case AIRCRAFT_TYPE.HELICOPTER:case AIRCRAFT_TYPE.ORNITHOPTER_BUZZER:case AIRCRAFT_TYPE.ORNITHOPTER_FLUTTER:this.cabane_sel=0}var b=1;this.is_monoplane?b=.6:this.is_tandem?b=.8:this.is_staggered&&(b=.9);this.tension_sqp&&(b-=.15);this.acft_type==AIRCRAFT_TYPE.ORNITHOPTER_BASIC&&(b=.5);if(!this.can_external){for(var c=0;c<this.ext_wood_count.length;c++)this.ext_wood_count[c]=0;for(c=0;c<this.ext_steel_count.length;c++)this.ext_steel_count[c]=
0;this.cabane_sel=0;this.wires=!1}for(var d=c=0,e=!1,f=0;f<this.ext_wood_list.length;f++)if(d+=this.ext_wood_count[f],0<this.ext_wood_count[f]){e=e||this.ext_wood_list[f].first;var g=this.ext_wood_list[f].stats;g=g.Multiply(this.ext_wood_count[f]);a=a.Add(g);c=this.ext_wood_list[f].config?c+b*this.ext_wood_list[f].tension*this.ext_wood_count[f]:c+this.ext_wood_list[f].tension*this.ext_wood_count[f]}for(f=0;f<this.ext_steel_list.length;f++)d+=this.ext_steel_count[f],0<this.ext_steel_count[f]&&(e=e||
this.ext_wood_list[f].first,g=this.ext_steel_list[f].stats.Clone(),g=g.Multiply(this.ext_steel_count[f]),a=a.Add(g),c=this.ext_steel_list[f].config?c+b*this.ext_steel_list[f].tension*this.ext_steel_count[f]:c+this.ext_steel_list[f].tension*this.ext_steel_count[f]);this.acft_type==AIRCRAFT_TYPE.ORNITHOPTER_BASIC&&(a.maxstrain=Math.floor(1E-6+.5*a.maxstrain));e&&(a.structure+=5,a.maxstrain+=10,c+=10);e=this.ext_cabane_list[this.cabane_sel].stats.Clone();a=a.Add(e);c+=b*this.ext_cabane_list[this.cabane_sel].tension;
0<this.cabane_sel&&(d+=1);this.wires&&(a.maxstrain+=Math.floor(1E-6+c),a.drag+=3*d);b=!1;for(c=0;c<this.cant_list.length;c++)0<this.cant_count[c]&&(b=!0,d=this.cant_list[c].stats,d=d.Multiply(this.cant_count[c]),a=a.Add(d));this.CanWingBlade()?this.wing_blades&&(a.mass*=2,a.warnings.push({source:lu("Wing Blades"),warning:lu("Wing Blades Warning"),color:WARNING_COLOR.WHITE})):this.wing_blades=!1;b&&(a.cost+=5,a.liftbleed-=this.cant_lift);return a}GetElectrics(){return{storage:0,equipment:[]}}}
class Fuel extends Part{constructor(a){super();this.tank_stats=[];this.tank_count=[];for(let b of a.tanks)this.tank_stats.push({name:b.name,stats:new Stats(b),internal:b.internal,cantilever:b.cantilever}),this.tank_count.push(0);this.is_cantilever=this.self_sealing=!1;this.wing_area=-1}toJSON(){return{tank_count:this.tank_count,self_sealing:this.self_sealing,fire_extinguisher:this.fire_extinguisher}}fromJSON(a,b){this.tank_count=NumArr(a.tank_count,this.tank_count.length);this.self_sealing=a.self_sealing;
this.fire_extinguisher=a.fire_extinguisher;this.wing_area=-1}serialize(a){a.PushNumArr(this.tank_count);a.PushBool(this.self_sealing);a.PushBool(this.fire_extinguisher)}deserialize(a){this.tank_count=a.GetNumArr(this.tank_count.length);this.self_sealing=a.GetBool();this.fire_extinguisher=a.GetBool();this.wing_area=-1}GetTankList(){return this.tank_stats}GetTankEnabled(){var a=[];for(let b of this.tank_stats)!this.is_cantilever&&b.cantilever?a.push(!1):a.push(!0);return a}GetTankCount(){return this.tank_count}SetTankCount(a,
b){if(b!=b||0>b)b=0;b=Math.floor(1E-6+b);this.tank_count[a]=b;this.VerifyOK();this.CalculateStats()}SetCantilever(a){this.is_cantilever&&!a&&(this.is_cantilever=a,this.VerifyOK()&&this.CalculateStats());this.is_cantilever=a}SetArea(a){this.wing_area>a&&(this.wing_area=a,this.VerifyOK()&&this.CalculateStats());this.wing_area=a}VerifyOK(){if(-1!=this.wing_area){for(var a=0,b=0;b<this.tank_count.length;b++)this.tank_stats[b].cantilever&&(a+=this.tank_count[b]);b=Math.floor(1E-6+this.wing_area/10);this.is_cantilever||
(b=0);b=a-b;for(a=0<b;0<b;)for(let c=this.tank_count.length-1;0<=c;c--)if(this.tank_stats[c].cantilever){this.tank_count[c]--;b--;break}for(b=0;b<this.tank_count.length;b++)0==this.tank_stats[b].stats.wetmass&&(this.tank_count[b]=Math.min(4,this.tank_count[b]));return a}return!1}GetSealingEnabled(){var a=0;for(let b=0;b<this.tank_count.length;b++)this.tank_stats[b].internal&&(a+=this.tank_count[b]);return 0<a}GetSelfSealing(){return this.self_sealing}SetSelfSealing(a){this.self_sealing=a;this.CalculateStats()}GetExtinguisher(){return this.fire_extinguisher}SetExtinguisher(a){this.fire_extinguisher=
a;this.CalculateStats()}SetCalculateStats(a){this.CalculateStats=a}PartStats(){var a=new Stats,b=0;for(let c=0;c<this.tank_count.length;c++){let d=this.tank_stats[c].stats.Clone();d=d.Multiply(this.tank_count[c]);a=a.Add(d);this.tank_stats[c].internal&&(b+=this.tank_count[c])}a.reqsections=Math.ceil(-1E-6+a.reqsections);this.self_sealing&&(a.mass+=b,a.cost+=2*b,a.era.push({name:"Self-Sealing Gas Tank",era:"Roaring 20s"}),a.warnings.push({source:lu("Self-Sealing Gas Tank"),warning:lu("Self-Sealing Gas Tank Warning"),
color:WARNING_COLOR.WHITE}));this.fire_extinguisher&&(a.mass+=2,a.cost+=3,a.era.push({name:"Remote Fire Extinguisher",era:"WWII"}),a.warnings.push({source:lu("Remote Fire Extinguisher"),warning:lu("Remote Fire Extinguisher Warning"),color:WARNING_COLOR.WHITE}));0<a.wetmass%5&&(a.wetmass+=5-a.wetmass%5);return a}GetElectrics(){return{storage:0,equipment:[]}}}
class Munitions extends Part{constructor(){super();this.internal_bay_count=this.rocket_count=this.bomb_count=0;this.internal_bay_2=this.internal_bay_1=!1}toJSON(){return{bomb_count:this.bomb_count,rocket_count:this.rocket_count,bay_count:this.internal_bay_count,bay1:this.internal_bay_1,bay2:this.internal_bay_2}}fromJSON(a,b){this.bomb_count=a.bomb_count;this.internal_bay_count=a.bay_count;this.internal_bay_1=a.bay1;this.internal_bay_2=a.bay2;10.75<b&&(this.rocket_count=a.rocket_count)}serialize(a){a.PushNum(this.bomb_count);
a.PushNum(this.internal_bay_count);a.PushBool(this.internal_bay_1);a.PushBool(this.internal_bay_2);a.PushNum(this.rocket_count)}deserialize(a){this.bomb_count=a.GetNum();this.internal_bay_count=a.GetNum();this.internal_bay_1=a.GetBool();this.internal_bay_2=a.GetBool();10.75<a.version&&(this.rocket_count=a.GetNum())}GetRocketCount(){return this.rocket_count}GetBombCount(){return this.bomb_count}GetInternalBombCount(){var a=10*this.internal_bay_count;0<this.bomb_count&&0<this.internal_bay_count&&this.internal_bay_1&&
(a*=2,this.internal_bay_2&&(a*=2));return a}GetMaxBombSize(){var a=0,b=this.GetInternalBombCount();0<this.bomb_count&&0<this.internal_bay_count&&(a=this.internal_bay_1?this.internal_bay_2?Math.floor(1E-6+b):Math.floor(1E-6+b/2):Math.floor(1E-6+b/4));return a}SetRocketCount(a){if(a!=a||0>a)a=0;this.rocket_count=Math.floor(1E-6+a);this.LimitMass();this.CalculateStats()}SetBombCount(a){if(a!=a||0>a)a=0;this.bomb_count=Math.floor(1E-6+a);this.LimitMass();this.CalculateStats()}GetBayCount(){return this.internal_bay_count}GetBay1(){return this.internal_bay_1}GetBay2(){return this.internal_bay_2}SetBayCount(a){if(a!=
a||0>a)a=0;this.internal_bay_count=Math.floor(1E-6+a);this.CalculateStats()}SetUseBays(a,b){this.internal_bay_1=a;this.internal_bay_2=b;!this.internal_bay_1&&this.internal_bay_2&&(this.internal_bay_1=!0,this.internal_bay_2=!1);this.CalculateStats()}LimitMass(){var a=!1,b=Math.min(this.GetInternalBombCount(),Math.floor(1E-6+3*this.acft_struct*this.maxbomb)),c=this.bomb_count>b?b:this.bomb_count;b=this.rocket_count+c>b?b-c:this.rocket_count;for(var d=this.bomb_count-c,e=this.rocket_count-b,f=Math.floor(1E-6+
this.acft_struct*this.maxbomb-(c+b)/3)*this.gull_factor;d+e>f;)0<e?e--:d--;this.bomb_count>c+d&&(a=!0,this.bomb_count=c+d);this.rocket_count>b+e&&(a=!0,this.rocket_count=b+e);return a}GetExternalMass(){return Math.max(0,this.bomb_count+this.rocket_count-this.GetInternalBombCount())}SetAcftParameters(a,b,c){this.acft_struct=a;this.maxbomb=b;switch(c){case 2:case 3:this.gull_factor=1.1;break;case 4:this.gull_factor=1.2;break;default:this.gull_factor=1}this.LimitMass()&&this.CalculateStats()}SetCalculateStats(a){this.CalculateStats=
a}PartStats(){var a=new Stats,b=this.GetExternalMass();a.reqsections+=this.internal_bay_count;if(0<this.internal_bay_count){var c=a.reqsections;this.internal_bay_1&&(a.reqsections+=c,this.internal_bay_2&&(a.reqsections+=c))}b=Math.ceil(-1E-6+b/5);a.mass+=b;a.drag+=b;a.bomb_mass=this.bomb_count+this.rocket_count;a.reqsections=Math.ceil(-1E-6+a.reqsections);0<a.bomb_mass%5&&(a.bomb_mass+=5-a.bomb_mass%5);return a}GetElectrics(){return{storage:0,equipment:[]}}}
class CargoAndPassengers extends Part{constructor(a){super();this.cargo_list=[];for(let b of a.spaces)this.cargo_list.push({name:b.name,stats:new Stats(b)});this.cargo_sel=0}toJSON(){return{space_sel:this.cargo_sel}}fromJSON(a,b){this.cargo_sel=a.space_sel}serialize(a){a.PushNum(this.cargo_sel)}deserialize(a){this.cargo_sel=a.GetNum()}GetSpaceList(){return this.cargo_list}GetSpace(){return this.cargo_sel}SetSpace(a){this.cargo_sel=a;this.CalculateStats()}SetCalculateStats(a){this.CalculateStats=a}PartStats(){var a=
new Stats;a=a.Add(this.cargo_list[this.cargo_sel].stats);a.bomb_mass+=3*a.reqsections;0<a.bomb_mass%5&&(a.bomb_mass+=5-a.bomb_mass%5);return a}GetElectrics(){return{storage:0,equipment:[]}}}
class LandingGear extends Part{constructor(a){super();this.gear_list=[];this.gear_sel=0;this.retract=!1;for(let b of a.gear)this.gear_list.push({name:b.name,stats:new Stats(b),DpLMP:b.DpLMP,SpLMP:b.SpLMP,can_retract:b.can_retract});this.extra_list=[];for(let b of a.extras)this.extra_list.push({name:b.name,stats:new Stats(b),MpLMP:b.MpLMP});this.extra_sel=[...Array(this.extra_list.length).fill(!1)]}toJSON(){return{gear_sel:this.gear_sel,retract:this.retract,extra_sel:this.extra_sel}}fromJSON(a,b){this.gear_sel=
a.gear_sel;this.retract=a.retract;this.extra_sel=BoolArr(a.extra_sel,this.extra_sel.length)}serialize(a){a.PushNum(this.gear_sel);a.PushBool(this.retract);a.PushBoolArr(this.extra_sel)}deserialize(a){this.gear_sel=a.GetNum();this.retract=a.GetBool();this.extra_sel=a.GetBoolArr(this.extra_sel.length)}GetGearName(){return this.retract&&"Boat Hull"==this.gear_list[this.gear_sel].name?lu("Retractable Gear + Boat Hull"):this.retract?lu("Retractable ")+lu(this.gear_list[this.gear_sel].name):lu(this.gear_list[this.gear_sel].name)}GetGearList(){return this.gear_list}CanGear(){var a=
[...Array(this.gear_list.length).fill(!0)];for(let b=0;b<this.gear_list.length;b++)"Boat Hull"!=this.gear_list[b].name||this.can_boat||(a[b]=!1);return a}GetGear(){return this.gear_sel}SetGear(a){this.CanGear()[a]&&(this.gear_sel=a);this.CalculateStats()}CanRetract(){return this.gear_list[this.gear_sel].can_retract||"Boat Hull"==this.gear_list[this.gear_sel].name}GetRetract(){return this.retract}SetRetract(a){this.retract=a&&this.CanRetract();this.CalculateStats()}GetExtraList(){return this.extra_list}GetExtraSelected(){return this.extra_sel}SetExtraSelected(a,
b){this.extra_sel[a]=b;this.CalculateStats()}SetLoadedMass(a){this.loadedMass=a}CanBoat(a,b){this.can_boat=2==a?!0:1==a&&3<=b?!0:0==a&&4<=b?!0:!1}SetGull(a){this.gull_deck=a}SetCalculateStats(a){this.CalculateStats=a}IsVital(){return!0}PartStats(){var a=new Stats;this.CanGear()[this.gear_sel]||(this.gear_sel=0);for(var b=this.loadedMass,c=0;c<this.extra_list.length;c++)this.extra_sel[c]&&(a=a.Add(this.extra_list[c].stats),b+=this.extra_list[c].stats.mass,a.mass+=Math.floor(1E-6+this.extra_list[c].MpLMP*
Math.floor(1E-6+b/5)));a=a.Add(this.gear_list[this.gear_sel].stats);c=this.gear_list[this.gear_sel].DpLMP*Math.floor(1E-6+b/5);"Boat Hull"==this.gear_list[this.gear_sel].name&&this.retract&&(a.drag+=c,c=this.gear_list[0].DpLMP*Math.floor(1E-6+b/5));if("Boat Hull"!=this.gear_list[this.gear_sel].name||this.retract)switch(this.gull_deck){case 1:c-=Math.floor(1E-6+.1*c);break;case 2:case 3:c-=Math.floor(1E-6+.15*c);break;case 4:c-=Math.floor(1E-6+.25*c)}this.retract?(a.mass+=Math.floor(1E-6+c/2),a.cost+=
Math.floor(1E-6+c/2)):a.drag+=c;a.structure+=this.gear_list[this.gear_sel].SpLMP*Math.floor(1E-6+b/5);a.Round();return a}GetElectrics(){return{storage:0,equipment:[]}}}
class Accessories extends Part{constructor(a){super();this.armour_coverage=[...Array(8).fill(0)];this.acft_rad=!1;this.skin_armour=0;this.electric_list=[];for(let b of a.electrical)this.electric_list.push({name:b.name,stats:new Stats(b),cp10s:b.cp10s,storage:b.storage});this.electrical_count=[...Array(this.electric_list.length).fill(0)];this.radio_list=[];this.radio_sel=0;for(let b of a.radios)this.radio_list.push({name:b.name,stats:new Stats(b)});this.recon_list=[];for(let b of a.recon)this.recon_list.push({name:b.name,
stats:new Stats(b)});this.recon_sel=Array(this.recon_list.length).fill(0);this.visi_list=[];for(let b of a.visibility)this.visi_list.push({name:b.name,stats:new Stats(b)});this.visi_sel=[...Array(this.visi_list.length).fill(!1)];this.can_visi=[...Array(this.visi_list.length).fill(!0)];this.clim_list=[];for(let b of a.climate)this.clim_list.push({name:b.name,stats:new Stats(b),req_radiator:b.req_radiator});this.clim_sel=[...Array(this.clim_list.length).fill(!1)];this.auto_list=[];this.auto_sel=0;for(let b of a.autopilots)this.auto_list.push({name:b.name,
stats:new Stats(b)});this.cont_list=[];this.cont_sel=0;for(let b of a.control)this.cont_list.push({name:b.name,max_mass_stress:b.max_mass_stress,max_total_stress:b.max_total_stress,stats:new Stats(b)})}toJSON(){return{v:2,armour_coverage:this.armour_coverage,electrical_count:this.electrical_count,radio_sel:this.radio_sel,recon_sel:this.recon_sel,visi_sel:this.visi_sel,clim_sel:this.clim_sel,auto_sel:this.auto_sel,cont_sel:this.cont_sel}}fromJSON(a,b){2==a.v&&(this.armour_coverage=a.armour_coverage);
11.85>b?(this.electrical_count=NumArr(a.electrical_count,this.electrical_count.length+1),this.electrical_count[0]+=this.electrical_count[1],this.electrical_count.splice(1,1)):this.electrical_count=NumArr(a.electrical_count,this.electrical_count.length);this.radio_sel=a.radio_sel;if(12.05>b){let c=BoolArr(a.info_sel,2);this.recon_sel=Array(this.recon_list.length).fill(0);c[0]&&(this.recon_sel[1]=1);c[1]&&(this.recon_sel[0]=1)}else this.recon_sel=NumArr(a.recon_sel,this.recon_sel.length);this.visi_sel=
BoolArr(a.visi_sel,this.visi_sel.length);this.clim_sel=BoolArr(a.clim_sel,this.clim_sel.length);11.95>b&&this.clim_sel.splice(2,1);this.auto_sel=a.auto_sel;this.cont_sel=a.cont_sel}serialize(a){a.PushNumArr(this.armour_coverage);a.PushNumArr(this.electrical_count);a.PushNum(this.radio_sel);a.PushNumArr(this.recon_sel);a.PushBoolArr(this.visi_sel);a.PushBoolArr(this.clim_sel);a.PushNum(this.auto_sel);a.PushNum(this.cont_sel)}deserialize(a){this.armour_coverage=a.GetNumArr(this.armour_coverage.length);
11.85>a.version?(this.electrical_count=a.GetNumArr(this.electrical_count.length+1),this.electrical_count[0]+=this.electrical_count[1],this.electrical_count.splice(1,1)):this.electrical_count=a.GetNumArr(this.electrical_count.length);this.radio_sel=a.GetNum();if(12.05>a.version){let b=a.GetBoolArr(2);this.recon_sel=Array(this.recon_list.length).fill(0);b[0]&&(this.recon_sel[1]=1);b[1]&&(this.recon_sel[0]=1)}else this.recon_sel=a.GetNumArr(this.recon_sel.length);this.visi_sel=a.GetBoolArr(this.visi_sel.length);
this.clim_sel=a.GetBoolArr(this.clim_sel.length);11.95>a.version&&this.clim_sel.splice(2,1);this.auto_sel=a.GetNum();this.cont_sel=a.GetNum()}GetCommunicationName(){return lu(this.radio_list[this.radio_sel].name)}GetArmourCoverage(){return this.armour_coverage}GetEffectiveCoverage(){for(var a=[],b=Math.max(0,Math.floor((this.vital_parts-8)/2)),c=0;c<this.armour_coverage.length;c++)a.push(Math.max(0,this.armour_coverage[c]));c=0;for(let d=this.armour_coverage.length-1;0<=d;d--)c+=a[d],a[d]=c-b;return a}SetArmourCoverage(a,
b){if(b!=b||0>b)b=0;b=Math.floor(1E-6+b);this.armour_coverage[a]=b;this.NormalizeCoverage();this.CalculateStats()}NormalizeCoverage(){var a=-8+Math.min(0,-Math.floor(1E-6+(this.vital_parts-8)/2));for(let b=this.armour_coverage.length-1;0<=b;b--)1==b&&(a+=this.skin_armour),this.armour_coverage[b]=Math.max(0,Math.min(Math.abs(a),this.armour_coverage[b])),a+=this.armour_coverage[b]}GetElectricalList(){return this.electric_list}GetElectricalCount(){return this.electrical_count}SetElectricalCount(a,b){if(b!=
b||0>b)b=0;b=Math.floor(1E-6+b);b=Math.min(b,50);this.electrical_count[a]=b;this.CalculateStats()}GetRadioList(){return this.radio_list}GetRadioSel(){return this.radio_sel}SetRadioSel(a){this.radio_sel=a;this.CalculateStats()}GetReconList(){return this.recon_list}GetReconSel(){return this.recon_sel}SetReconSel(a,b){b=Math.trunc(b);if(b!=b||0>b)b=0;this.recon_sel[a]=b;this.CalculateStats()}GetVisibilityList(){return this.visi_list}GetCanVisibility(){return this.can_visi}GetVisibilitySel(){return this.visi_sel}SetVisibilitySel(a,
b){this.visi_sel[a]=b;this.CalculateStats()}GetClimateList(){return this.clim_list}GetClimateSel(){return this.clim_sel}GetClimateEnable(){var a=[];for(let b of this.clim_list)!this.acft_rad&&b.req_radiator?a.push(!1):a.push(!0);return a}SetClimateSel(a,b){this.clim_sel[a]=b;this.CalculateStats()}GetAutopilotList(){return this.auto_list}GetAutopilotSel(){return this.auto_sel}SetAutopilotSel(a){this.auto_sel=a;this.CalculateStats()}GetControlList(){return this.cont_list}GetControlSel(){return this.cont_sel}SetControlSel(a){this.cont_sel=
a;this.CalculateStats()}SetAcftRadiator(a){this.acft_rad=a}IsElectrics(){for(var a of this.electrical_count)if(0<a)return!0;for(a=0;a<this.clim_list.length;a++)if(this.clim_sel[a]&&0!=this.clim_list[a].stats.charge)return!0;for(a=0;a<this.visi_list.length;a++)if(this.visi_sel[a]&&0!=this.visi_list[a].stats.charge)return!0;return 0!=this.radio_list[this.radio_sel].stats.charge||0!=this.auto_list[this.auto_sel].stats.charge?!0:!1}SetSkinArmor(a){a<this.skin_armour&&(this.armour_coverage[1]+=a-this.skin_armour);
this.skin_armour=a;this.armour_coverage[1]=Math.max(this.armour_coverage[1],this.skin_armour)}SetVitalParts(a){this.vital_parts=a;this.NormalizeCoverage()}GetMaxMassStress(){return this.cont_list[this.cont_sel].max_mass_stress}GetMaxTotalStress(){return this.cont_list[this.cont_sel].max_total_stress}SetCalculateStats(a){this.CalculateStats=a}GetStorage(){return 5*this.electrical_count[2]+5*this.electrical_count[3]}GetWindmill(){var a=0;for(let b=0;b<this.electrical_count.length;b++)a+=this.electric_list[b].cp10s*
this.electrical_count[b];return a}SetCanCutouts(a,b){for(let c=0;c<this.visi_list.length;c++){let d=!0;switch(this.visi_list[c].name){case "Wing Cutouts":d=a;break;case "Hull Cutouts":d=b}(this.can_visi[c]=d)||(this.visi_sel[c]=!1)}}PartStats(){var a=new Stats;this.armour_coverage[1]=Math.max(this.armour_coverage[1],this.skin_armour);var b="",c=this.GetEffectiveCoverage();for(let e=0;e<this.armour_coverage.length;e++){let f=e+1;var d=this.armour_coverage[e];2==f&&(d-=this.skin_armour);a.mass+=d*Math.pow(2,
f-1);a.cost+=Math.floor(1E-6+d*f/3);a.toughness+=this.armour_coverage[e]*f;0<c[e]&&(""!=b&&(b+=", "),b+=f.toString()+"/"+(11-c[e]).toString()+"+")}""!=b&&a.warnings.push({source:lu("Armour"),warning:b,color:WARNING_COLOR.WHITE});for(b=0;b<this.electrical_count.length;b++)0<this.electrical_count[b]&&(c=this.electric_list[b].stats.Clone(),c=c.Multiply(this.electrical_count[b]),a=a.Add(c));a=a.Add(this.radio_list[this.radio_sel].stats);for(b=0;b<this.recon_list.length;b++)0<this.recon_sel[b]&&(c=this.recon_list[b].stats.Clone(),
c=c.Multiply(this.recon_sel[b]),a=a.Add(c));for(b=0;b<this.visi_list.length;b++)this.visi_sel[b]&&(a=a.Add(this.visi_list[b].stats));for(b=0;b<this.clim_list.length;b++)!this.clim_sel[b]||this.clim_list[b].req_radiator&&!this.acft_rad||(a=a.Add(this.clim_list[b].stats));a=a.Add(this.auto_list[this.auto_sel].stats);a=a.Add(this.cont_list[this.cont_sel].stats);a.Round();return a}GetElectrics(){for(var a=0,b=[],c=0;c<this.electric_list.length;c++){var d=this.electric_list[c],e=this.electrical_count[c];
0<e&&(a+=d.storage*e,0<d.cp10s?b.push({source:lu(d.name),charge:StringFmt.Format("{0}"+lu("Derived Per 10 Speed"),Math.floor(1E-6+e*d.cp10s))}):0!=d.stats.charge&&b.push({source:lu(d.name),charge:(e*d.stats.charge).toString()}))}c=this.radio_list[this.radio_sel];b=this.FormatEquipment(b,c.name,c.stats.charge);for(c=0;c<this.clim_list.length;c++)this.clim_sel[c]&&(d=this.clim_list[c],b=this.FormatEquipment(b,d.name,d.stats.charge));for(c=0;c<this.recon_list.length;c++)d=this.recon_list[c],e=this.recon_sel[c],
0<e&&(b=this.FormatEquipment(b,d.name,e*d.stats.charge));for(c=0;c<this.visi_list.length;c++)this.visi_sel[c]&&(d=this.visi_list[c],b=this.FormatEquipment(b,d.name,d.stats.charge));c=this.auto_list[this.auto_sel];b=this.FormatEquipment(b,c.name,c.stats.charge);c=this.cont_list[this.cont_sel];b=this.FormatEquipment(b,c.name,c.stats.charge);return{storage:a,equipment:b}}}
class Optimization extends Part{constructor(){super();this.drag=this.reliability=this.maxstrain=this.toughness=this.mass=this.escape=this.bleed=this.cost=this.free_dots=0;this.acft_stats=new Stats}toJSON(){return{free_dots:this.free_dots,cost:this.cost,bleed:this.bleed,escape:this.escape,mass:this.mass,toughness:this.toughness,maxstrain:this.maxstrain,reliability:this.reliability,drag:this.drag}}fromJSON(a,b){this.free_dots=a.free_dots;this.cost=a.cost;this.bleed=a.bleed;this.escape=a.escape;this.mass=
a.mass;this.toughness=a.toughness;this.maxstrain=a.maxstrain;this.reliability=a.reliability;this.drag=a.drag}serialize(a){a.PushNum(this.free_dots);a.PushNum(this.cost);a.PushNum(this.bleed);a.PushNum(this.escape);a.PushNum(this.mass);a.PushNum(this.toughness);a.PushNum(this.maxstrain);a.PushNum(this.reliability);a.PushNum(this.drag)}deserialize(a){this.free_dots=a.GetNum();this.cost=a.GetNum();this.bleed=a.GetNum();this.escape=a.GetNum();this.mass=a.GetNum();this.toughness=a.GetNum();this.maxstrain=
a.GetNum();this.reliability=a.GetNum();this.drag=a.GetNum()}GetUnassignedCount(){return this.free_dots-this.cost-this.bleed-this.escape-this.mass-this.toughness-this.maxstrain-this.reliability-this.drag}ReduceDots(){var a=-this.GetUnassignedCount();if(0<a){let b=Math.min(a,this.drag);b=Math.max(b,0);this.drag-=b;a-=b;b=Math.min(a,this.reliability);b=Math.max(b,0);this.reliability-=b;a-=b;b=Math.min(a,this.maxstrain);b=Math.max(b,0);this.maxstrain-=b;a-=b;b=Math.min(a,this.toughness);b=Math.max(b,
0);this.toughness-=b;a-=b;b=Math.min(a,this.mass);b=Math.max(b,0);this.mass-=b;a-=b;b=Math.min(a,this.escape);b=Math.max(b,0);this.escape-=b;a-=b;b=Math.min(a,this.bleed);b=Math.max(b,0);this.bleed-=b;a-=b;b=Math.min(a,this.cost);b=Math.max(b,0);this.cost-=b}}GetFreeDots(){return this.free_dots}SetFreeDots(a){if(a!=a||0>a)a=0;a=Math.floor(1E-6+a);this.free_dots=Math.max(a,0);this.ReduceDots();this.CalculateStats()}GetCost(){return this.cost}SetCost(a){a!=a&&(a=0);a=Math.floor(1E-6+a);a=Math.max(a,
-3);this.cost=Math.min(a,3);this.ReduceDots();this.CalculateStats()}GetBleed(){return this.bleed}SetBleed(a){a!=a&&(a=0);a=Math.floor(1E-6+a);a=Math.max(a,-3);this.bleed=Math.min(a,3);this.ReduceDots();this.CalculateStats()}GetEscape(){return this.escape}SetEscape(a){a!=a&&(a=0);a=Math.floor(1E-6+a);a=Math.max(a,-3);this.escape=Math.min(a,3);this.ReduceDots();this.CalculateStats()}GetMass(){return this.mass}SetMass(a){a!=a&&(a=0);a=Math.floor(1E-6+a);a=Math.max(a,-3);this.mass=Math.min(a,3);this.ReduceDots();
this.CalculateStats()}GetToughness(){return this.toughness}SetToughness(a){a!=a&&(a=0);a=Math.floor(1E-6+a);a=Math.max(a,-3);this.toughness=Math.min(a,3);this.ReduceDots();this.CalculateStats()}GetMaxStrain(){return this.maxstrain}SetMaxStrain(a){a!=a&&(a=0);a=Math.floor(1E-6+a);a=Math.max(a,-3);this.maxstrain=Math.min(a,3);this.ReduceDots();this.CalculateStats()}GetReliabiilty(){return this.reliability}SetReliability(a){a!=a&&(a=0);a=Math.floor(1E-6+a);a=Math.max(a,-3);this.reliability=Math.min(a,
3);this.ReduceDots();this.CalculateStats()}GetDrag(){return this.drag}SetDrag(a){a!=a&&(a=0);a=Math.floor(1E-6+a);a=Math.max(a,-3);this.drag=Math.min(a,3);this.ReduceDots();this.CalculateStats()}SetAcftStats(a){this.acft_stats=a}SetCalculateStats(a){this.CalculateStats=a}PartStats(){var a=new Stats;a.cost=Math.floor(1E-6+-(this.cost*this.acft_stats.cost/10));a.liftbleed=Math.floor(1E-6+3*-this.bleed);a.escape=this.escape;a.visibility=this.escape;a.mass=Math.floor(1E-6+-(this.mass*this.acft_stats.mass/
10));a.toughness=Math.floor(1E-6+this.toughness*this.acft_stats.toughness/4);a.reliability=2*this.reliability;a.drag=Math.floor(1E-6+-(this.drag*this.acft_stats.drag/10));return a}GetElectrics(){return{storage:0,equipment:[]}}}var SynchronizationType;(function(a){a[a.NONE=-1]="NONE";a[a.INTERRUPT=0]="INTERRUPT";a[a.SYNCH=1]="SYNCH";a[a.SPINNER=2]="SPINNER";a[a.DEFLECT=3]="DEFLECT";a[a.NO_INTERFERENCE=4]="NO_INTERFERENCE";a[a.ENUM_MAX=5]="ENUM_MAX"})(SynchronizationType||={});var ProjectileType;
(function(a){a[a.BULLETS=0]="BULLETS";a[a.HEATRAY=1]="HEATRAY";a[a.PNEUMATIC=2]="PNEUMATIC";a[a.ENUM_MAX=3]="ENUM_MAX";a[a.GYROJETS=4]="GYROJETS"})(ProjectileType||={});var ActionType;(function(a){a[a.STANDARD=0]="STANDARD";a[a.MECHANICAL=1]="MECHANICAL";a[a.GAST=2]="GAST";a[a.ROTARY=3]="ROTARY";a[a.ENUM_MAX=4]="ENUM_MAX"})(ActionType||={});
class Weapon extends Part{constructor(a,b,c,d=!1){super();this.weapon_type=a;this.fixed=d;this.wing=!0;this.free_accessible=this.accessible=this.covered=!1;this.synchronization=d?SynchronizationType.NONE:SynchronizationType.INTERRUPT;this.w_count=1;this.wing_reinforcement=this.repeating=!1}toJSON(){return{fixed:this.fixed,wing:this.wing,covered:this.covered,accessible:this.accessible,free_accessible:this.free_accessible,synchronization:this.synchronization,w_count:this.w_count}}fromJSON(a,b){this.fixed=
a.fixed;this.wing=a.wing;this.covered=a.covered;this.accessible=a.accessible;this.free_accessible=a.free_accessible;this.synchronization=a.synchronization;this.w_count=a.w_count;10.95>b&&(this.repeating=a.repeating)}serialize(a){a.PushBool(this.fixed);a.PushBool(this.wing);a.PushBool(this.covered);a.PushBool(this.accessible);a.PushBool(this.free_accessible);a.PushNum(this.synchronization);a.PushNum(this.w_count)}deserialize(a){this.fixed=a.GetBool();this.wing=a.GetBool();this.covered=a.GetBool();
this.accessible=a.GetBool();this.free_accessible=a.GetBool();this.synchronization=a.GetNum();this.w_count=a.GetNum();10.95>a.version&&(this.repeating=a.GetBool())}SetWeaponType(a,b,c){this.weapon_type=a;this.action=b;16==this.weapon_type.size&&(this.w_count=1);this.SetCount(this.w_count)}GetFixed(){return this.fixed}SetFixed(a){a!=this.fixed&&(a?this.fixed=!0:(this.fixed=!1,this.synchronization=SynchronizationType.NONE),this.CalculateStats())}SetCanWing(a){this.canwing=a;this.wing&&!a&&(this.wing=
!1)}GetWing(){return this.wing}CanWing(){return 16>=this.weapon_type.size&&this.canwing}SetWing(a){a&&this.CanWing()?(this.wing=!0,this.free_accessible=!1,this.synchronization=SynchronizationType.NONE):this.wing=!1;this.CalculateStats()}CanCovered(){return this.wing?this.has_cantilever&&!(16==this.weapon_type.size&&!this.fixed):!(this.GetArty()&&!this.fixed)}GetCovered(){return this.covered}SetCovered(a){this.covered=a;this.CalculateStats()}GetAccessible(){return this.accessible||this.free_accessible}SetAccessible(a){a&&
this.free_accessible&&(a=!1);this.accessible=a;this.CalculateStats()}GetFreeAccessible(){return this.free_accessible}SetFreeAccessible(a){a&&!this.wing&&this.can_free_accessible?(this.free_accessible=!0,this.accessible=!1):this.free_accessible=!1;this.CalculateStats()}CanSynchronization(){var a=[];for(let b=-1;b<SynchronizationType.ENUM_MAX;b++)a.push(this.CanSynch(b));return a}CanSynch(a){return this.fixed||this.wing?this.can_synchronize&&a==SynchronizationType.NONE||!this.can_synchronize&&a!=SynchronizationType.NONE||
"Fliergerflammenwerfer"==this.weapon_type.name&&a!=SynchronizationType.NONE&&a!=SynchronizationType.SPINNER&&a!=SynchronizationType.NO_INTERFERENCE||this.action==ActionType.MECHANICAL&&!(a==SynchronizationType.NONE||a==SynchronizationType.SYNCH||a==SynchronizationType.SPINNER&&this.CanSpinner())||this.action==ActionType.GAST&&a==SynchronizationType.SPINNER||!(a!=SynchronizationType.INTERRUPT&&a!=SynchronizationType.SYNCH||this.weapon_type.synched)||a==SynchronizationType.SPINNER&&!this.CanSpinner()||
a==SynchronizationType.DEFLECT&&this.GetArty()?!1:!0:this.can_synchronize?a==SynchronizationType.NONE||a==SynchronizationType.DEFLECT||a==SynchronizationType.NO_INTERFERENCE?!0:!1:a==SynchronizationType.NONE?!0:!1}GetSynchronization(){return this.synchronization}SetSynchronization(a){this.CanSynch(a)?this.synchronization=a:this.synchronization=SynchronizationType.NONE;this.synchronization==SynchronizationType.SPINNER&&(this.w_count=1);this.CalculateStats()}GetCount(){return this.w_count}SetCount(a){a!=
a&&(a=1);a=Math.max(1,a);this.synchronization==SynchronizationType.SPINNER&&(a=1);for("Precision Rifle"==this.weapon_type.name&&(a=1);16<a*this.weapon_type.size;)--a;this.w_count=a;this.CalculateStats()}CanRepeating(){return!this.weapon_type.rapid||0<this.weapon_type.reload}GetRepeating(){return this.repeating}SetRepeating(a){a&&this.CanRepeating()?this.repeating=!0:this.repeating=!1;this.CalculateStats()}ResolveSynch(){var a=this.synchronization;this.synchronization=SynchronizationType.ENUM_MAX;
if(this.CanSynch(a))this.synchronization=this.action==ActionType.MECHANICAL&&a!=SynchronizationType.SPINNER?SynchronizationType.SYNCH:a;else{for(a=-1;a<SynchronizationType.ENUM_MAX;a++)if(this.CanSynch(a)){this.synchronization=a;break}this.synchronization==SynchronizationType.ENUM_MAX&&this.SetWing(!0)}this.wing&&(this.synchronization=SynchronizationType.NONE);this.synchronization==SynchronizationType.SPINNER&&(this.w_count=1,this.covered=!0);this.IsLightningArc()&&(this.synchronization=SynchronizationType.NO_INTERFERENCE)}GetArty(){return 16==
this.weapon_type.size}CanSpinner(){return this.GetArty()?this.can_spinner&&this.can_arty_spinner:this.can_spinner}GetJam(){if(this.weapon_type.rapid){var a=this.weapon_type.jam.split("/");a=[parseInt(a[0]),parseInt(a[1])];this.synchronization==SynchronizationType.INTERRUPT&&(a[0]++,a[1]++);this.repeating&&(a[0]++,a[1]++);return a}a=parseInt(this.weapon_type.jam);this.synchronization==SynchronizationType.INTERRUPT&&(a+=1);this.repeating&&(a+=1);return a}IsLightningArc(){return"Lightning Arc"==this.weapon_type.name}SetTurret(a){this.turret=
a}SetCalculateStats(a){this.CalculateStats=a}PartStats(){var a=new Stats;this.ResolveSynch();!this.CanCovered()&&this.covered&&(this.covered=!1);16==this.weapon_type.size&&(this.covered=this.fixed);for(var b=0,c=0;c<this.w_count;c++)a=a.Add(this.weapon_type.stats),b+=this.weapon_type.size;this.covered&&(c=0,1>=this.weapon_type.size?c=0:2>=this.weapon_type.size?c=1:4>=this.weapon_type.size?c=2:8>=this.weapon_type.size?c=5:16>=this.weapon_type.size&&(c=0),c*=this.w_count,this.fixed||(c*=2),this.synchronization!=
SynchronizationType.SPINNER&&(a.cost+=c),a.drag*=0);this.wing&&!this.covered&&(a.drag+=this.w_count);if(this.turret&&8<b||16==this.weapon_type.size)a.reqsections+=1;this.accessible&&(a.cost+=Math.max(1,Math.floor(1E-6+this.w_count/2)));if(!(this.fixed||2>=b))if(4>=b)a.cost+=1;else if(8>=b)a.mass+=1,a.cost+=3;else if(16>=b)a.mass+=2,a.cost+=5;else throw"Weapon size screwup in Turret size cost.";this.synchronization==SynchronizationType.INTERRUPT?(a.cost+=2*this.w_count,"Light Machine Cannon"==this.weapon_type.name&&
(a.cost+=2*this.w_count),a.era.push({name:lu("Interruptor Gear"),era:lu("WWI")})):this.synchronization==SynchronizationType.SYNCH&&this.action!=ActionType.MECHANICAL?(a.cost+=3*this.w_count,"Light Machine Cannon"==this.weapon_type.name&&(a.cost+=3*this.w_count),a.era.push({name:lu("Synchronization Gear"),era:lu("Roaring 20s")})):this.synchronization==SynchronizationType.DEFLECT?(a.cost+=1,a.warnings.push({source:lu(this.weapon_type.name),warning:lu("Deflector Plate Warning"),color:WARNING_COLOR.WHITE})):
this.synchronization!=SynchronizationType.NO_INTERFERENCE||this.IsLightningArc()||a.warnings.push({source:lu(this.weapon_type.name)+" "+lu("No Interference"),warning:lu("No Interference Warning"),color:WARNING_COLOR.WHITE});this.wing_reinforcement&&(a.mass+=2);a.Round();return a}GetElectrics(){return{storage:0,equipment:[]}}}
class WeaponSystem extends Part{constructor(a,b){super();this.weapon_list=a;this.wl_permute=b;this.directions=[...Array(6).fill(!1)];this.fixed=this.directions[0]=!0;this.ammo=1;this.raw_weapon_type=this.weapon_type=0;this.weapons=[];this.action_sel=ActionType.STANDARD;this.projectile_sel=ProjectileType.BULLETS;this.has_propeller=!0;this.sticky_guns=0;this.repeating=!1;this.seat=0;this.final_weapon={name:"",abrv:"",era:"",size:0,stats:new Stats,damage:0,hits:0,ammo:0,ap:0,jam:"",reload:0,rapid:!1,
synched:!1,shells:!1,can_action:!1,can_projectile:!1,deflection:0};this.MakeFinalWeapon();this.SWC(1)}toJSON(){var a=[];for(let b of this.weapons)a.push(b.toJSON());return{weapon_type:this.raw_weapon_type,fixed:this.fixed,directions:this.directions,weapons:a,ammo:this.ammo,action:this.action_sel,projectile:this.projectile_sel,repeating:this.repeating,seat:this.seat}}fromJSON(a,b){this.raw_weapon_type=a.weapon_type;this.weapon_type=this.wl_permute[this.raw_weapon_type];this.fixed=a.fixed;this.directions=
BoolArr(a.directions,this.directions.length);this.weapons=[];this.ammo=a.ammo;null==this.ammo&&(this.ammo=1);10.25>b?(this.action_sel=ActionType.STANDARD,this.projectile_sel=ProjectileType.BULLETS):(this.action_sel=a.action,this.projectile_sel=a.projectile);11.75>b&&(this.projectile_sel==ProjectileType.PNEUMATIC?this.projectile_sel=ProjectileType.BULLETS:this.projectile_sel==ProjectileType.ENUM_MAX&&(this.projectile_sel=ProjectileType.PNEUMATIC));this.MakeFinalWeapon();for(let d of a.weapons){var c=
new Weapon(this.final_weapon,this.action_sel,this.projectile_sel,this.fixed);c.SetCalculateStats(this.CalculateStats);c.fromJSON(d,b);this.weapons.push(c)}if(10.95>b){this.repeating=!1;for(let d of this.weapons)this.repeating=this.repeating||d.GetRepeating()}else this.repeating=a.repeating;this.seat=11.65<b?a.seat:0;this.MakeFinalWeapon();for(let d of this.weapons)d.SetWeaponType(this.final_weapon,this.action_sel,this.projectile_sel)}serialize(a){a.PushNum(this.raw_weapon_type);a.PushBool(this.fixed);
a.PushBoolArr(this.directions);a.PushNum(this.ammo);a.PushNum(this.weapons.length);for(let b of this.weapons)b.serialize(a);a.PushNum(this.action_sel);a.PushNum(this.projectile_sel);a.PushBool(this.repeating);a.PushNum(this.seat)}deserialize(a){this.raw_weapon_type=a.GetNum();this.weapon_type=this.wl_permute[this.raw_weapon_type];this.fixed=a.GetBool();this.directions=a.GetBoolArr(this.directions.length);this.ammo=a.GetNum();var b=a.GetNum();this.weapons=[];this.MakeFinalWeapon();for(let d=0;d<b;d++){var c=
new Weapon(this.final_weapon,this.action_sel,this.projectile_sel,this.fixed);c.SetCalculateStats(this.CalculateStats);c.deserialize(a);this.weapons.push(c)}10.25>a.version?(this.action_sel=ActionType.STANDARD,this.projectile_sel=ProjectileType.BULLETS):(this.action_sel=a.GetNum(),this.projectile_sel=a.GetNum());11.75>a.version&&(this.projectile_sel==ProjectileType.PNEUMATIC?this.projectile_sel=ProjectileType.BULLETS:this.projectile_sel==ProjectileType.ENUM_MAX&&(this.projectile_sel=ProjectileType.PNEUMATIC));
if(10.95>a.version){this.repeating=!1;for(let d of this.weapons)this.repeating=this.repeating||d.GetRepeating()}else this.repeating=a.GetBool();this.seat=11.65<a.version?a.GetNum():0;this.MakeFinalWeapon();for(let d of this.weapons)d.SetWeaponType(this.final_weapon,this.action_sel,this.projectile_sel)}GetWeaponSelected(){return this.weapon_type}MakeFinalWeapon(){var a=this.weapon_type;this.final_weapon.can_action=this.weapon_list[a].can_action;this.final_weapon.can_projectile=this.weapon_list[a].can_projectile;
this.final_weapon.ammo=this.weapon_list[a].ammo;this.final_weapon.ap=this.weapon_list[a].ap;this.final_weapon.damage=this.weapon_list[a].damage;this.final_weapon.era=this.weapon_list[a].era;this.final_weapon.name=this.weapon_list[a].name;this.final_weapon.abrv=this.weapon_list[a].abrv;this.final_weapon.reload=this.weapon_list[a].reload;this.final_weapon.shells=this.weapon_list[a].shells;this.final_weapon.size=this.weapon_list[a].size;this.final_weapon.stats=this.weapon_list[a].stats.Clone();this.final_weapon.deflection=
this.weapon_list[a].deflection;this.final_weapon.jam=this.weapon_list[a].jam;this.final_weapon.stats.era=[];this.final_weapon.stats.era.push({name:this.weapon_list[a].name,era:this.weapon_list[a].era});0==this.weapon_list[a].hits&&(this.action_sel==ActionType.MECHANICAL&&(this.action_sel=ActionType.STANDARD),this.projectile_sel==ProjectileType.GYROJETS||this.projectile_sel==ProjectileType.HEATRAY)&&(this.projectile_sel=ProjectileType.BULLETS);if(this.action_sel==ActionType.STANDARD)this.final_weapon.hits=
this.weapon_list[a].hits,this.final_weapon.rapid=this.weapon_list[a].rapid,this.final_weapon.synched=this.weapon_list[a].synched;else if(this.action_sel==ActionType.MECHANICAL)this.final_weapon.hits=this.weapon_list[a].hits,this.final_weapon.stats.warnings.push({source:lu("Mechanical Action"),warning:lu("Mechanical Action Warning"),color:WARNING_COLOR.WHITE}),this.final_weapon.jam="0/0",this.final_weapon.rapid=!0,this.final_weapon.stats.cost+=this.weapon_list[a].stats.cost,this.final_weapon.synched=
!0,this.final_weapon.stats.era.push({name:lu("Mechanical Action"),era:lu("WWI")});else if(this.action_sel==ActionType.GAST)this.final_weapon.hits=2*this.weapon_list[a].hits,this.final_weapon.ammo=this.weapon_list[a].ammo/2,this.final_weapon.rapid=this.weapon_list[a].rapid,this.final_weapon.stats.cost+=this.weapon_list[a].stats.cost,this.final_weapon.synched=!1,this.final_weapon.stats.era.push({name:lu("Gast Principle"),era:lu("WWI")});else if(this.action_sel==ActionType.ROTARY){this.final_weapon.stats.mass+=
this.weapon_list[a].stats.mass;this.final_weapon.stats.cost+=this.weapon_list[a].stats.cost;this.final_weapon.size+=this.weapon_list[a].size;this.final_weapon.size=Math.min(16,this.final_weapon.size);this.final_weapon.hits=3*this.weapon_list[a].hits;--this.final_weapon.deflection;this.final_weapon.synched=!1;var b=this.final_weapon.jam.split("/");b[0]="9999";b[1]=(parseInt(b[1])+1).toString();this.final_weapon.jam=b.join("/");this.final_weapon.stats.era.push({name:lu("Rotary_Gun"),era:lu("WWI")})}this.repeating&&
0!=this.final_weapon.reload&&(this.final_weapon.reload=0,this.final_weapon.stats.cost+=Math.max(1,Math.floor(1E-6+.5*this.weapon_list[a].stats.cost)));this.action_sel!=ActionType.GAST&&this.action_sel!=ActionType.MECHANICAL||this.projectile_sel!=ProjectileType.HEATRAY||(this.projectile_sel=ProjectileType.BULLETS);this.action_sel!=ActionType.GAST&&this.action_sel!=ActionType.ROTARY||this.projectile_sel!=ProjectileType.PNEUMATIC||(this.projectile_sel=ProjectileType.BULLETS);this.projectile_sel==ProjectileType.HEATRAY?
(this.final_weapon.stats.cost+=this.weapon_list[a].stats.cost,this.final_weapon.shells=!1,this.final_weapon.ammo=0,this.final_weapon.deflection=0,this.final_weapon.ap=Math.max(0,this.final_weapon.ap-1),this.final_weapon.stats.warnings.push({source:lu("Heat Ray"),warning:lu("Heat Ray Warning"),color:WARNING_COLOR.WHITE}),this.final_weapon.stats.era.push({name:lu("Heat Ray"),era:lu("Himmilgard")})):this.projectile_sel==ProjectileType.GYROJETS?(this.final_weapon.stats.cost+=Math.max(1,Math.floor(1E-6+
.5*this.weapon_list[a].stats.cost)),this.final_weapon.shells=!1,--this.final_weapon.damage,this.final_weapon.stats.warnings.push({source:lu("Gyrojets"),warning:lu("Gyrojets Warning"),color:WARNING_COLOR.WHITE}),this.final_weapon.stats.era.push({name:lu("Gyrojets"),era:lu("Roaring 20s")})):this.projectile_sel==ProjectileType.PNEUMATIC&&(this.final_weapon.ammo*=2,this.final_weapon.shells=!1,this.final_weapon.rapid&&(b=this.final_weapon.jam.split("/"),b[1]="9999",this.final_weapon.jam=b.join("/"),this.final_weapon.stats.warnings.push({source:lu("Pneumatic"),
warning:lu("Pneumatic Warning 1"),color:WARNING_COLOR.WHITE}),this.final_weapon.stats.era.push({name:lu("Pneumatic"),era:lu("Pioneer")})),0<this.final_weapon.hits&&this.final_weapon.stats.warnings.push({source:lu("Pneumatic"),warning:lu("Pneumatic Warning 2"),color:WARNING_COLOR.WHITE}));0!=this.final_weapon.deflection&&this.final_weapon.stats.warnings.push({source:lu(this.final_weapon.name),warning:lu("Deflection Warning",this.final_weapon.deflection),color:WARNING_COLOR.WHITE})}SetWeaponSelected(a){var b=
this.IsLightningArc();this.weapon_type=a;this.raw_weapon_type=this.wl_permute.findIndex(d=>d==a);if(16==this.weapon_list[a].size)for(;1<this.weapons.length;)this.weapons.pop();this.weapon_list[a].can_action&&this.GetCanAction()[this.action_sel]||(this.action_sel=ActionType.STANDARD);this.weapon_list[a].can_projectile&&this.GetCanProjectile()[this.projectile_sel]||(this.projectile_sel=ProjectileType.BULLETS);this.weapon_list[a].rapid?this.repeating=!1:this.repeating||this.action_sel!=ActionType.GAST||
(this.action_sel=ActionType.STANDARD);this.CanRepeating()||(this.repeating=!1);this.MakeFinalWeapon();for(var c of this.weapons)c.SetWeaponType(this.final_weapon,this.action_sel,this.projectile_sel);if(this.IsLightningArc())for(this.SetFixed(!0),this.directions[0]=!0,c=1;c<this.directions.length;c++)this.directions[c]=!1;b&&!this.IsLightningArc()&&this.weapons[0].SetSynchronization(SynchronizationType.NONE);this.CalculateStats()}CanRepeating(){return(!this.weapon_list[this.weapon_type].rapid||0<this.weapon_list[this.weapon_type].reload)&&
0<this.weapon_list[this.weapon_type].ammo&&"Precision Rifle"!=this.weapon_list[this.weapon_type].name}GetRepeating(){return this.repeating}SetRepeating(a){a&&this.CanRepeating()?this.repeating=!0:(this.repeating=!1,this.weapon_list[this.weapon_type].rapid||this.action_sel!=ActionType.GAST||(this.action_sel=ActionType.STANDARD));this.MakeFinalWeapon();for(let b of this.weapons)b.SetWeaponType(this.final_weapon,this.action_sel,this.projectile_sel);this.CalculateStats()}GetFixed(){return this.fixed}SetFixed(a){this.IsLightningArc()&&
(a=!0);if(this.fixed!=a){this.fixed=a;for(var b of this.weapons)b.SetFixed(this.fixed);if(a)for(a=!1,b=0;b<this.directions.length;b++)this.directions[b]&&a?this.directions[b]=!1:this.directions[b]&&(a=!0)}this.CalculateStats()}CanDirection(){if(this.IsLightningArc())return[...Array(this.directions.length).fill(!1)];var a=[...Array(this.directions.length).fill(!0)];if(this.weapons[0].GetArty()&&this.fixed&&!this.weapons[0].GetWing()){var b=this.weapons[0].GetSynchronization()==SynchronizationType.SPINNER;
!this.tractor||this.spinner_t||b&&this.directions[0]||(a[0]=!1);!this.pusher||this.spinner_p||b&&this.directions[1]||(a[1]=!1);this.heli&&(a[2]=!1)}return a}GetDirection(){return this.directions}SetDirection(a,b){this.fixed&&this.directions[a]&&!b&&(b=!0);this.fixed&&(this.directions=[...Array(6).fill(!1)],this.weapons[0].GetArty()&&!this.weapons[0].GetWing()&&(0==a&&this.tractor&&!this.spinner_t&&(a=1),1==a&&this.pusher&&!this.spinner_p&&(a=3),2==a&&this.heli&&(a=3)));this.directions[a]=b;this.CalculateStats()}GetMountingCount(){return this.weapons.length}GetWeaponCount(){var a=
0;for(let b of this.weapons)a+=b.GetCount();return a}SWC(a){if(a!=a||1>a)a=1;for(a=Math.floor(1E-6+a);a>this.weapons.length;){var b=new Weapon(this.final_weapon,this.action_sel,this.projectile_sel,this.fixed);b.SetCalculateStats(this.CalculateStats);this.weapons.push(b)}for(;a<this.weapons.length;)this.weapons.pop()}SetMountingCount(a){if(16==this.final_weapon.size||"Precision Rifle"==this.final_weapon.name)a=1;this.SWC(a);this.CalculateStats()}GetWeapons(){return this.weapons}SetCanFreelyAccessible(a){for(let b of this.weapons)b.GetWing()?
b.can_free_accessible=!1:b.can_free_accessible=a}SetTractorPusher(a,b,c,d,e,f,g){this.tractor=a;this.pusher=d;this.heli=g;this.spinner_t=c;this.spinner_p=f;if(this.directions[0]&&a)for(let h of this.weapons)h.GetFixed()&&!h.GetWing()?(h.can_synchronize=!0,h.can_spinner=b||h.GetSynchronization()==SynchronizationType.SPINNER,h.can_arty_spinner=c||h.GetSynchronization()==SynchronizationType.SPINNER):(h.GetFixed()||h.GetWing()?h.can_synchronize=!1:h.can_synchronize=!0,h.can_spinner=!1,h.can_arty_spinner=
!1);else if(this.directions[1]&&d)for(let h of this.weapons)h.GetFixed()&&!h.GetWing()?(h.can_synchronize=!0,h.can_spinner=e||h.GetSynchronization()==SynchronizationType.SPINNER,h.can_arty_spinner=f||h.GetSynchronization()==SynchronizationType.SPINNER):(h.GetFixed()||h.GetWing()?h.can_synchronize=!1:h.can_synchronize=!0,h.can_spinner=!1,h.can_arty_spinner=!1);else if(this.directions[2]&&this.heli)for(let h of this.weapons)h.can_synchronize=!0,h.can_spinner=!1,h.can_arty_spinner=!1;else for(let h of this.weapons)h.can_synchronize=
!1,h.can_spinner=!1,h.can_arty_spinner=!1}GetHits(){var a=this.final_weapon.hits;if(0!=a){var b=0,c=0;for(let d of this.weapons)d.GetWing()&&(d.GetFixed()||2>=this.GetDirectionCount())?c+=d.GetCount()*a:b+=d.GetCount()*a;return[b+c,Math.floor(1E-6+.75*b)+Math.floor(1E-6+.9*c),Math.floor(1E-6+.5*b)+Math.floor(1E-6+.2*c),Math.floor(1E-6+.25*b)+Math.floor(1E-6+.1*c)]}if(this.IsLightningArc())return[0,0,0,0];if(0==this.final_weapon.ammo){a=0;for(b of this.weapons)a+=b.GetCount();return[3*a,0,0,0]}a=0;
for(c of this.weapons)a+=c.GetCount();this.action_sel==ActionType.GAST&&(a*=2);return[3*a,2*a,1*a,0]}GetDamage(){return this.final_weapon.damage}GetAmmo(){return this.ammo}GetJam(){if(this.final_weapon.rapid){var a=[0,0];for(c of this.weapons){var b=c.GetJam();a[0]=Math.max(a[0],b[0]+this.sticky_guns);a[1]=Math.max(a[1],b[1]+this.sticky_guns)}return a[0].toString()+"/"+a[1].toString()}var c=0;for(a of this.weapons)c=Math.max(c,a.GetJam()+this.sticky_guns);return c.toString()}IsPlural(){return 1<this.weapons.length||
1<this.weapons[0].GetCount()}SetAmmo(a){if(a!=a||1>a)a=1;this.ammo=Math.floor(1E-6+a);this.CalculateStats()}SetHavePropeller(a){this.has_propeller&&!a&&this.action_sel==ActionType.MECHANICAL&&(this.has_propeller=a,this.SetAction(ActionType.STANDARD));this.has_propeller=a}SetCanWing(a){for(let b of this.weapons)b.SetCanWing(a)}GetAction(){return this.action_sel}GetCanAction(){return[!0,this.has_propeller&&this.weapon_list[this.weapon_type].can_action&&0<this.weapon_list[this.weapon_type].hits&&(this.repeating||
this.weapon_list[this.weapon_type].rapid),this.weapon_list[this.weapon_type].can_action&&(this.repeating||this.weapon_list[this.weapon_type].rapid),this.weapon_list[this.weapon_type].can_action&&this.weapon_list[this.weapon_type].rapid]}SetAction(a){if(this.final_weapon.can_action){this.action_sel=a;this.MakeFinalWeapon();for(let b of this.weapons)b.SetWeaponType(this.final_weapon,this.action_sel,this.projectile_sel)}else this.action_sel=ActionType.STANDARD;this.CalculateStats()}GetCanProjectile(){return[!0,
this.final_weapon.can_projectile&&this.action_sel!=ActionType.MECHANICAL&&this.action_sel!=ActionType.GAST&&0<this.weapon_list[this.weapon_type].hits,this.final_weapon.can_projectile&&this.action_sel!=ActionType.ROTARY&&this.action_sel!=ActionType.GAST]}GetProjectile(){return this.projectile_sel}SetProjectile(a){if(this.final_weapon.can_projectile){this.projectile_sel=a;this.MakeFinalWeapon();for(let b of this.weapons)b.SetWeaponType(this.final_weapon,this.action_sel,this.projectile_sel)}else this.projectile_sel=
ProjectileType.BULLETS;this.CalculateStats()}GetFinalWeapon(){return this.final_weapon}SetStickyGuns(a){this.sticky_guns=a}GetHRCharges(){if(this.IsLightningArc())return[3];var a=0,b;for(b of this.weapons)a+=b.GetCount();if(0<this.final_weapon.hits)return b=this.weapon_list[this.weapon_type].stats.cost,this.action_sel==ActionType.ROTARY&&(b*=2),this.final_weapon.rapid?[a*b,Math.max(a*b+1,Math.floor(1E-6+1.5*a*b))]:[a*b];if("Scattergun"==this.final_weapon.name)return this.final_weapon.rapid?[1,3]:
[1];if("Punt Gun"==this.final_weapon.name)return this.final_weapon.rapid?[3,6]:[3]}GetShots(){return Math.floor(1E-6+this.final_weapon.ammo*this.ammo)}IsLightningArc(){return"Lightning Arc"==this.final_weapon.name}GetReload(){return this.final_weapon.reload}GetWingWeight(){var a=0;for(let b of this.weapons)b.GetWing()&&(a+=b.PartStats().mass);return a}GetDirectionCount(){var a=0;for(let b of this.directions)b&&a++;return a}SetSeat(a){this.seat=a;this.CalculateStats()}GetSeat(){return this.seat}GetIsFullyAccessible(){for(let a of this.weapons)if(!a.GetAccessible())return!1;
return!0}GetIsPartlyAccessible(){for(let a of this.weapons)if(a.GetAccessible())return!0;return!1}SetCalculateStats(a){this.CalculateStats=a;for(let b of this.weapons)b.SetCalculateStats(a)}PartStats(){var a=new Stats,b=0;for(c of this.directions)c&&b++;var c=0;for(let d of this.weapons)d.has_cantilever=this.has_cantilever,d.SetTurret(2<this.GetDirectionCount()),a=a.Add(d.PartStats()),c+=d.GetCount(),this.fixed||(2==b?a.cost+=1:3==b||4==b?a.cost+=2:5==b?a.cost+=3:6==b&&(a.cost+=4));if(this.projectile_sel==
ProjectileType.HEATRAY||this.IsLightningArc())this.ammo=1;a.mass+=(this.ammo-1)*c;return a}GetElectrics(){return{storage:0,equipment:[]}}}
class Weapons extends Part{constructor(a){super();this.direction_list="Forward Rearward Up Down Left Right".split(" ");this.synchronization_list="None;Interruptor Gear;Synchronization Gear;Spinner Gun;Deflector Plate;No Interference".split(";");this.action_list=[{name:"Standard Action"},{name:"Mechanical Action"},{name:"Gast Principle"},{name:"Rotary_Gun"}];this.projectile_list=[{name:"Standard"},{name:"Heat Ray"},{name:"Pneumatic"}];this.weapon_list=[];for(var b of a.weapons)a={name:b.name,abrv:b.abrv,
era:b.era,size:b.size,stats:new Stats(b),damage:b.damage,hits:b.hits,ammo:b.ammo,ap:b.ap,jam:b.jam,reload:b.reload,rapid:b.rapid,synched:b.synched,shells:b.shells,can_action:b.can_action,can_projectile:b.can_projectile,deflection:b.deflection},this.weapon_list.push(a);var c=(d,e)=>{var f=(g,h)=>g<h?-1:h<g?1:0;return d.size!=e.size?f(d.size,e.size):d.era!=e.era?f(era2numHh(d.era),era2numHh(e.era)):d.damage!=e.damage?f(d.damage,e.damage):f(d.name,e.name)};this.wl_permute=Array.from(Array(this.weapon_list.length).keys()).sort((d,
e)=>c(this.weapon_list[d],this.weapon_list[e]));b=[];for(let d=0;d<this.wl_permute.length;d++)b.push(this.wl_permute.findIndex(e=>e==d));this.wl_permute=b;this.weapon_list=this.weapon_list.sort(c);this.weapon_sets=[];this.brace_count=0;this.isheli=!1}toJSON(){var a=[];for(let b of this.weapon_sets)a.push(b.toJSON());return{weapon_systems:a,brace_count:this.brace_count}}fromJSON(a,b){this.weapon_sets=[];var c=a.weapon_systems;for(let d of c)c=new WeaponSystem(this.weapon_list,this.wl_permute),c.SetCalculateStats(this.CalculateStats),
c.fromJSON(d,b),this.weapon_sets.push(c);10.35<b&&(this.brace_count=a.brace_count)}serialize(a){a.PushNum(this.weapon_sets.length);for(let b of this.weapon_sets)b.serialize(a);a.PushNum(this.brace_count)}deserialize(a){this.weapon_sets=[];var b=a.GetNum();for(let d=0;d<b;d++){var c=new WeaponSystem(this.weapon_list,this.wl_permute);c.SetCalculateStats(this.CalculateStats);c.deserialize(a);this.weapon_sets.push(c)}10.35<a.version&&(this.brace_count=a.GetNum())}GetWeaponList(){return this.weapon_list}GetDirectionList(){return this.direction_list}GetSynchronizationList(){return this.synchronization_list}SetWeaponSetCount(a){if(a!=
a||1>a)a=0;for(a=Math.floor(1E-6+a);a>this.weapon_sets.length;){var b=new WeaponSystem(this.weapon_list,this.wl_permute);b.SetCalculateStats(this.CalculateStats);this.weapon_sets.push(b)}for(;a<this.weapon_sets.length;)this.weapon_sets.pop();this.CalculateStats()}GetWeaponSets(){return this.weapon_sets}CountTractorSpinner(){var a=0;for(let c of this.weapon_sets)if(c.GetDirection()[0]){var b=c.GetWeapons();for(let d of b)d.GetSynchronization()==SynchronizationType.SPINNER&&a++}return a}CountArtyTractorSpinner(){var a=
0;for(let c of this.weapon_sets)if(c.GetDirection()[0]){var b=c.GetWeapons();for(let d of b)d.GetArty()&&d.GetSynchronization()==SynchronizationType.SPINNER&&a++}return a}CountPusherSpinner(){var a=0;for(let c of this.weapon_sets)if(c.GetDirection()[1]){var b=c.GetWeapons();for(let d of b)d.GetSynchronization()==SynchronizationType.SPINNER&&a++}return a}CountArtyPusherSpinner(){var a=0;for(let c of this.weapon_sets)if(c.GetDirection()[1]){var b=c.GetWeapons();for(let d of b)d.GetArty()&&d.GetSynchronization()==
SynchronizationType.SPINNER&&a++}return a}CleanFreelyAccessible(){var a=Array(this.cockpit_count).fill(!1);for(b of this.weapon_sets){let c=b.GetSeat();for(let d of b.GetWeapons())d.GetFreeAccessible()&&a[c]?d.SetFreeAccessible(!1):d.GetFreeAccessible()&&(a[c]=!0)}for(let c of this.weapon_sets){var b=c.GetSeat();for(let d of c.GetWeapons())a[b]&&!d.GetFreeAccessible()||d.GetWing()?d.can_free_accessible=!1:d.can_free_accessible=!0}}RemoveOneTractorSpinner(){for(let b=this.weapon_sets.length-1;0<=b;b--)if(this.weapon_sets[b].GetDirection()[0]){var a=
this.weapon_sets[b].GetWeapons();for(let c=a.length-1;0<=c;c--)if(a[c].GetSynchronization()==SynchronizationType.SPINNER){a[c].SetSynchronization(SynchronizationType.INTERRUPT);return}}}RemoveOneArtyTractorSpinner(){for(let b=this.weapon_sets.length-1;0<=b;b--)if(this.weapon_sets[b].GetDirection()[0]){var a=this.weapon_sets[b].GetWeapons();for(let c=a.length-1;0<=c;c--)if(a[c].GetSynchronization()==SynchronizationType.SPINNER&&a[c].GetArty()){this.weapon_sets[b].SetDirection(3,!0);return}}}RemoveOnePusherSpinner(){for(let b=
this.weapon_sets.length-1;0<=b;b--)if(this.weapon_sets[b].GetDirection()[1]){var a=this.weapon_sets[b].GetWeapons();for(let c=a.length-1;0<=c;c--)if(a[c].GetSynchronization()==SynchronizationType.SPINNER){a[c].SetSynchronization(SynchronizationType.INTERRUPT);return}}}RemoveOneArtyPusherSpinner(){for(let b=this.weapon_sets.length-1;0<=b;b--)if(this.weapon_sets[b].GetDirection()[1]){var a=this.weapon_sets[b].GetWeapons();for(let c=a.length-1;0<=c;c--)if(a[c].GetSynchronization()==SynchronizationType.SPINNER&&
a[c].GetArty()){this.weapon_sets[b].SetDirection(3,!0);return}}}CanTractorSpinner(){return this.CountTractorSpinner()+this.CountArtyTractorSpinner()<this.tractor_spinner_count}CanArtyTractorSpinner(){return this.CountArtyTractorSpinner()<this.tractor_arty_spinner_count}CanPusherSpinner(){return this.CountPusherSpinner()+this.CountArtyTractorSpinner()<this.pusher_spinner_count}CanArtyPusherSpinner(){return this.CountArtyPusherSpinner()<this.pusher_arty_spinner_count}SetTractorInfo(a){this.has_tractor=
a.have;this.tractor_spinner_count=a.spin_count;this.tractor_arty_spinner_count=a.arty_spin_count}SetPusherInfo(a){this.has_pusher=a.have;this.pusher_spinner_count=a.spin_count;this.pusher_arty_spinner_count=a.arty_spin_count}GetActionList(){return this.action_list}GetProjectileList(){return this.projectile_list}GetBraceCount(){return this.brace_count}SetBraceCount(a){if(0>a||a!=a)a=0;this.brace_count=a-a%3;this.CalculateStats()}SetHavePropeller(a){for(let b of this.weapon_sets)b.SetHavePropeller(a)}SetCanWing(a){for(let b of this.weapon_sets)b.SetCanWing(a)}SetStickyGuns(a){for(let b of this.weapon_sets)b.SetStickyGuns(a)}GetWingWeight(){var a=
0;for(let b of this.weapon_sets)a+=b.GetWingWeight();return a}GetSeatList(){var a=[];for(let b=0;b<this.cockpit_count;b++)a.push(lu("Seat #",b+1));return a}GetArmedSeats(){var a=Array(this.cockpit_count).fill(!1);for(let b of this.weapon_sets)a[b.GetSeat()]=!0;return a}SetCalculateStats(a){this.CalculateStats=a;for(let b of this.weapon_sets)b.SetCalculateStats(a)}SetNumberOfCockpits(a){this.cockpit_count=a}SetHeli(a){this.isheli=a}PartStats(){var a=new Stats;for(this.CleanFreelyAccessible();this.CountArtyTractorSpinner()>
this.tractor_arty_spinner_count;)this.RemoveOneArtyTractorSpinner();for(;this.CountTractorSpinner()>this.tractor_spinner_count;)this.RemoveOneTractorSpinner();for(;this.CountArtyPusherSpinner()>this.pusher_arty_spinner_count;)this.RemoveOneArtyPusherSpinner();for(;this.CountPusherSpinner()>this.pusher_spinner_count;)this.RemoveOnePusherSpinner();var b=0;b=0==this.cant_type?4:1==this.cant_type?8:16;var c=[];for(let e of this.weapon_sets)for(let f of e.GetWeapons()){f.wing_reinforcement=!1;var d={s:0,
w:f};f.GetWing()&&(d.s=f.GetCount()*this.weapon_list[e.GetWeaponSelected()].size,c.push(d))}c.sort(function(e,f){return e.s-f.s});for(let e of c)0<=b&&(b-=e.s),0>b&&(e.w.wing_reinforcement=!0);for(let e of this.weapon_sets)e.SetTractorPusher(this.has_tractor,this.CanTractorSpinner(),this.CanArtyTractorSpinner(),this.has_pusher,this.CanPusherSpinner(),this.CanArtyPusherSpinner(),this.isheli),e.has_cantilever=0<this.cant_type,a=a.Add(e.PartStats());a.cost+=this.brace_count/3;0<this.brace_count&&a.warnings.push({source:lu("Weapons Braces"),
warning:lu("Weapons Braces Warning"),color:WARNING_COLOR.WHITE});a.control-=Math.floor(1E-6+this.GetWingWeight()/5);return a}GetElectrics(){let a={storage:0,equipment:[]};for(let b=0;b<this.weapon_sets.length;b++){let c=this.weapon_sets[b];if(c.GetProjectile()==ProjectileType.HEATRAY||c.IsLightningArc()){let d=c.GetHRCharges();for(let e=0;e<d.length;e++)d[e]*=-1;a.equipment.push({source:lu("Vital Part Weapon Set",b,c.GetFinalWeapon().abrv),charge:StringFmt.Join("/",d)})}}return a}}
class Used extends Part{constructor(){super();this.sluggish=this.leaky=this.fragile=this.weak=this.sticky_guns=this.hefty=this.ragged=this.burnt_out=0}GetEnabled(){return 0!=Math.abs(this.burnt_out)+Math.abs(this.ragged)+Math.abs(this.hefty)+Math.abs(this.sticky_guns)+Math.abs(this.weak)+Math.abs(this.fragile)+Math.abs(this.leaky)+Math.abs(this.sluggish)}SetEnabled(a){this.sluggish=this.leaky=this.fragile=this.weak=this.sticky_guns=this.hefty=this.ragged=this.burnt_out=0;this.CalculateStats()}toJSON(){return{enabled:!0,
burnt_out:this.burnt_out,ragged:this.ragged,hefty:this.hefty,sticky_guns:this.sticky_guns,weak:this.weak,fragile:this.fragile,leaky:this.leaky,sluggish:this.sluggish}}fromJSON(a,b){this.burnt_out=a.burnt_out;this.ragged=a.ragged;this.hefty=a.hefty;this.sticky_guns=a.sticky_guns;this.weak=a.weak;this.fragile=a.fragile;this.leaky=a.leaky;this.sluggish=a.sluggish}serialize(a){a.PushBool(!0);a.PushNum(this.burnt_out);a.PushNum(this.ragged);a.PushNum(this.hefty);a.PushNum(this.sticky_guns);a.PushNum(this.weak);
a.PushNum(this.fragile);a.PushNum(this.leaky);a.PushNum(this.sluggish)}deserialize(a){a.GetBool();this.burnt_out=a.GetNum();this.ragged=a.GetNum();this.hefty=a.GetNum();this.sticky_guns=a.GetNum();this.weak=a.GetNum();this.fragile=a.GetNum();this.leaky=a.GetNum();this.sluggish=a.GetNum()}Normalize(a){a!=a&&(a=0);a=Math.floor(1E-6+a);a=Math.min(1,a);return Math.max(-1,a)}PartStats(){this.burnt_out=this.Normalize(this.burnt_out);this.ragged=this.Normalize(this.ragged);this.hefty=this.Normalize(this.hefty);
this.sticky_guns=this.Normalize(this.sticky_guns);this.weak=this.Normalize(this.weak);this.fragile=this.Normalize(this.fragile);this.leaky=this.Normalize(this.leaky);this.sluggish=this.Normalize(this.sluggish);return new Stats}SetCalculateStats(a){this.CalculateStats=a}TriggerCS(){this.burnt_out=this.Normalize(this.burnt_out);this.ragged=this.Normalize(this.ragged);this.hefty=this.Normalize(this.hefty);this.sticky_guns=this.Normalize(this.sticky_guns);this.weak=this.Normalize(this.weak);this.fragile=
this.Normalize(this.fragile);this.leaky=this.Normalize(this.leaky);this.sluggish=this.Normalize(this.sluggish);this.CalculateStats()}GetElectrics(){return{storage:0,equipment:[]}}}var ROTOR_BLADE_COUNT;(function(a){a[a.Two=2]="Two";a[a.Three=3]="Three";a[a.Four=4]="Four";a[a.Five=5]="Five"})(ROTOR_BLADE_COUNT||={});
class Rotor extends Part{constructor(a){super();this.type=AIRCRAFT_TYPE.AIRPLANE;this.cant_idx=this.sizing_span=this.dryMP=this.stagger_sel=this.wing_area=this.rotor_span=this.rotor_count=0;this.accessory=!1;this.blade_idx=0;this.blade_list=[];for(let b of a.blade_count)this.blade_list.push({name:b.name,rotor_bleed:b.rotor_bleed,sizing:b.sizing,stats:new Stats(b)});this.stagger_list=[];for(let b of a.arrangement)this.stagger_list.push({name:b.name,count:b.count,powerfactor:b.powerfactor,blades:b.blades,
stats:new Stats(b)})}toJSON(){return{type:this.type,rotor_count:this.rotor_count,rotor_span:this.rotor_span,rotor_mat:this.cant_idx,stagger_sel:this.stagger_sel,accessory:this.accessory,blade_idx:this.blade_idx}}fromJSON(a,b){this.type=a.type;this.rotor_count=a.rotor_count;this.rotor_span=a.rotor_span;this.cant_idx=a.rotor_mat;this.stagger_sel=12.35>b?0:a.stagger_sel;this.accessory=a.accessory;11.55<b&&(this.blade_idx=a.blade_idx);12.45>b&&(this.rotor_span=0)}serialize(a){a.PushNum(this.type);a.PushNum(this.rotor_count);
a.PushNum(this.rotor_span);a.PushNum(this.cant_idx);a.PushNum(this.stagger_sel);a.PushBool(this.accessory);a.PushNum(this.blade_idx)}deserialise(a){this.type=a.GetNum();this.rotor_count=a.GetNum();this.rotor_span=a.GetNum();this.cant_idx=a.GetNum();12.35>a.version?(a.GetBool(),this.stagger_sel=0):this.stagger_sel=a.GetNum();this.accessory=a.GetBool();11.55<a.version&&(this.blade_idx=a.GetNum());12.45>a.version&&(this.rotor_span=0)}SetCantileverList(a){this.cant_list=a}GetCantileverList(){return this.cant_list}SetCantilever(a){this.cant_idx=
a;this.CalculateStats()}GetCantilever(){return this.cant_idx}SetType(a){this.type!=a&&(this.accessory=!1,this.stagger_sel=this.cant_idx=0,this.rotor_count=1,this.type=a,this.rotor_span=0)}CanRotorCount(){return this.type==AIRCRAFT_TYPE.HELICOPTER}SetRotorCount(a){1>a&&(a=1);2<=a&&1==a%2&&(a=a==this.rotor_count+1?a+1:a-1);this.rotor_count=a;2>this.rotor_count&&(this.stagger_sel=0);this.CalculateStats()}GetRotorCount(){return this.rotor_count}CanRotorSpan(){return this.type==AIRCRAFT_TYPE.HELICOPTER}SetRotorSpan(a){this.rotor_span=
Math.floor(1E-6+a);this.CalculateStats()}GetRotorSpan(){return this.rotor_span}CanTandem(){return this.type==AIRCRAFT_TYPE.HELICOPTER&&1<this.rotor_count}SetBladeCount(a){this.blade_idx=a;this.CalculateStats()}SetWingArea(a){this.wing_area=a}GetSizingSpan(){return this.sizing_span}SetMP(a){a!=this.dryMP&&(this.dryMP=a,this.CalculateStats())}GetRotorStrain(){var a=this.GetRotorArea();return this.rotor_count*Math.max(1,2*(this.sizing_span+this.rotor_span)+a-10)}GetRotorArea(){return Math.PI/9*(this.sizing_span+
this.rotor_span)*(this.sizing_span+this.rotor_span)}GetIdealRotorArea(){return Math.PI/9*this.sizing_span*this.sizing_span}GetRotorDrag(){if(this.type==AIRCRAFT_TYPE.HELICOPTER||this.type==AIRCRAFT_TYPE.AUTOGYRO){var a=this.GetRotorArea();return 1==this.rotor_count?Math.floor(1E-6+6*a*a/((this.sizing_span+this.rotor_span)*(this.sizing_span+this.rotor_span))):Math.floor(1E-6+.75*this.rotor_count*Math.floor(1E-6+6*a*a/((this.sizing_span+this.rotor_span)*(this.sizing_span+this.rotor_span))))}return 0}GetType(){return this.type}GetAccessory(){return this.accessory}SetAccessory(a){this.accessory=
a;this.CalculateStats()}SetEngineCount(a){this.engine_count=a}GetTailRotor(){return this.type==AIRCRAFT_TYPE.HELICOPTER&&2>this.rotor_count}GetBladeList(){return this.blade_list}GetRotorBleed(){return this.type==AIRCRAFT_TYPE.HELICOPTER?this.blade_list[this.blade_idx].rotor_bleed:0}GetPowerFactor(){return this.stagger_list[this.stagger_sel].powerfactor}GetBladeCountIdx(){return this.blade_idx}GetStaggerList(){return this.stagger_list}GetStagger(){return this.stagger_sel}SetStagger(a){a!=this.stagger_sel&&
(this.stagger_sel=a,this.CalculateStats())}CanStagger(){var a=[];for(let b=0;b<this.stagger_list.length;b++)1==this.rotor_count&&1==this.stagger_list[b].count?a.push(!0):2==this.rotor_count&&2==this.stagger_list[b].count?a.push(!0):2<=this.rotor_count&&3==this.stagger_list[b].count?a.push(!0):a.push(!1);return a}VerifySizes(){this.type==AIRCRAFT_TYPE.AIRPLANE?this.stagger_sel=this.rotor_span=this.rotor_count=0:this.type==AIRCRAFT_TYPE.AUTOGYRO?(this.rotor_count=1,this.sizing_span=Math.ceil(-1E-6+
Math.sqrt(.6*this.wing_area/(Math.PI/8))),this.rotor_span=Math.max(this.rotor_span,2-this.sizing_span),this.stagger_sel=0):this.type==AIRCRAFT_TYPE.HELICOPTER&&(this.rotor_count=Math.max(1,this.rotor_count),1<this.rotor_count&&1==this.rotor_count%2&&--this.rotor_count,this.sizing_span=1==this.rotor_count?Math.ceil(-1E-6+5*Math.pow(this.dryMP,.4)*this.blade_list[this.blade_idx].sizing):Math.ceil(-1E-6+4*Math.pow(this.dryMP,.4)*this.blade_list[this.blade_idx].sizing),this.sizing_span=Math.min(100,this.sizing_span),
this.rotor_span=Math.max(this.rotor_span,-Math.floor(1E-6+this.sizing_span/2)))}VerifyStagger(){if(2<this.rotor_count&&2>=this.stagger_list[this.stagger_sel].count)for(var a=0;a<this.stagger_list.length;a++){if(3==this.stagger_list[a].count){this.stagger_sel=a;break}}else if(2==this.rotor_count&&2!=this.stagger_list[this.stagger_sel].count)for(a=0;a<this.stagger_list.length;a++){if(2==this.stagger_list[a].count){this.stagger_sel=a;break}}else if(1==this.rotor_count&&1!=this.stagger_list[this.stagger_sel].count)for(a=
0;a<this.stagger_list.length;a++)if(1==this.stagger_list[a].count){this.stagger_sel=a;break}}PartStats(){this.VerifySizes();this.VerifyStagger();var a=new Stats,b=this.GetRotorArea();a.wingarea+=Math.floor(1E-6+b);a.drag=this.GetRotorDrag();b=this.GetRotorStrain();var c=this.cant_list[this.cant_idx].stats.Clone();c=c.Multiply(Math.ceil(-1E-6+b/c.maxstrain));c.maxstrain=0;c.toughness=0;a=a.Add(c);a=a.Add(this.stagger_list[this.stagger_sel].stats.Clone());this.type==AIRCRAFT_TYPE.HELICOPTER&&(a.reliability=
2*Math.min(0,this.rotor_span),a=a.Add(this.blade_list[this.blade_idx].stats));this.accessory?this.type==AIRCRAFT_TYPE.AUTOGYRO?(a.cost+=2,a.mass+=2):this.type==AIRCRAFT_TYPE.HELICOPTER&&(a.mass+=this.rotor_count*this.engine_count):this.type==AIRCRAFT_TYPE.HELICOPTER&&(a.mass+=Math.max(this.rotor_count,this.engine_count));this.type==AIRCRAFT_TYPE.HELICOPTER?(a.warnings.push({source:lu("Helicopter Landing"),warning:lu("Helicopter Landing Warning"),color:WARNING_COLOR.WHITE}),a.warnings.push({source:lu("Helicopter Descent"),
warning:lu("Helicopter Descent Warning"),color:WARNING_COLOR.WHITE}),a.warnings.push({source:lu("Helicopter Stall"),warning:lu("Helicopter Stall Warning"),color:WARNING_COLOR.WHITE}),0>a.reliability&&a.warnings.push({source:lu("Rotor Span"),warning:lu("Rotor Span Warning"),color:WARNING_COLOR.YELLOW})):this.type==AIRCRAFT_TYPE.AUTOGYRO&&a.warnings.push({source:lu("Autogyro Stall"),warning:lu("Autogyro Stall Warning"),color:WARNING_COLOR.WHITE});return a}SetCalculateStats(a){this.CalculateStats=a}GetElectrics(){return{storage:0,
equipment:[]}}}
class Aircraft{constructor(a,b,c){this.use_storage=!1;this.reset_json=String.raw`{"version":"11.3","name":"Basic Biplane","aircraft_type":0,"era":{"selected":1},"cockpits":{"positions":[{"type":0,"upgrades":[false,false,false,false,false,false],"safety":[false,false,false,false,false],"sights":[false,false,false,false],"bombsight":0}]},"passengers":{"seats":0,"beds":0,"connected":false},"engines":{"engines":[{"selected_stats":{"name":"Rhona Motorbau Z11 80hp","overspeed":18,"altitude":29,"torque":2,"rumble":0,"oiltank":true,"pulsejet":false,"liftbleed":0,"wetmass":0,"mass":4,"drag":8,"control":0,"cost":4,"reqsections":0,"visibility":0,"flightstress":0,"escape":0,"pitchstab":0,"latstab":0,"cooling":0,"reliability":-1,"power":8,"fuelconsumption":10,"maxstrain":0,"structure":0,"pitchboost":0,"pitchspeed":0,"wingarea":0,"toughness":0,"upkeep":0,"crashsafety":0,"bomb_mass":0,"fuel":0,"charge":0},"selected_inputs":{"name":"Rhona Motorbau Z11 80hp","engine_type":0,"type":2,"era_sel":1,"displacement":10.9,"compression":4.5,"cyl_per_row":9,"rows":1,"RPM_boost":1,"material_fudge":1,"quality_fudge":1,"compressor_type":0,"compressor_count":0,"min_IAF":0,"upgrades":[false,false,false,false]},"cooling_count":0,"radiator_index":-1,"selected_mount":0,"use_pushpull":false,"pp_torque_to_struct":false,"use_driveshafts":false,"geared_propeller_ratio":0,"geared_propeller_reliability":0,"cowl_sel":2,"is_generator":false,"has_alternator":false,"intake_fan":false}],"radiators":[],"is_asymmetric":false},"propeller":{"type":2,"use_variable":false},"frames":{"sections":[{"frame":0,"geodesic":false,"monocoque":false,"lifting_body":false,"internal_bracing":false},{"frame":0,"geodesic":false,"monocoque":false,"lifting_body":false,"internal_bracing":false},{"frame":0,"geodesic":false,"monocoque":false,"lifting_body":false,"internal_bracing":false}],"tail_sections":[{"frame":0,"geodesic":false,"monocoque":false,"lifting_body":false,"internal_bracing":false},{"frame":0,"geodesic":false,"monocoque":false,"lifting_body":false,"internal_bracing":false}],"tail_index":2,"use_farman":false,"use_boom":false,"flying_wing":false,"sel_skin":1},"wings":{"wing_list":[{"surface":0,"area":8,"span":8,"anhedral":0,"dihedral":0,"gull":false,"deck":0},{"surface":0,"area":8,"span":8,"anhedral":0,"dihedral":0,"gull":false,"deck":3}],"mini_wing_list":[],"wing_stagger":4,"is_swept":false,"is_closed":false},"stabilizers":{"hstab_sel":0,"hstab_count":1,"vstab_sel":0,"vstab_count":1},"controlsurfaces":{"aileron_sel":0,"rudder_sel":0,"elevator_sel":0,"flaps_sel":0,"slats_sel":0,"drag_sel":[false,false,false]},"reinforcements":{"ext_wood_count":[1,0,0,0,0,0,0,0,0],"ext_steel_count":[0,0,0,0,0,0,0,0,0],"cant_count":[0,0,0,0,0],"wires":true,"cabane_sel":1,"wing_blades":false},"fuel":{"tank_count":[1,0,0,0],"self_sealing":false,"fire_extinguisher":false},"munitions":{"bomb_count":0,"rocket_count":0,"bay_count":0,"bay1":false,"bay2":false},"cargo":{"space_sel":0},"gear":{"gear_sel":0,"retract":false,"extra_sel":[false,false,false]},"accessories":{"v":2,"armour_coverage":[0,0,0,0,0,0,0,0],"electrical_count":[0,0,0],"radio_sel":0,"info_sel":[false,false],"visi_sel":[false,false,false],"clim_sel":[false,false,false,false],"auto_sel":0,"cont_sel":0},"optimization":{"free_dots":0,"cost":0,"bleed":0,"escape":0,"mass":0,"toughness":0,"maxstrain":0,"reliability":0,"drag":0},"weapons":{"weapon_systems":[{"weapon_type":3,"fixed":true,"directions":[true,false,false,false,false,false],"weapons":[{"fixed":true,"wing":false,"covered":false,"accessible":false,"free_accessible":true,"synchronization":0,"w_count":1}],"ammo":1,"action":0,"projectile":0,"repeating":false}],"brace_count":0},"used":{"enabled":false,"burnt_out":0,"ragged":0,"hefty":0,"sticky_guns":0,"weak":0,"fragile":0,"leaky":0,"sluggish":0},"rotor":{"type":0,"rotor_count":0,"rotor_span":0,"rotor_mat":0,"is_tandem":false,"accessory":false}}`;this.freeze_calculation=
!0;this.stats=new Stats;this.name="Prototype Aircraft";this.version=a.version;this.era=new Era(a.era);this.cockpits=new Cockpits(a.cockpit);this.passengers=new Passengers(a.passengers);this.engines=new Engines(a.engines);this.propeller=new Propeller(a.propellers);this.frames=new Frames(a.frames);this.wings=new Wings(a.wings);this.stabilizers=new Stabilizers(a.stabilizers);this.controlsurfaces=new ControlSurfaces(a.controls);this.reinforcements=new Reinforcement(a.reinforcement);this.fuel=new Fuel(a.fuel);
this.munitions=new Munitions;this.cargo=new CargoAndPassengers(a.cargo);this.gear=new LandingGear(a.landing_gear);this.accessories=new Accessories(a.accessories);this.optimization=new Optimization;this.weapons=new Weapons(b);this.used=new Used;this.rotor=new Rotor(a.rotor);this.alter=new AlterStats;this.era.SetCalculateStats(()=>{this.CalculateStats()});this.cockpits.SetCalculateStats(()=>{this.CalculateStats()});this.passengers.SetCalculateStats(()=>{this.CalculateStats()});this.engines.SetCalculateStats(()=>
{this.CalculateStats()});this.propeller.SetCalculateStats(()=>{this.CalculateStats()});this.frames.SetCalculateStats(()=>{this.CalculateStats()});this.wings.SetCalculateStats(()=>{this.CalculateStats()});this.stabilizers.SetCalculateStats(()=>{this.CalculateStats()});this.controlsurfaces.SetCalculateStats(()=>{this.CalculateStats()});this.reinforcements.SetCalculateStats(()=>{this.CalculateStats()});this.fuel.SetCalculateStats(()=>{this.CalculateStats()});this.munitions.SetCalculateStats(()=>{this.CalculateStats()});
this.cargo.SetCalculateStats(()=>{this.CalculateStats()});this.gear.SetCalculateStats(()=>{this.CalculateStats()});this.accessories.SetCalculateStats(()=>{this.CalculateStats()});this.optimization.SetCalculateStats(()=>{this.CalculateStats()});this.weapons.SetCalculateStats(()=>{this.CalculateStats()});this.used.SetCalculateStats(()=>{this.CalculateStats()});this.rotor.SetCalculateStats(()=>{this.CalculateStats()});this.alter.SetCalculateStats(()=>{this.CalculateStats()});this.rotor.SetCantileverList(this.reinforcements.GetCantileverList());
this.cockpits.SetNumberOfCockpits(1);this.engines.SetNumberOfEngines(1);this.frames.SetTailType(1);this.use_storage=c;this.freeze_calculation=this.updated_stats=!1;this.aircraft_type=AIRCRAFT_TYPE.AIRPLANE;this.Reset()}toJSON(){return{version:this.version,name:this.name,aircraft_type:this.aircraft_type,era:this.era.toJSON(),cockpits:this.cockpits.toJSON(),passengers:this.passengers.toJSON(),engines:this.engines.toJSON(),propeller:this.propeller.toJSON(),frames:this.frames.toJSON(),wings:this.wings.toJSON(),
stabilizers:this.stabilizers.toJSON(),controlsurfaces:this.controlsurfaces.toJSON(),reinforcements:this.reinforcements.toJSON(),fuel:this.fuel.toJSON(),munitions:this.munitions.toJSON(),cargo:this.cargo.toJSON(),gear:this.gear.toJSON(),accessories:this.accessories.toJSON(),optimization:this.optimization.toJSON(),weapons:this.weapons.toJSON(),used:this.used.toJSON(),rotor:this.rotor.toJSON(),alter:this.alter.toJSON()}}fromJSON(a,b=!0){this.freeze_calculation=!0;b&&(console.log(a),console.log(a.version));
b=parseFloat(a.version);this.name=a.name;11.05<b?(this.aircraft_type=a.aircraft_type,this.rotor.SetType(a.aircraft_type)):(this.aircraft_type=AIRCRAFT_TYPE.AIRPLANE,this.rotor.SetType(AIRCRAFT_TYPE.AIRPLANE));this.era.fromJSON(a.era,b);this.cockpits.fromJSON(a.cockpits,b);this.passengers.fromJSON(a.passengers,b);this.engines.fromJSON(a.engines,b);this.propeller.fromJSON(a.propeller,b);this.frames.fromJSON(a.frames,b);this.wings.fromJSON(a.wings,b);this.stabilizers.fromJSON(a.stabilizers,b);this.controlsurfaces.fromJSON(a.controlsurfaces,
b);this.reinforcements.fromJSON(a.reinforcements,b);this.fuel.fromJSON(a.fuel,b);this.munitions.fromJSON(a.munitions,b);this.cargo.fromJSON(a.cargo,b);this.gear.fromJSON(a.gear,b);this.accessories.fromJSON(a.accessories,b);this.optimization.fromJSON(a.optimization,b);this.weapons.fromJSON(a.weapons,b);10.65<b&&this.used.fromJSON(a.used,b);11.05<b&&this.rotor.fromJSON(a.rotor,b);12.25<b?this.alter.fromJSON(a.alter,b):this.alter.ClearAll();this.freeze_calculation=!1;return!0}serialize(a){a.PushString(this.version);
a.PushString(this.name);this.era.serialize(a);this.cockpits.serialize(a);this.passengers.serialize(a);this.engines.serialize(a);this.propeller.serialize(a);this.frames.serialize(a);this.wings.serialize(a);this.stabilizers.serialize(a);this.controlsurfaces.serialize(a);this.reinforcements.serialize(a);this.fuel.serialize(a);this.munitions.serialize(a);this.cargo.serialize(a);this.gear.serialize(a);this.accessories.serialize(a);this.optimization.serialize(a);this.weapons.serialize(a);this.used.serialize(a);
this.rotor.serialize(a);a.PushNum(this.aircraft_type);this.alter.serialize(a)}deserialize(a){this.freeze_calculation=!0;a.version=parseFloat(a.GetString());this.name=a.GetString();this.era.deserialize(a);this.cockpits.deserialize(a);this.passengers.deserialize(a);this.engines.deserialize(a);this.propeller.deserialize(a);this.frames.deserialize(a);this.wings.deserialize(a);this.stabilizers.deserialize(a);this.controlsurfaces.deserialize(a);this.reinforcements.deserialize(a);this.fuel.deserialize(a);
this.munitions.deserialize(a);this.cargo.deserialize(a);this.gear.deserialize(a);this.accessories.deserialize(a);this.optimization.deserialize(a);this.weapons.deserialize(a);10.65<a.version&&this.used.deserialize(a);11.05<a.version?(this.rotor.deserialise(a),this.aircraft_type=a.GetNum(),this.rotor.SetType(this.aircraft_type)):(this.aircraft_type=AIRCRAFT_TYPE.AIRPLANE,this.rotor.SetType(AIRCRAFT_TYPE.AIRPLANE));12.25<a.version?this.alter.deserialize(a):this.alter.ClearAll();this.freeze_calculation=
!1}SetType(a){this.aircraft_type=a;this.rotor.SetType(a);this.CalculateStats()}SetDisplayCallback(a){this.DisplayCallback=a}CalculateStats(){if(!this.freeze_calculation){this.updated_stats=!1;var a=new Stats;a=a.Add(this.era.PartStats());a=a.Add(this.cockpits.PartStats());a=a.Add(this.passengers.PartStats());this.engines.SetTailMods(this.frames.GetFarmanOrBoom(),this.wings.GetSwept()&&this.stabilizers.GetVOutboard(),this.stabilizers.GetCanard());this.engines.SetInternal(this.aircraft_type==AIRCRAFT_TYPE.HELICOPTER||
IsAnyOrnithopter(this.aircraft_type));this.engines.SetMetalArea(this.wings.GetMetalArea());this.engines.HaveParasol(this.wings.GetParasol());a=a.Add(this.engines.PartStats());this.propeller.SetEngineTypes(this.engines.GetEngineTypes());this.propeller.SetAcftType(this.aircraft_type);a=a.Add(this.propeller.PartStats());a=a.Add(this.fuel.PartStats());a=a.Add(this.munitions.PartStats());this.weapons.SetNumberOfCockpits(this.cockpits.GetNumberOfCockpits());this.weapons.SetTractorInfo(this.engines.GetTractorSpinner());
this.weapons.SetPusherInfo(this.engines.GetPusherSpinner());this.weapons.cant_type=this.reinforcements.GetCantileverType();this.weapons.SetHavePropeller(0<this.engines.GetNumPropellers());this.weapons.SetCanWing(!IsAnyOrnithopter(this.aircraft_type));a=a.Add(this.weapons.PartStats());a=a.Add(this.cargo.PartStats());this.aircraft_type==AIRCRAFT_TYPE.AUTOGYRO?this.wings.SetRotorSpan(this.rotor.GetRotorSpan()):this.wings.SetRotorSpan(0);a=a.Add(this.wings.PartStats());this.rotor.SetWingArea(a.wingarea);
this.aircraft_type==AIRCRAFT_TYPE.AUTOGYRO&&(this.rotor.SetEngineCount(this.engines.GetNumberOfEngines()),a=a.Add(this.rotor.PartStats()));this.controlsurfaces.SetWingArea(a.wingarea);this.controlsurfaces.SetBoomTail(this.frames.GetUseBoom());this.controlsurfaces.SetSpan(this.wings.GetSpan());this.controlsurfaces.SetAcftType(this.aircraft_type);this.controlsurfaces.SetCanElevator(0<this.stabilizers.GetHStabCount());this.controlsurfaces.SetCanRudder(0<this.stabilizers.GetVStabCount());this.controlsurfaces.SetIsVTail(this.stabilizers.GetIsVTail());
this.aircraft_type==AIRCRAFT_TYPE.AIRPLANE?this.controlsurfaces.SetNumCantilever(this.reinforcements.GetTotalCantilevers()):this.controlsurfaces.SetNumCantilever(0);a=a.Add(this.controlsurfaces.PartStats());this.reinforcements.SetMonoplane(this.wings.GetMonoplane());this.reinforcements.SetTandem(this.wings.GetTandem());this.reinforcements.SetStaggered(this.wings.GetStaggered());this.reinforcements.SetCanUseExternal(0<this.wings.GetArea());this.reinforcements.SetSesquiplane(this.wings.GetIsSesquiplane());
this.reinforcements.SetAircraftType(this.aircraft_type);this.reinforcements.SetCantLift(this.era.GetCantLift());a=a.Add(this.reinforcements.PartStats());this.rotor.GetTailRotor()&&(a.power=Math.floor(1E-6+.9*a.power));this.accessories.SetAcftRadiator(0<this.engines.GetNumberOfRadiators());this.accessories.SetSkinArmor(this.frames.GetArmor());this.accessories.SetVitalParts(this.VitalComponentList().length);this.accessories.SetCanCutouts(this.wings.CanCutout(),this.frames.CanCutout());a=a.Add(this.accessories.PartStats());
this.frames.SetRequiredSections(a.reqsections);this.frames.SetHasTractorNacelles(this.engines.GetHasTractorNacelles());this.frames.SetIsTandem(this.wings.GetTandem());a=a.Add(this.frames.PartStats());this.stabilizers.SetEngineCount(this.engines.GetNumberOfEngines());this.stabilizers.SetIsTandem(this.wings.GetTandem());this.stabilizers.SetIsSwept(this.wings.GetSwept());this.stabilizers.SetHaveTail(!this.frames.GetIsTailless());this.stabilizers.SetHelicopter(!1);this.stabilizers.SetLiftingArea(a.wingarea);
this.stabilizers.wing_drag=this.wings.GetWingDrag()+this.rotor.GetRotorDrag();a=a.Add(this.stabilizers.PartStats());this.wings.SetAircraftMass(a.mass);this.wings.SetAcftType(this.aircraft_type);a.mass+=this.wings.GetPaperMass();a.mass=Math.max(1,a.mass);this.gear.SetGull(this.wings.HasInvertedGull());this.gear.SetLoadedMass(a.mass+a.wetmass);this.gear.CanBoat(this.engines.GetEngineHeight(),this.wings.GetWingHeight());a=a.Add(this.gear.PartStats());a.toughness+=Math.floor(1E-6+a.structure/5);this.optimization.SetAcftStats(a);
a=a.Add(this.optimization.PartStats());this.cockpits.SetHasRotary(this.engines.HasTractorRotary());a=a.Add(this.alter.PartStats());a.Round();if(!this.updated_stats){this.updated_stats=!0;this.stats=a;var b=this.GetDerivedStats();this.stats.cost+=this.controlsurfaces.GetFlapCost(b.DryMP);a.reliability-=this.used.burnt_out;this.weapons.SetStickyGuns(this.used.sticky_guns);this.cockpits.SetArmed(this.weapons.GetArmedSeats());this.cockpits.UpdateCrewStats(this.stats.escape,b.ControlStress,b.RumbleStress,
this.stats.visibility,this.stats.crashsafety);b=0;for(let c of this.cockpits.GetStressList())b=Math.max(b,c[0]-c[1]);0!=b&&-1==this.stats.warnings.findIndex(c=>c.source==lu("Co-Pilot Controls"))&&this.stats.warnings.push({source:lu("Co-Pilot Controls"),warning:lu("Co-Pilot Warning",b),color:WARNING_COLOR.WHITE});IsAnyOrnithopter(this.aircraft_type)&&(a.upkeep+=1);this.aircraft_type==AIRCRAFT_TYPE.ORNITHOPTER_BUZZER&&(a.reliability-=2);this.engines.UpdateReliability(a);this.reinforcements.SetAcftStructure(a.structure);
this.fuel.SetArea(this.wings.GetArea());this.fuel.SetCantilever(this.reinforcements.GetIsCantilever());this.munitions.SetAcftParameters(a.structure,this.era.GetMaxBomb(),this.wings.HasInvertedGull());this.stats.cost=Math.max(1,this.stats.cost);this.stats.liftbleed=Math.max(1,this.stats.liftbleed);10*this.engines.GetRumble()>a.structure&&(this.stats.power=0,this.stats.warnings.push({source:lu("Stat Rumble"),warning:lu("Rumble Warning"),color:WARNING_COLOR.RED}));this.DisplayCallback&&!this.freeze_calculation&&
this.DisplayCallback();this.use_storage&&window.localStorage.setItem("aircraft",JSON.stringify(this))}}}GetDerivedStats(){var a=Math.floor(1E-6+this.stats.mass/5);a=Math.max(a,1);var b=Math.floor(1E-6+(this.stats.mass+this.stats.wetmass)/5);b=Math.max(b,1);var c=Math.floor(1E-6+(this.stats.mass+this.stats.wetmass+this.stats.bomb_mass)/5);c=Math.max(c,1);var d=Math.floor(1E-6+(this.stats.drag+a)/5),e=d=Math.max(d,1),f=Math.floor(1E-6+(this.stats.drag+this.munitions.GetExternalMass()+a)/5);f=Math.max(f,
1);var g=Math.floor(1E-6+this.stats.pitchspeed*Math.sqrt(2E3*this.stats.power/(9*d))),h=Math.floor(1E-6+this.stats.pitchspeed*Math.sqrt(2E3*this.stats.power/(9*e))),k=Math.floor(1E-6+this.stats.pitchspeed*Math.sqrt(2E3*this.stats.power/(9*f))),l=Math.max(1,Math.floor(1E-6+this.stats.liftbleed*a/Math.max(1,this.stats.wingarea))),n=Math.max(1,Math.floor(1E-6+this.stats.liftbleed*b/Math.max(1,this.stats.wingarea))),m=Math.max(Math.floor(1E-6+this.stats.liftbleed*c/Math.max(1,this.stats.wingarea))),u=
this.engines.GetOverspeed(),q=Math.floor(1E-6+this.stats.power/a),x=Math.floor(1E-6+this.stats.power/b),p=Math.floor(1E-6+this.stats.power/c);0==p&&-1==this.stats.warnings.findIndex(z=>z.source==lu("Derived Boost"))&&this.stats.warnings.push({source:lu("Derived Boost"),warning:lu("Boost Warning"),color:WARNING_COLOR.RED});var t=Math.floor(1E-6+this.stats.pitchboost*g);g=Math.floor(1E-6+g*(1-.1*this.used.ragged));h=Math.floor(1E-6+h*(1-.1*this.used.ragged));k=Math.floor(1E-6+k*(1-.1*this.used.ragged));
var v=this.stats.pitchstab+this.stats.latstab;0<this.stats.pitchstab&&0<this.stats.latstab?v+=2:0>this.stats.pitchstab&&0>this.stats.latstab&&(v-=2);var w=100+this.stats.control-a;10<v||-10>v?(w=-1/0,-1==this.stats.warnings.findIndex(z=>z.source==lu("Derived Stability"))&&this.stats.warnings.push({source:lu("Derived Stability"),warning:lu("Stability Warning"),color:WARNING_COLOR.RED})):10==v?w-=4:6<v?w-=3:3<v?w-=2:0<v?--w:0==v?w+=0:-4<v?w+=1:-7<v?w+=2:-10<v?w+=3:-10==v&&(w+=4);var y=w+a-b,r=w+a-c;
w=Math.floor(1E-6+w-5*this.used.sluggish);y=Math.floor(1E-6+y-5*this.used.sluggish);r=Math.floor(1E-6+r-5*this.used.sluggish);var A=Math.min(this.stats.maxstrain-a,this.stats.structure);this.optimization.final_ms=Math.floor(1E-6+1.5*this.optimization.GetMaxStrain()*A/10);A+=this.optimization.final_ms;A=Math.floor(1E-6+A*(1-.2*this.used.fragile));10>A&&-1==this.stats.warnings.findIndex(z=>z.source==lu("Stat Max Strain"))&&this.stats.warnings.push({source:lu("Stat Max Strain"),warning:lu("Max Strain Warning"),
color:WARNING_COLOR.RED});var H=this.stats.toughness;H=Math.floor(1E-6+H*(1-.5*this.used.weak));var L=this.stats.structure,D=Math.ceil(-1E-6+d/this.propeller.GetEnergy()),I=D+1;D=Math.min(D,10);I=Math.min(I,10);var E=Math.ceil(-1E-6+Math.floor(1E-6+(l+n)/2)/this.propeller.GetTurn());this.aircraft_type==AIRCRAFT_TYPE.HELICOPTER&&(E=Math.max(1,Math.floor(1E-6+a/2))+this.rotor.GetRotorBleed(),D=Math.max(1,Math.floor(1E-6+d/7)),m=n=l=0,g=Math.min(37,g),h=Math.min(37,h),k=Math.min(37,k));E=Math.max(E,
1);var M=Math.max(E+1,1);l=Math.max(1,Math.floor(1E-6+l*(1+.2*this.used.hefty)));n=Math.max(1,Math.floor(1E-6+n*(1+.2*this.used.hefty)));m=Math.max(1,Math.floor(1E-6+m*(1+.2*this.used.hefty)));(k<=m||h<=n)&&-1==this.stats.warnings.findIndex(z=>z.source==lu("Stall Speed"))&&this.stats.warnings.push({source:lu("Stall Speed"),warning:lu("Stall Speed Warning"),color:WARNING_COLOR.RED});var B=Math.floor(1E-6+this.stats.fuel/this.stats.fuelconsumption);B=Math.floor(1E-6+B*(1-.2*this.used.leaky));isFinite(B)||
(B=0);6>B&&-1==this.stats.warnings.findIndex(z=>z.source==lu("Derived Fuel Uses"))&&this.stats.warnings.push({source:lu("Derived Fuel Uses"),warning:lu("Fuel Uses Warning"),color:WARNING_COLOR.YELLOW});var F=1;(3<v||-3>v)&&F++;var G=0;F+=Math.min(this.accessories.GetMaxMassStress(),Math.floor(1E-6+a/10));var C=this.accessories.GetMaxTotalStress();F=Math.min(C,F);0<this.engines.GetMaxRumble()&&(G+=Math.max(1,this.engines.GetMaxRumble()),G=Math.floor(1E-6+G));0==C&&(G=0);C=Math.max(1,Math.floor(1E-6+
this.stats.power/a*(23/this.stats.pitchspeed)/d));var J=Math.max(1,Math.floor(1E-6+this.stats.power/b*(23/this.stats.pitchspeed)/e)),K=Math.max(1,Math.floor(1E-6+this.stats.power/c*(23/this.stats.pitchspeed)/f));isFinite(C)||(K=J=C=0);IsAnyOrnithopter(this.aircraft_type)&&(w+=5,y+=5,r+=5,-1==this.stats.warnings.findIndex(z=>z.source==lu("Ornithopter Stall"))&&this.stats.warnings.push({source:lu("Ornithopter Stall"),warning:lu("Ornithopter Stall Warning"),color:WARNING_COLOR.WHITE}),u=A);this.aircraft_type==
AIRCRAFT_TYPE.ORNITHOPTER_FLUTTER&&(w+=5,y+=5,r+=5,u=Infinity,-1==this.stats.warnings.findIndex(z=>z.source==lu("Ornithopter Flutterer Attack"))&&this.stats.warnings.push({source:lu("Ornithopter Flutterer Attack"),warning:lu("Ornithopter Flutterer Attack Warning"),color:WARNING_COLOR.WHITE}));this.aircraft_type==AIRCRAFT_TYPE.ORNITHOPTER_BUZZER&&(-1==this.stats.warnings.findIndex(z=>z.source==lu("Ornithopter Buzzer Boost"))&&this.stats.warnings.push({source:lu("Ornithopter Buzzer Boost"),warning:lu("Ornithopter Buzzer Boost Warning"),
color:WARNING_COLOR.WHITE}),-1==this.stats.warnings.findIndex(z=>z.source==lu("Ornithopter Buzzer Stall"))&&this.stats.warnings.push({source:lu("Ornithopter Buzzer Stall"),warning:lu("Ornithopter Buzzer Stall Warning"),color:WARNING_COLOR.WHITE}));return{DryMP:a,WetMP:b,WetMPwBombs:c,DPEmpty:d,DPFull:e,DPwBombs:f,MaxSpeedEmpty:g,MaxSpeedFull:h,MaxSpeedwBombs:k,StallSpeedEmpty:l,StallSpeedFull:n,StallSpeedFullwBombs:m,Overspeed:u,BoostEmpty:q,BoostFull:x,BoostFullwBombs:p,Dropoff:t,Stabiilty:v,HandlingEmpty:w,
HandlingFull:y,HandlingFullwBombs:r,MaxStrain:A,Toughness:H,Structure:L,EnergyLoss:D,EnergyLosswBombs:I,TurnBleed:E,TurnBleedwBombs:M,FuelUses:B,ControlStress:F,RumbleStress:G,RateOfClimbFull:J,RateOfClimbEmpty:C,RateOfClimbwBombs:K}}VitalComponentList(){var a=this.GetDerivedStats(),b=[];b.push(lu("Vital Part Controls"));for(var c=0;c<this.GetCockpits().GetNumberOfCockpits();c++)b.push(lu("Seat #",c+1)+": "+lu(this.GetCockpits().GetCockpit(c).GetName()));0<a.FuelUses&&b.push(lu("Vital Part Fuel Tanks"));
for(a=0;a<this.GetEngines().GetNumberOfEngines();a++)this.GetEngines().GetEngine(a).GetUsePushPull()?(b.push(lu("Vital Part Engine Pusher",a+1)),this.GetEngines().GetEngine(a).GetHasOilTank()&&b.push(lu("Vital Part Oil Tank Pusher",a+1)),this.GetEngines().GetEngine(a).GetHasOilCooler()&&b.push(lu("Vital Part Oil Cooler Pusher",a+1)),this.GetEngines().GetEngine(a).GetHasOilPan()&&b.push(lu("Vital Part Oil Pan Pusher",a+1)),b.push(lu("Vital Part Engine Puller",a+1)),this.GetEngines().GetEngine(a).GetHasOilTank()&&
b.push(lu("Vital Part Oil Tank Puller",a+1)),this.GetEngines().GetEngine(a).GetHasOilCooler()&&b.push(lu("Vital Part Oil Cooler Puller",a+1)),this.GetEngines().GetEngine(a).GetHasOilPan()&&b.push(lu("Vital Part Oil Pan Puller",a+1))):(b.push(lu("Vital Part Engine",a+1)),this.GetEngines().GetEngine(a).GetHasOilTank()&&b.push(lu("Vital Part Oil Tank",a+1)),this.GetEngines().GetEngine(a).GetHasOilCooler()&&b.push(lu("Vital Part Oil Cooler",a+1)),this.GetEngines().GetEngine(a).GetHasOilPan()&&b.push(lu("Vital Part Oil Pan",
a+1)));for(a=0;a<this.GetEngines().GetNumberOfRadiators();a++)b.push(lu("Vital Part Radiator",a+1));this.IsElectrics()&&b.push(lu("Vital Part Electrics"));a=this.GetWeapons().GetWeaponList();for(c=0;c<this.GetWeapons().GetWeaponSets().length;c++)b.push(lu("Vital Part Weapon Set",c+1,a[this.GetWeapons().GetWeaponSets()[c].GetWeaponSelected()].abrv));this.GetLandingGear().IsVital()&&b.push(lu("Vital Part Landing Gear"));this.rotor.GetTailRotor()&&b.push(lu("Vital Part Tail Rotor"));return b}SetStorage(a){this.use_storage=
a}Reset(){this.fromJSON(JSON.parse(this.reset_json),!1)}GetVersion(){return this.version}GetCommunicationName(){return this.accessories.GetCommunicationName()}GetAttackList(){return this.cockpits.GetAttackList()}GetVisibilityList(){return this.cockpits.GetVisibilityList()}GetStressList(){return this.cockpits.GetStressList()}GetEscapeList(){return this.cockpits.GetEscapeList()}GetCrashList(){return this.cockpits.GetCrashList()}GetReliabilityList(){return this.engines.GetReliabilityList()}GetMinIAF(){return this.engines.GetMinIAF()}GetMaxIAF(){return this.engines.GetMaxIAF()}GetMinAltitude(){return this.engines.GetMinAltitude()}GetMaxAltitude(){return this.engines.GetMaxAltitude()}GetGearName(){return this.gear.GetGearName()}GetIsFlammable(){return this.frames.GetIsFlammable()||
this.wings.GetIsFlammable()||this.engines.GetIsFlammable()}GetAircraftType(){return this.aircraft_type}GetEra(){return this.era}GetCockpits(){return this.cockpits}GetPassengers(){return this.passengers}GetEngines(){return this.engines}GetPropeller(){return this.propeller}GetFrames(){return this.frames}GetWings(){return this.wings}GetStabilizers(){return this.stabilizers}GetControlSurfaces(){return this.controlsurfaces}GetReinforcements(){return this.reinforcements}GetFuel(){return this.fuel}GetMunitions(){return this.munitions}GetCargoAndPassengers(){return this.cargo}GetLandingGear(){return this.gear}GetAccessories(){return this.accessories}GetOptimization(){return this.optimization}GetStats(){return this.stats}GetWeapons(){return this.weapons}IsElectrics(){return this.engines.IsElectrics()||
this.accessories.IsElectrics()||this.cockpits.IsElectrics()}GetUsed(){return this.used}GetRotor(){return this.rotor}GetAlter(){return this.alter}GetElectrics(){let a={storage:0,equipment:[]};a=MergeElectrics(a,this.accessories.GetElectrics());a=MergeElectrics(a,this.wings.GetElectrics());a=MergeElectrics(a,this.cockpits.GetElectrics());a=MergeElectrics(a,this.alter.GetElectrics());a=MergeElectrics(a,this.cargo.GetElectrics());a=MergeElectrics(a,this.era.GetElectrics());a=MergeElectrics(a,this.frames.GetElectrics());
a=MergeElectrics(a,this.fuel.GetElectrics());a=MergeElectrics(a,this.gear.GetElectrics());a=MergeElectrics(a,this.munitions.GetElectrics());a=MergeElectrics(a,this.optimization.GetElectrics());a=MergeElectrics(a,this.passengers.GetElectrics());a=MergeElectrics(a,this.reinforcements.GetElectrics());a=MergeElectrics(a,this.rotor.GetElectrics());a=MergeElectrics(a,this.stabilizers.GetElectrics());a=MergeElectrics(a,this.used.GetElectrics());a.equipment=a.equipment.sort((c,d)=>{var e=parseInt(c.charge);
"-"==c.charge&&(e=0);c=parseInt(d.charge);"-"==d.charge&&(c=0);return isNaN(e)&&isNaN(c)?0:isNaN(e)?-1:isNaN(c)?1:c-e});a=MergeElectrics(this.engines.GetElectrics(),a);a=MergeElectrics(a,this.weapons.GetElectrics());var b=!1;for(let c of a.equipment){let d=parseInt(c.charge);!isNaN(d)&&0<d&&(c.charge="+"+c.charge,b=!0)}0<a.equipment.length&&0>=a.storage&&!b&&-1==this.stats.warnings.findIndex(c=>c.source==lu("Insufficient Charge"))&&this.stats.warnings.push({source:lu("Insufficient Charge"),warning:lu("Insufficient Charge Warning"),
color:WARNING_COLOR.RED});return a}}var internal_id=0;function download(a,b,c){a=new Blob([a],{type:c});var d=document.createElement("a"),e=URL.createObjectURL(a);d.href=e;d.download=b;document.body.appendChild(d);d.click();setTimeout(function(){document.body.removeChild(d);window.URL.revokeObjectURL(e)},0)}
function copyStringToClipboard(a){var b=document.createElement("textarea");b.value=a;b.setAttribute("readonly","");b.style.position="absolute";b.style.left="-9999px";document.body.appendChild(b);b.select();document.execCommand("copy");document.body.removeChild(b)}function GenerateID(){internal_id++;return"internal_id_"+internal_id.toString()}
function CreateFlexSection(a){var b={div0:document.createElement("DIV"),div1:document.createElement("DIV"),div2:document.createElement("DIV")};b.div0.classList.add("flex-container-o");b.div1.classList.add("flex-container-i");b.div2.classList.add("flex-container-i");b.div0.appendChild(b.div1);b.div0.appendChild(b.div2);a.appendChild(b.div0);return b}function CreateTH(a,b){var c=document.createElement("TH");c.innerHTML=b;a.appendChild(c);return c}
function CreateTD(a,b){var c=document.createElement("TD");c.innerHTML=b;a.appendChild(c);return c}function CreateInput(a,b,c,d=!0){var e=document.createElement("SPAN"),f=document.createElement("LABEL");b.id=GenerateID();f.htmlFor=b.id;f.style.marginLeft="0.25em";f.style.marginRight="0.5em";f.textContent=a;b.setAttribute("type","number");b.min="0";b.step="1";b.valueAsNumber=0;e.appendChild(f);e.appendChild(b);c.appendChild(e);d&&c.appendChild(document.createElement("BR"))}
function FlexInput(a,b,c){var d=document.createElement("LABEL");b.id=GenerateID();d.htmlFor=b.id;d.style.marginLeft="0.25em";d.style.marginRight="0.5em";d.textContent=a;b.setAttribute("type","number");b.min="0";b.step="1";b.valueAsNumber=0;d.classList.add("flex-item");b.classList.add("flex-item");c.div1.appendChild(d);c.div2.appendChild(b)}
function FlexText(a,b,c){var d=document.createElement("LABEL");b.id=GenerateID();d.htmlFor=b.id;d.style.marginLeft="0.25em";d.style.marginRight="0.5em";d.textContent=a;b.setAttribute("type","text");b.value="Default";d.classList.add("flex-item");b.classList.add("flex-item");c.div1.appendChild(d);c.div2.appendChild(b)}
function FlexDisplay(a,b,c){var d=document.createElement("LABEL");b.id=GenerateID();d.htmlFor=b.id;d.style.marginLeft="0.25em";d.style.marginRight="0.5em";d.textContent=a;d.classList.add("flex-item");b.classList.add("flex-item");c.div1.appendChild(d);c.div2.appendChild(b)}
function FlexSelect(a,b,c){var d=document.createElement("LABEL");b.id=GenerateID();d.htmlFor=b.id;d.style.marginLeft="0.25em";d.style.marginRight="0.5em";d.textContent=a;d.classList.add("flex-item");b.classList.add("flex-item");c.div1.appendChild(d);c.div2.appendChild(b)}
function CreateCheckbox(a,b,c,d=!0){var e=document.createElement("SPAN"),f=document.createElement("LABEL");b.id=GenerateID();f.htmlFor=b.id;f.style.marginLeft="0.25em";f.style.marginRight="0.5em";f.textContent=a;b.setAttribute("type","checkbox");e.appendChild(f);e.appendChild(b);c.appendChild(e);d&&c.appendChild(document.createElement("BR"))}
function CreateSelect(a,b,c,d=!0){var e=document.createElement("SPAN"),f=document.createElement("LABEL");b.id=GenerateID();f.htmlFor=b.id;f.style.marginLeft="0.25em";f.style.marginRight="0.5em";f.textContent=a;e.appendChild(f);e.appendChild(b);c.appendChild(e);d&&c.appendChild(document.createElement("BR"))}
function CreateText(a,b,c,d=!0){var e=document.createElement("SPAN"),f=document.createElement("LABEL");b.id=GenerateID();f.htmlFor=b.id;f.style.marginLeft="0.25em";f.style.marginRight="0.5em";f.textContent=a;b.setAttribute("type","text");b.value="Default";e.appendChild(f);e.appendChild(b);c.appendChild(e);d&&c.appendChild(document.createElement("BR"))}
function CreateButton(a,b,c,d=!0){var e=document.createElement("SPAN"),f=document.createElement("LABEL");b.hidden=!0;b.id=GenerateID();b.textContent=a;f.htmlFor=b.id;f.style.marginLeft="0.25em";f.style.marginRight="0.5em";f.textContent=a;f.classList.add("lbl_action");f.classList.add("btn_th");e.appendChild(f);e.appendChild(b);c.appendChild(e);d&&(c.appendChild(document.createElement("BR")),c.appendChild(document.createElement("BR")))}
function FlexCheckbox(a,b,c){var d=document.createElement("LABEL");b.id=GenerateID();d.htmlFor=b.id;d.id=GenerateID();d.style.marginLeft="0.25em";d.style.marginRight="0.5em";d.textContent=a;b.setAttribute("type","checkbox");d.classList.add("flex-item");b.classList.add("flex-item");c.div1.appendChild(d);a=document.createElement("LABEL");var e=document.createElement("SPAN");e.appendChild(a);e.appendChild(b);c.div2.appendChild(e);return d}
function FlexLabel(a,b){var c=document.createElement("LABEL");c.style.marginLeft="0.25em";c.style.marginRight="0.5em";c.textContent=a;c.classList.add("flex-item");b.appendChild(c);return c}
function FlexLabels(a,b,c){var d=document.createElement("LABEL");d.style.marginLeft="0.25em";d.style.marginRight="0.5em";d.textContent=a;d.classList.add("flex-item");c.div1.appendChild(d);a=document.createElement("LABEL");a.style.marginLeft="0.25em";a.style.marginRight="0.5em";a.textContent=b;a.classList.add("flex-item");c.div2.appendChild(a);return[d,a]}
function FlexSpace(a){var b=document.createElement("LABEL");b.textContent=" ";b.classList.add("flex-item");a.div1.appendChild(b);b=document.createElement("LABEL");b.textContent=" ";b.classList.add("flex-item");a.div2.appendChild(b)}function insertRow(a){var b=document.createElement("TR");a.append(b);return b}function insertCell(a){var b=document.createElement("TD");a.append(b);return b}
function BlinkBad(a){a.classList.toggle("changed_b",!1);a.classList.toggle("changed_g",!1);a.classList.toggle("changed_n",!1);a.offsetHeight;a.classList.toggle("changed_b")}function BlinkGood(a){a.classList.toggle("changed_b",!1);a.classList.toggle("changed_g",!1);a.classList.toggle("changed_n",!1);a.offsetHeight;a.classList.toggle("changed_g")}
function BlinkNeutral(a){a.classList.toggle("changed_b",!1);a.classList.toggle("changed_g",!1);a.classList.toggle("changed_n",!1);a.offsetHeight;a.classList.toggle("changed_n")}function BlinkNone(a){a.classList.toggle("changed_b",!1);a.classList.toggle("changed_g",!1);a.classList.toggle("changed_n",!1)}
function BlinkIfChanged(a,b,c=null){if(enable_anim)if(a.textContent!=b)if(null==c)BlinkNeutral(a);else{var d=parseInt(a.textContent)<parseInt(b);c&&d||!c&&!d?BlinkGood(a):BlinkBad(a)}else BlinkNone(a);a.textContent=b}function _arrayBufferToString(a){var b="";a=new Uint8Array(a);for(var c=a.byteLength,d=0;d<c;d++)b+=String.fromCharCode(a[d]);return b}function _stringToArrayBuffer(a){var b=new Uint8Array(a.length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b.buffer}
const loadJSON=(a,b)=>{let c=new XMLHttpRequest;c.overrideMimeType("application/json");c.open("GET",a,!0);c.onreadystatechange=()=>{4===c.readyState&&200===c.status&&b(c.responseText)};c.send(null)};class Display{}
class Era_HTML extends Display{constructor(a){super();this.model=a;document.getElementById("lbl_era").textContent=lu("Era Section Title");a=document.getElementById("table_era");var b=document.createDocumentFragment(),c=insertRow(b);CreateTH(c,lu("Era Option"));CreateTH(c,lu("Stat Lift Bleed"));CreateTH(c,lu("Stat Cost"));CreateTH(c,lu("Stat Pitch Stability"));c=insertRow(b);var d=c.insertCell();this.select=document.createElement("SELECT");d.append(this.select);this.bleed=c.insertCell();this.cost=
c.insertCell();this.pstab=c.insertCell();this.select.required=!0;this.select.onchange=()=>{this.model.SetSelected(this.select.selectedIndex)};for(let e of this.model.GetEraOptions())c=document.createElement("OPTION"),c.text=lu(e.name),this.select.add(c);a.appendChild(b)}UpdateDisplay(){this.select.selectedIndex=this.model.GetSelected();var a=this.model.PartStats();BlinkIfChanged(this.bleed,a.liftbleed.toString(),!1);BlinkIfChanged(this.cost,a.cost.toString(),!1);BlinkIfChanged(this.pstab,a.pitchstab.toString(),
!1)}}
class Cockpit_HTML extends Display{constructor(a,b){super();this.row=a;this.cockpit=b;this.upg_chbxs=[];this.sft_chbxs=[];this.gun_chbxs=[];a=document.createDocumentFragment();var c=insertCell(a),d=insertCell(a),e=insertCell(a),f=insertCell(a),g=insertCell(a),h=document.createElement("TABLE"),k=h.insertRow();CreateTH(k,lu("Stat Mass"));CreateTH(k,lu("Stat Drag"));CreateTH(k,lu("Stat Cost"));k=h.insertRow();this.d_mass=k.insertCell();this.d_drag=k.insertCell();this.d_cost=k.insertCell();k=h.insertRow();CreateTH(k,
lu("Stat Control"));CreateTH(k,lu("Stat Required Sections"));CreateTH(k,"");k=h.insertRow();this.d_cont=k.insertCell();this.d_rseq=k.insertCell();k.insertCell();k=h.insertRow();CreateTH(k,lu("Stat Flight Stress"));CreateTH(k,lu("Stat Escape"));CreateTH(k,lu("Stat Visibility"));k=h.insertRow();this.d_strs=k.insertCell();this.d_escp=k.insertCell();this.d_visi=k.insertCell();g.appendChild(h);g.className="inner_table";h.className="inner_table";this.sel_type=document.createElement("SELECT");this.d_strs.className=
"part_local";this.d_visi.className="part_local";this.d_escp.className="part_local";for(var l of b.GetTypeList())g=document.createElement("OPTION"),g.text=lu(l.name),this.sel_type.add(g);c.appendChild(this.sel_type);l=CreateFlexSection(d);c=b.GetUpgradeList();d=b.CanUpgrades();for(let m=0;m<c.length;m++){let u=document.createElement("INPUT");d[m]&&(FlexCheckbox(lu(c[m].name),u,l),u.onchange=()=>{this.cockpit.SetUpgrade(m,u.checked)});this.upg_chbxs.push(u)}l=CreateFlexSection(e);e=0;for(var n of b.GetSafetyList()){let m=
document.createElement("INPUT");FlexCheckbox(lu(n.name),m,l);let u=e;e+=1;m.onchange=()=>{this.cockpit.SetSafety(u,m.checked)};this.sft_chbxs.push(m)}l=CreateFlexSection(f);n=0;for(let m of b.GetGunsightList()){let u=document.createElement("INPUT");FlexCheckbox(lu(m.name),u,l);let q=n;n+=1;u.onchange=()=>{this.cockpit.SetGunsight(q,u.checked)};this.gun_chbxs.push(u)}this.bombsight=document.createElement("INPUT");FlexInput(lu("Cockpit Bombsight"),this.bombsight,l);this.bombsight.onchange=()=>{this.cockpit.SetBombsightQuality(this.bombsight.valueAsNumber)};
this.bombsight.min="0";this.bombsight.max="301";this.bombsight.step="1";this.sel_type.onchange=()=>{this.cockpit.SetType(this.sel_type.selectedIndex)};this.row.appendChild(a)}UpdateCockpit(a){this.cockpit=a}UpdateDisplay(){var a=this.cockpit.PartStats();BlinkIfChanged(this.d_mass,a.mass.toString(),!1);BlinkIfChanged(this.d_drag,a.drag.toString(),!1);BlinkIfChanged(this.d_cost,a.cost.toString(),!1);BlinkIfChanged(this.d_cont,a.control.toString(),!0);BlinkIfChanged(this.d_rseq,a.reqsections.toString(),
!1);a=this.cockpit.GetFlightStress();BlinkIfChanged(this.d_strs,StringFmt.Format("{0}",a[0]));BlinkIfChanged(this.d_escp,this.cockpit.GetEscape().toString(),!0);BlinkIfChanged(this.d_visi,this.cockpit.GetVisibility().toString(),!0);this.sel_type.selectedIndex=this.cockpit.GetType();a=this.cockpit.GetSelectedUpgrades();for(var b=0;b<this.upg_chbxs.length;b++)this.upg_chbxs[b].checked=a[b];a=this.cockpit.GetSelectedSafety();b=this.cockpit.CanSafety();for(let c=0;c<this.sft_chbxs.length;c++)this.sft_chbxs[c].checked=
a[c],this.sft_chbxs[c].disabled=!b[c];a=this.cockpit.GetSelectedGunsights();for(b=0;b<this.gun_chbxs.length;b++)this.gun_chbxs[b].checked=a[b];this.bombsight.valueAsNumber=this.cockpit.GetBombsightQuality()}}
class Cockpits_HTML extends Display{constructor(a){super();this.cockpits=a;document.getElementById("lbl_cockpits").textContent=lu("Cockpit Section Title");document.getElementById("lbl_num_cockpits").textContent=lu("Cockpit Num Cockpits");this.tbl=document.getElementById("table_cockpit");a=document.createDocumentFragment();var b=insertRow(a);CreateTH(b,lu("Cockpit Option"));CreateTH(b,lu("Cockpit Upgrade"));CreateTH(b,lu("Cockpit Safety Options"));CreateTH(b,lu("Cockpit Gunsights"));CreateTH(b,lu("Cockpit Cockpit Stats"));
this.counter=document.getElementById("num_cockpits");this.positions=[];this.counter.onchange=c=>{this.cockpits.SetNumberOfCockpits(this.counter.valueAsNumber)};this.tbl.appendChild(a)}CounterChange(){for(;this.positions.length>this.counter.valueAsNumber;)this.RemoveCockpit();for(;this.positions.length<this.counter.valueAsNumber;)this.AddCockpit(this.positions.length)}AddCockpit(a){var b=this.tbl.insertRow();a=new Cockpit_HTML(b,this.cockpits.GetCockpit(a));this.positions.push(a)}RemoveCockpit(){this.positions.pop();
this.tbl.deleteRow(this.tbl.rows.length-1)}UpdateDisplay(){this.counter.valueAsNumber=this.cockpits.GetNumberOfCockpits();this.CounterChange();for(let a=0;a<this.positions.length;a++){let b=this.positions[a];b.UpdateCockpit(this.cockpits.GetCockpit(a));b.UpdateDisplay()}}}
class Passengers_HTML extends Display{constructor(a){super();this.pass=a;document.getElementById("lbl_passengers").textContent=lu("Passengers Section Title");a=document.getElementById("table_passengers");var b=document.createDocumentFragment(),c=insertRow(b);CreateTH(c,lu("Passengers Number of Seats"));CreateTH(c,lu("Passengers Number of Beds"));CreateTH(c,lu("Passengers Upgrade"));CreateTH(c,lu("Stat Mass"));CreateTH(c,lu("Stat Required Sections"));c=insertRow(b);this.nseats=document.createElement("INPUT");
this.nseats.type="number";this.nseats.min="0";c.insertCell().append(this.nseats);this.nbeds=document.createElement("INPUT");this.nbeds.type="number";this.nbeds.min="0";c.insertCell().append(this.nbeds);var d=c.insertCell();this.connect=document.createElement("INPUT");d=CreateFlexSection(d);FlexCheckbox(lu("Passengers Connectivity"),this.connect,d);this.mass=c.insertCell();this.reqseq=c.insertCell();this.connect.disabled=!0;this.nseats.onchange=()=>{this.pass.SetSeats(this.nseats.valueAsNumber)};this.nbeds.onchange=
()=>{this.pass.SetBeds(this.nbeds.valueAsNumber)};this.connect.onchange=()=>{this.pass.SetConnected(this.connect.checked)};a.appendChild(b)}UpdateDisplay(){var a=this.pass.PartStats();this.nseats.valueAsNumber=this.pass.GetSeats();this.nbeds.valueAsNumber=this.pass.GetBeds();this.connect.checked=this.pass.GetConnected();this.connect.disabled=!this.pass.PossibleConnection();BlinkIfChanged(this.mass,a.mass.toString(),!1);BlinkIfChanged(this.reqseq,a.reqsections.toString(),!1)}}
class Engine_HTML extends Display{constructor(a,b){super();this.engine=a;this.InitTypeSelect(b);var c=b.insertCell();c.className="inner_table";var d=document.createElement("TABLE");d.className="inner_table";CreateTH(d.insertRow(),lu("Engine Cooling"));this.cool_cell=d.insertRow().insertCell();CreateTH(d.insertRow(),lu("Engine Mounting"));a=d.insertRow().insertCell();CreateTH(d.insertRow(),lu("Engine Upgrades"));var e=d.insertRow().insertCell();c.appendChild(d);d=b.insertCell();d.className="inner_table";
var f=document.createElement("TABLE");f.className="inner_table";CreateTH(f.insertRow(),lu("Engine Cowls"));c=f.insertRow().insertCell();d.appendChild(f);CreateTH(f.insertRow(),lu("Engine Electrical"));d=f.insertRow().insertCell();this.InitMountSelect(a);this.InitUpgradeSelect(e);this.InitCowlSelect(c);this.InitElectricSelect(d);this.InitStatDisplay(b);this.intake_fan=document.createElement("INPUT");this.intake_fan.onchange=()=>{this.engine.SetIntakeFan(this.intake_fan.checked)}}InitTypeSelect(a){this.e_rarity=
document.createElement("LABEL");this.e_pwr=document.createElement("LABEL");this.e_mass=document.createElement("LABEL");this.e_drag=document.createElement("LABEL");this.e_rely=document.createElement("LABEL");this.e_cool=document.createElement("LABEL");this.e_over=document.createElement("LABEL");this.e_fuel=document.createElement("LABEL");this.e_alti=document.createElement("LABEL");this.e_torq=document.createElement("LABEL");this.e_rumb=document.createElement("LABEL");this.e_cost=document.createElement("LABEL");
this.cool_count=document.createElement("INPUT");this.cool_count.setAttribute("type","number");a=a.insertCell(0);this.e_list_select=document.createElement("SELECT");this.e_list_select.required=!0;a.appendChild(this.e_list_select);a.appendChild(document.createElement("BR"));for(var b of engine_list.keys()){var c=document.createElement("OPTION");c.text=b;this.e_list_select.add(c)}this.e_select=document.createElement("SELECT");this.e_select.required=!0;a.appendChild(this.e_select);a.appendChild(document.createElement("BR"));
for(b=0;b<engine_list.get("Custom").length;b++){c=engine_list.get("Custom").get(b);let d=document.createElement("OPTION");d.text=c.name;this.e_select.add(d)}a=CreateFlexSection(a);FlexDisplay(lu("Rarity"),this.e_rarity,a);FlexDisplay(lu("Stat Power"),this.e_pwr,a);FlexDisplay(lu("Stat Mass"),this.e_mass,a);FlexDisplay(lu("Stat Drag"),this.e_drag,a);FlexDisplay(lu("Stat Reliability"),this.e_rely,a);FlexDisplay(lu("Stat Cooling"),this.e_cool,a);FlexDisplay(lu("Stat Overspeed"),this.e_over,a);FlexDisplay(lu("Stat Fuel Consumption"),
this.e_fuel,a);FlexDisplay(lu("Stat Altitude"),this.e_alti,a);FlexDisplay(lu("Stat Torque"),this.e_torq,a);FlexDisplay(lu("Stat Rumble"),this.e_rumb,a);FlexDisplay(lu("Stat Cost"),this.e_cost,a);this.e_list_select.onchange=()=>{this.engine.SetSelectedList(this.e_list_select.options[this.e_list_select.selectedIndex].text)};this.e_select.onchange=()=>{this.engine.SetSelectedIndex(this.e_select.selectedIndex)}}UpdateEngine(a){this.engine=a}InitMountSelect(a){var b=document.createElement("SPAN");b.textContent=
lu("Engine Mounting Location");a.appendChild(b);a.appendChild(document.createElement("BR"));this.mount_select=document.createElement("SELECT");for(let c of this.engine.GetMountList())b=document.createElement("OPTION"),b.text=lu(c.name),this.mount_select.add(b);this.mount_select.required=!0;this.mount_select.selectedIndex=this.engine.GetMountIndex();this.mount_select.onchange=()=>{this.engine.SetMountIndex(this.mount_select.selectedIndex)};a.appendChild(this.mount_select);a.appendChild(document.createElement("BR"));
this.pushpull_input=document.createElement("INPUT");this.torque_input=document.createElement("INPUT");a=CreateFlexSection(a);this.pushpull_label=FlexCheckbox(" "+lu("Engine Push Pull"),this.pushpull_input,a);FlexCheckbox(" "+lu("Engine Torque To Structure"),this.torque_input,a);this.pushpull_input.checked=this.engine.GetUsePushPull();this.torque_input.checked=this.engine.GetUsePushPull();this.pushpull_input.onchange=()=>{this.engine.SetUsePushPull(this.pushpull_input.checked)};this.torque_input.onchange=
()=>{this.engine.SetTorqueToStruct(this.torque_input.checked)}}InitUpgradeSelect(a){this.ds_input=document.createElement("INPUT");this.op_input=document.createElement("INPUT");this.gp_input=document.createElement("INPUT");this.gpr_input=document.createElement("INPUT");a=CreateFlexSection(a);FlexCheckbox(lu("Engine Extended Driveshafts"),this.ds_input,a);FlexCheckbox(lu("Engine Outboard Propeller"),this.op_input,a);FlexInput(lu("Engine Geared Propeller"),this.gp_input,a);FlexInput(lu("Engine Negate Reliability Penalty"),
this.gpr_input,a);this.gp_input.onchange=()=>{this.engine.SetGearCount(this.gp_input.valueAsNumber)};this.gpr_input.onchange=()=>{this.engine.SetGearReliability(this.gpr_input.valueAsNumber)};this.ds_input.onchange=()=>{this.engine.SetUseExtendedDriveshaft(this.ds_input.checked)};this.op_input.onchange=()=>{this.engine.SetOutboardProp(this.op_input.checked)}}InitElectricSelect(a){a=CreateFlexSection(a);this.alternator_input=document.createElement("INPUT");this.generator_input=document.createElement("INPUT");
FlexCheckbox(lu("Engine Alternator"),this.alternator_input,a);FlexCheckbox(lu("Engine Generator"),this.generator_input,a);this.alternator_input.onchange=()=>{this.engine.SetAlternator(this.alternator_input.checked)};this.generator_input.onchange=()=>{this.engine.SetGenerator(this.generator_input.checked)}}InitStatDisplay(a){var b=a.insertCell();b.className="inner_table";a=document.createElement("TABLE");a.className="inner_table";b.appendChild(a);b=a.insertRow();CreateTH(b,lu("Stat Power"));CreateTH(b,
lu("Stat Mass"));CreateTH(b,lu("Stat Drag"));b=a.insertRow();this.d_powr=b.insertCell();this.d_mass=b.insertCell();this.d_drag=b.insertCell();b=a.insertRow();CreateTH(b,lu("Stat Reliability"));CreateTH(b,lu("Stat Visibility"));CreateTH(b,lu("Stat Overspeed"));b=a.insertRow();this.d_rely=b.insertCell();this.d_rely.className="part_local";this.d_visi=b.insertCell();this.d_over=b.insertCell();b=a.insertRow();CreateTH(b,lu("Stat Cost"));CreateTH(b,lu("Stat Altitude"));CreateTH(b,lu("Stat Fuel Consumption"));
b=a.insertRow();this.d_cost=b.insertCell();this.d_alti=b.insertCell();this.d_fuel=b.insertCell();b=a.insertRow();CreateTH(b,lu("Stat Pitch Stability"));CreateTH(b,lu("Stat Lateral Stability"));CreateTH(b,lu("Stat Raw Strain"));b=a.insertRow();this.d_pstb=b.insertCell();this.d_lstb=b.insertCell();this.d_maxs=b.insertCell();b=a.insertRow();CreateTH(b,lu("Stat Structure"));CreateTH(b,lu("Stat Flight Stress"));CreateTH(b,lu("Stat Required Sections"));b=a.insertRow();this.d_strc=b.insertCell();this.d_fstr=
b.insertCell();this.d_sect=b.insertCell();b=a.insertRow();CreateTH(b,lu("Stat Charge"));CreateTH(b,"");CreateTH(b,"");a=a.insertRow();this.d_chrg=a.insertCell();a.insertCell();a.insertCell()}InitCowlSelect(a){this.cowl_select=document.createElement("SELECT");for(let b of this.engine.GetCowlList()){let c=document.createElement("OPTION");c.text=lu(b.name);this.cowl_select.add(c)}this.cowl_select.required=!0;this.cowl_select.selectedIndex=this.engine.GetMountIndex();this.cowl_select.onchange=()=>{this.engine.SetCowl(this.cowl_select.selectedIndex)};
a.appendChild(this.cowl_select)}InitCoolingSelect(){for(;0<this.cool_cell.children.length;)this.cool_cell.removeChild(this.cool_cell.children[0]);if(this.engine.IsRotary()){this.e_cool.textContent="0";var a=document.createElement("SPAN");a.innerText=lu("Engine Rotary Cooling");this.cool_cell.appendChild(a)}else if("0"==this.e_cool.textContent)a=document.createElement("SPAN"),a.textContent=lu("Engine Air-Cooled Engine."),this.cool_cell.appendChild(a),a=CreateFlexSection(this.cool_cell),FlexCheckbox(lu("Engine Air Cooling Fan"),
this.intake_fan,a),this.intake_fan.disabled=!this.engine.CanIntakeFan();else{this.cool_select||(this.cool_select=document.createElement("SELECT"),this.cool_select.required=!0);a=CreateFlexSection(this.cool_cell);FlexSelect(lu("Engine Select Radiator"),this.cool_select,a);FlexInput(lu("Engine Cooling Amount"),this.cool_count,a);for(a=this.engine.GetNumRadiators();0<this.cool_select.options.length;)this.cool_select.options.remove(this.cool_select.options.length-1);for(let b=1;b<a+1;b++){let c=document.createElement("OPTION");
c.textContent=lu("Vital Part Radiator",b);this.cool_select.add(c)}this.cool_select.onchange=()=>{this.engine.SetRadiator(this.cool_select.selectedIndex)};this.cool_select.selectedIndex=this.engine.GetRadiator();this.cool_count.min="0";this.cool_count.max=this.engine.GetMaxCooling().toString();this.cool_count.valueAsNumber=this.engine.GetCooling();this.cool_count.onchange=()=>{this.engine.SetCooling(this.cool_count.valueAsNumber)}}}UpdateDisplay(){for(;0<this.e_list_select.options.length;)this.e_list_select.options.remove(this.e_list_select.options.length-
1);for(;0<this.e_select.options.length;)this.e_select.options.remove(this.e_select.options.length-1);var a=this.engine.GetSelectedList();if(""!=a){var b=!1,c=0;for(e of engine_list.keys()){var d=document.createElement("OPTION");d.text=e;this.e_list_select.add(d);e==a||b?(c=Math.abs(c),b=!0):--c}this.e_list_select.selectedIndex=c;var e=this.engine.CanSelectIndex();for(b=0;b<engine_list.get(a).length;b++)c=engine_list.get(a).get(b),d=document.createElement("OPTION"),d.text=c.name,d.disabled=!e[b],this.e_select.add(d);
this.e_select.selectedIndex=this.engine.GetSelectedIndex()}else{for(b of engine_list.keys())a=document.createElement("OPTION"),a.text=b,this.e_list_select.add(a);this.e_list_select.selectedIndex=-1;a=this.engine.GetCurrentStats();e=document.createElement("OPTION");e.text=a.name;this.e_select.add(e);this.e_select.selectedIndex=0}b=this.engine.GetCurrentStats();switch(b.rarity){case ENGINE_RARITY.CUSTOM:this.e_rarity.textContent=lu("Rarity Custom");this.e_rarity.className="ER_Custom";break;case ENGINE_RARITY.COMMON:this.e_rarity.textContent=
lu("Rarity Common");this.e_rarity.className="";break;case ENGINE_RARITY.RARE:this.e_rarity.textContent=lu("Rarity Rare");this.e_rarity.className="ER_Rare";break;case ENGINE_RARITY.LEGENDARY:this.e_rarity.textContent=lu("Rarity Legendary"),this.e_rarity.className="ER_Legendary"}a=this.engine.GetMinAltitude();e=this.engine.GetMaxAltitude();this.e_pwr.textContent=b.stats.power.toString();this.e_mass.textContent=b.stats.mass.toString();this.e_drag.textContent=b.stats.drag.toString();this.e_rely.textContent=
b.stats.reliability.toString();this.e_cool.textContent=b.stats.cooling.toString();this.e_over.textContent=b.overspeed.toString();this.e_fuel.textContent=b.stats.fuelconsumption.toString();this.e_alti.textContent=a.toString()+"-"+e.toString();this.e_torq.textContent=b.torque.toString();this.e_rumb.textContent=b.rumble.toString();this.e_cost.textContent=b.stats.cost.toString();this.InitCoolingSelect();this.intake_fan.checked=this.engine.GetIntakeFan();this.mount_select.selectedIndex=this.engine.GetMountIndex();
this.engine.GetIsTurbine()?this.pushpull_label.textContent=" "+lu("Engine Side-by-Side"):this.pushpull_label.textContent=" "+lu("Engine Push Pull");this.pushpull_input.checked=this.engine.GetUsePushPull();this.pushpull_input.disabled=!this.engine.CanUsePushPull();this.torque_input.checked=this.engine.GetTorqueToStruct();this.torque_input.checked=this.engine.GetTorqueToStruct();this.torque_input.disabled=!this.engine.CanTorqueToStruct();this.ds_input.checked=this.engine.GetUseExtendedDriveshaft();
this.ds_input.disabled=!this.engine.CanUseExtendedDriveshaft();this.op_input.checked=this.engine.GetOutboardProp();this.op_input.disabled=!this.engine.CanOutboardProp();this.gp_input.valueAsNumber=this.engine.GetGearCount();this.gp_input.disabled=!this.engine.CanUseGears();this.gpr_input.valueAsNumber=this.engine.GetGearReliability();this.gpr_input.disabled=!this.engine.CanUseGears();if(b.pulsejet){this.mount_select.disabled=!0;this.mount_select.selectedIndex=-1;for(b=0;b<this.mount_select.options.length;b++)"fuselage"==
this.mount_select.options[b].value&&(this.mount_select.options[b].disabled=!0);this.cowl_select.disabled=!0;this.alternator_input.disabled=!0;this.generator_input.disabled=!0}else{this.mount_select.disabled=!1;b=this.engine.CanMountIndex();for(c=0;c<this.mount_select.options.length;c++)this.mount_select.options[c].disabled=!b[c];this.cowl_select.disabled=!1;this.alternator_input.disabled=!1;this.generator_input.disabled=!1}this.cowl_select.selectedIndex=this.engine.GetCowl();b=this.engine.GetCowlEnabled();
for(c=0;c<b.length;c++)this.cowl_select.options[c].disabled=!b[c];this.generator_input.checked=this.engine.GetGenerator();this.generator_input.disabled=!this.engine.GetGeneratorEnabled();this.alternator_input.checked=this.engine.GetAlternator();this.alternator_input.disabled=!this.engine.GetAlternatorEnabled();b=this.engine.PartStats();BlinkIfChanged(this.d_powr,b.power.toString(),!0);BlinkIfChanged(this.d_mass,b.mass.toString(),!1);BlinkIfChanged(this.d_drag,b.drag.toString(),!1);BlinkIfChanged(this.d_rely,
this.engine.GetReliability().toString(),!0);BlinkIfChanged(this.d_visi,b.visibility.toString(),!0);BlinkIfChanged(this.d_over,this.engine.GetOverspeed().toString(),!0);BlinkIfChanged(this.d_cost,b.cost.toString(),!1);BlinkIfChanged(this.d_alti,a.toString()+"-"+e.toString());BlinkIfChanged(this.d_fuel,b.fuelconsumption.toString(),!1);BlinkIfChanged(this.d_pstb,b.pitchstab.toString(),!0);BlinkIfChanged(this.d_lstb,b.latstab.toString(),!0);BlinkIfChanged(this.d_maxs,b.maxstrain.toString(),!0);BlinkIfChanged(this.d_strc,
b.structure.toString(),!0);BlinkIfChanged(this.d_fstr,b.flightstress.toString(),!1);BlinkIfChanged(this.d_sect,b.reqsections.toString(),!1);BlinkIfChanged(this.d_chrg,b.charge.toString(),!0)}}
class Radiator_HTML extends Display{constructor(a,b){super();this.radiator=b;b=a.insertCell();this.type_select=document.createElement("SELECT");for(var c of this.radiator.GetTypeList()){let f=document.createElement("OPTION");f.text=lu(c.name);this.type_select.add(f)}this.type_select.onchange=()=>{this.radiator.SetTypeIndex(this.type_select.selectedIndex)};b.appendChild(this.type_select);c=a.insertCell();this.mount_select=document.createElement("SELECT");for(var d of this.radiator.GetMountList())b=
document.createElement("OPTION"),b.text=lu(d.name),this.mount_select.add(b);this.mount_select.onchange=()=>{this.radiator.SetMountIndex(this.mount_select.selectedIndex)};c.appendChild(this.mount_select);d=a.insertCell();this.coolant_select=document.createElement("SELECT");for(var e of this.radiator.GetCoolantList())c=document.createElement("OPTION"),c.text=lu(e.name),this.coolant_select.add(c);this.coolant_select.onchange=()=>{this.radiator.SetCoolantIndex(this.coolant_select.selectedIndex)};d.appendChild(this.coolant_select);
d.appendChild(document.createElement("BR"));this.harden_input=document.createElement("INPUT");e=CreateFlexSection(d);FlexCheckbox(lu("Radiators Harden Radiator"),this.harden_input,e);this.harden_input.onchange=()=>{this.radiator.SetHarden(this.harden_input.checked)};a=a.insertCell();e=document.createElement("TABLE");a.className="inner_table";e.className="inner_table";d=e.insertRow();CreateTH(d,lu("Stat Mass"));CreateTH(d,lu("Stat Cost"));CreateTH(d,lu("Stat Drag"));CreateTH(d,lu("Stat Reliability"));
CreateTH(d,lu("Stat Lateral Stability"));CreateTH(d,lu("Derived Is Flammable Question"));d=e.insertRow();this.c_mass=d.insertCell();this.c_cost=d.insertCell();this.c_drag=d.insertCell();this.c_rely=d.insertCell();this.c_lstb=d.insertCell();this.c_flam=d.insertCell();a.appendChild(e)}UpdateRadiator(a){this.radiator=a}UpdateDisplay(){for(var a=this.radiator.CanType(),b=0;b<a.length;b++)this.type_select.options[b].disabled=!a[b];this.type_select.selectedIndex=this.radiator.GetTypeIndex();this.mount_select.selectedIndex=
this.radiator.GetMountIndex();a=this.radiator.CanMount();for(b=0;b<a.length;b++)this.mount_select.options[b].disabled=!a[b];this.coolant_select.selectedIndex=this.radiator.GetCoolantIndex();this.harden_input.checked=this.radiator.GetHarden();a=this.radiator.PartStats();BlinkIfChanged(this.c_mass,a.mass.toString(),!1);BlinkIfChanged(this.c_cost,a.cost.toString(),!1);BlinkIfChanged(this.c_drag,a.drag.toString(),!1);BlinkIfChanged(this.c_rely,a.reliability.toString(),!0);BlinkIfChanged(this.c_lstb,a.latstab.toString(),
!0);this.radiator.GetIsFlammable()?BlinkIfChanged(this.c_flam,lu("Yes")):BlinkIfChanged(this.c_flam,lu("No"))}}
class Engines_HTML extends Display{constructor(a){super();this.eng=a;this.engines=[];this.radiators=[];document.getElementById("lbl_engines").textContent=lu("Engines Section Title");this.tbl=document.getElementById("table_engine");a=document.createDocumentFragment();var b=insertRow(a);CreateTH(b,lu("Engines Engine Type"));CreateTH(b,lu("Engines Options"));CreateTH(b,lu("Engines Options 2"));CreateTH(b,lu("Engines Engine Stats"));this.tbl.appendChild(a);a=document.createDocumentFragment();this.tblR=
document.getElementById("table_radiator");b=insertRow(a);CreateTH(b,lu("Radiators Radiator Type"));CreateTH(b,lu("Radiators Mounting"));CreateTH(b,lu("Radiators Coolant"));CreateTH(b,lu("Radiators Radiator Stats"));this.tblR.appendChild(a);document.getElementById("lbl_num_engines").textContent=lu("Engines Num Engines");this.num_engines=document.getElementById("num_engines");this.num_engines.onchange=()=>{this.eng.SetNumberOfEngines(this.num_engines.valueAsNumber)};this.num_engines.valueAsNumber=this.eng.GetNumberOfItems();
document.getElementById("lbl_num_radiators").textContent=lu("Engines Num Radiators");this.num_radiators=document.getElementById("num_radiators");this.num_radiators.onchange=()=>{this.eng.SetNumberOfRadiators(this.num_radiators.valueAsNumber)};this.num_radiators.valueAsNumber=this.eng.GetNumberOfRadiators();document.getElementById("lbl_asymmetric").textContent=lu("Engines Asymmetric Plane");this.is_asymmetric=document.getElementById("asymmetric");this.is_asymmetric.onchange=()=>{this.eng.SetAsymmetry(this.is_asymmetric.checked)};
this.is_asymmetric.checked=this.eng.GetAsymmetry()}UpdateDisplay(){var a=this.eng.GetNumberOfItems();this.tbl.style.display=0==a?"none":"";for(this.num_engines.valueAsNumber=a;this.engines.length>a;)this.engines.pop(),this.tbl.deleteRow(this.engines.length+1);for(var b=document.createDocumentFragment();this.engines.length<a;){var c=this.eng.GetEngine(this.engines.length);c=new Engine_HTML(c,insertRow(b));this.engines.push(c)}this.tbl.appendChild(b);for(b=0;b<a;b++)this.engines[b].UpdateEngine(this.eng.GetEngine(b));
a=this.eng.GetNumberOfRadiators();this.num_radiators.valueAsNumber=a;for(0==a?(this.tblR.style.display="none",this.num_radiators.disabled=!0):(this.tblR.style.display="",this.num_radiators.disabled=!1);this.radiators.length>a;)this.radiators.pop(),this.tblR.deleteRow(this.radiators.length+1);for(b=document.createDocumentFragment();this.radiators.length<a;)c=new Radiator_HTML(insertRow(b),this.eng.GetRadiator(this.radiators.length)),this.radiators.push(c);this.tblR.appendChild(b);for(b=0;b<a;b++)this.radiators[b].UpdateRadiator(this.eng.GetRadiator(b));
this.is_asymmetric.checked=this.eng.GetAsymmetry();for(let d of this.engines)d.UpdateDisplay();for(let d of this.radiators)d.UpdateDisplay()}}
class Propeller_HTML extends Display{constructor(a){super();this.prop=a;document.getElementById("lbl_propeller").textContent=lu("Propeller Section Title");document.getElementById("lbl_propeller_pitch").textContent=lu("Propeller Propeller Pitch");this.select_prop=document.getElementById("propeller_pitch");for(let b of a.GetPropList()){let c=document.createElement("OPTION");c.text=lu(b.name);this.select_prop.add(c)}this.select_prop.onchange=()=>{this.prop.SetPropIndex(this.select_prop.selectedIndex)};
document.getElementById("lbl_propeller_upgrade").textContent=lu("Propeller Propeller Upgrades:");this.select_upgrade=document.getElementById("propeller_upgrade");for(let b of a.GetUpgradeList())a=document.createElement("OPTION"),a.text=lu(b.name),this.select_upgrade.add(a);this.select_upgrade.onchange=()=>{this.prop.SetUpgradeIndex(this.select_upgrade.selectedIndex)}}UpdateDisplay(){this.select_upgrade.selectedIndex=this.prop.GetUpgradeIndex();this.select_prop.selectedIndex=this.prop.GetPropIndex();
0==this.prop.GetNumPropellers()?(this.select_upgrade.disabled=!0,this.select_prop.disabled=!0,this.select_prop.selectedIndex=-1):(this.select_prop.disabled=!1,this.select_upgrade.disabled=!1)}}
class Frames_HTML extends Display{constructor(a){super();this.c_sec=[];this.t_sec=[];this.frames=a;document.getElementById("lbl_frames").textContent=lu("Frames Frames and Covering");this.table=document.getElementById("table_frames");a=document.createDocumentFragment();var b=insertRow(a);this.all_frame=document.createElement("SELECT");this.all_skin=document.createElement("SELECT");CreateTH(b,lu("Frames Frame Type")).append(document.createElement("BR"),this.all_frame);CreateTH(b,lu("Frames Skin Type")).append(document.createElement("BR"),
this.all_skin);CreateTH(b,lu("Frames Frame Options"));CreateTH(b,lu("Frames Frame Stats"));b=insertRow(a);this.c_frame=b.insertCell();this.c_skin=b.insertCell();this.c_options=b.insertCell();this.c_stats=b.insertCell();this.c_stats.className="inner_table";this.c_stats.rowSpan=0;b=document.createElement("TABLE");b.className="inner_table";var c=b.insertRow();CreateTH(c,lu("Stat Mass"));CreateTH(c,lu("Stat Drag"));CreateTH(c,lu("Stat Cost"));c=b.insertRow();this.d_mass=c.insertCell();this.d_drag=c.insertCell();
this.d_cost=c.insertCell();c=b.insertRow();CreateTH(c,lu("Stat Structure"));CreateTH(c,lu("Stat Toughness"));CreateTH(c,lu("Stat Visibility"));c=b.insertRow();this.d_strc=c.insertCell();this.d_tugh=c.insertCell();this.d_visi=c.insertCell();c=b.insertRow();CreateTH(c,lu("Stat Wing Area"));CreateTH(c,lu("Derived Is Flammable Question"));CreateTH(c,lu("Stat Pitch Stability"));c=b.insertRow();this.d_area=c.insertCell();this.d_flammable=c.insertCell();this.d_pstb=c.insertCell();c=b.insertRow();CreateTH(c,
lu("Stat Raw Strain"));CreateTH(c,lu("Stat Lift Bleed"));CreateTH(c,"");c=b.insertRow();this.d_strn=c.insertCell();this.d_lift=c.insertCell();c.insertCell();this.c_stats.appendChild(b);b=insertRow(a);CreateTH(b,lu("Frames Tail Frame Type"));CreateTH(b,lu("Frames Tail Skin Type"));CreateTH(b,lu("Frames Tail Frame Options"));b=insertRow(a);this.t_frame=b.insertCell();this.t_skin=b.insertCell();this.t_options=b.insertCell();document.getElementById("lbl_tail").textContent=lu("Frames Tail Section Title");
document.getElementById("lbl_tail_type").textContent=lu("Frames Tail Type");this.t_select=document.getElementById("tail_type");document.getElementById("lbl_tail_farman").textContent=lu("Frames Tail Farman");this.t_farman=document.getElementById("tail_farman");document.getElementById("lbl_tail_boom").textContent=lu("Frames Tail Boom");this.t_boom=document.getElementById("tail_boom");document.getElementById("lbl_flying_wing").textContent=lu("Frames Flying Wing");this.t_fwing=document.getElementById("flying_wing");
b=this.frames.GetFrameList();for(var d of b)b=document.createElement("OPTION"),b.text=lu(d.name),0>=d.basestruct&&(b.disabled=!0),this.all_frame.add(b);this.all_frame.onchange=()=>{this.frames.SetAllFrame(this.all_frame.selectedIndex)};d=this.frames.GetSkinList();for(var e of d)d=document.createElement("OPTION"),d.text=lu(e.name),this.all_skin.add(d);this.all_skin.onchange=()=>{this.frames.SetAllSkin(this.all_skin.selectedIndex)};for(let f of this.frames.GetTailList())e=document.createElement("OPTION"),
e.text=lu(f.name),this.t_select.add(e);this.t_select.onchange=()=>{this.frames.SetTailType(this.t_select.selectedIndex)};this.t_farman.onchange=()=>{this.frames.SetUseFarman(this.t_farman.checked)};this.t_boom.onchange=()=>{this.frames.SetUseBoom(this.t_boom.checked)};this.t_fwing.onchange=()=>{this.frames.SetFlyingWing(this.t_fwing.checked)};this.table.appendChild(a)}UpdateDisplay(){for(var a=document.createDocumentFragment();this.table.children.length;)a.append(this.table.children[0]);for(var b=
this.frames.GetSectionList(),c=this.frames.GetTailSectionList();b.length>this.c_sec.length;){var d=this.c_sec.length;this.CreateSection(d,b[d])}for(;b.length<this.c_sec.length;)this.RemoveSection();for(;c.length>this.t_sec.length;)d=this.t_sec.length,this.CreateTailSection(d,c[d]);for(;c.length<this.t_sec.length;)this.RemoveTailSection();d=this.frames.GetSkinList()[this.frames.GetSkin()].flammable;for(let e=0;e<b.length;e++)this.UpdateSection(e,b[e]);this.t_select.selectedIndex=this.frames.GetTailType();
this.t_farman.disabled=this.frames.GetUseBoom()||this.frames.GetIsTailless();this.t_farman.checked=this.frames.GetUseFarman();this.t_boom.disabled=this.frames.GetUseFarman()||this.frames.GetIsTailless();this.t_boom.checked=this.frames.GetUseBoom();this.t_fwing.disabled=!this.frames.CanFlyingWing();this.t_fwing.checked=this.frames.GetFlyingWing();this.all_frame.selectedIndex=-1;this.all_skin.selectedIndex=this.frames.GetSkin();for(b=0;b<c.length;b++)this.UpdateTailSection(b,c[b]);d?BlinkIfChanged(this.d_flammable,
lu("Yes")):BlinkIfChanged(this.d_flammable,lu("No"));c=this.frames.PartStats();BlinkIfChanged(this.d_mass,c.mass.toString(),!1);BlinkIfChanged(this.d_drag,c.drag.toString(),!1);BlinkIfChanged(this.d_cost,c.cost.toString(),!1);BlinkIfChanged(this.d_strc,c.structure.toString(),!0);BlinkIfChanged(this.d_tugh,c.toughness.toString(),!0);BlinkIfChanged(this.d_visi,c.visibility.toString(),!0);BlinkIfChanged(this.d_area,c.wingarea.toString(),!0);BlinkIfChanged(this.d_pstb,c.pitchstab.toString(),!0);BlinkIfChanged(this.d_strn,
c.maxstrain.toString(),!0);BlinkIfChanged(this.d_lift,c.liftbleed.toString(),!1);this.table.appendChild(a)}CreateSection(a,b){var c={fspan:document.createElement("SPAN"),rem:document.createElement("BUTTON"),add:document.createElement("BUTTON"),fsel:document.createElement("SELECT"),sspan:document.createElement("SPAN"),ssel:document.createElement("LABEL"),ospan:document.createElement("SPAN"),geo:document.createElement("INPUT"),mono:document.createElement("INPUT"),int:document.createElement("INPUT"),
lb:document.createElement("INPUT")};c.rem.textContent="-";c.rem.onclick=()=>{this.frames.DeleteSection(a)};c.add.textContent="+";c.add.onclick=()=>{this.frames.DuplicateSection(a)};var d=this.frames.GetFrameList();for(let e of d)d=document.createElement("OPTION"),d.text=lu(e.name),c.fsel.add(d);c.fsel.onchange=()=>{this.frames.SetFrame(a,c.fsel.selectedIndex)};c.fspan.appendChild(c.rem);c.fspan.appendChild(c.add);c.fspan.appendChild(c.fsel);c.fspan.appendChild(document.createElement("BR"));this.c_frame.appendChild(c.fspan);
c.sspan.appendChild(c.ssel);c.sspan.appendChild(document.createElement("BR"));this.c_skin.appendChild(c.sspan);CreateCheckbox(lu("Frames Geodesic"),c.geo,c.ospan,!1);c.geo.onchange=()=>{this.frames.SetGeodesic(a,c.geo.checked)};CreateCheckbox(lu("Frames Monocoque"),c.mono,c.ospan,!1);c.mono.onchange=()=>{this.frames.SetMonocoque(a,c.mono.checked)};CreateCheckbox(lu("Frames Internal Bracing"),c.int,c.ospan,!1);c.int.onchange=()=>{this.frames.SetInternalBracing(a,c.int.checked)};CreateCheckbox(lu("Frames Lifting Body"),
c.lb,c.ospan,!0);c.lb.onchange=()=>{this.frames.SetLiftingBody(a,c.lb.checked)};this.c_options.appendChild(c.ospan);this.c_sec.push(c);this.UpdateSection(a,b)}RemoveSection(){var a=this.c_sec.pop();this.c_frame.removeChild(a.fspan);this.c_skin.removeChild(a.sspan);this.c_options.removeChild(a.ospan)}UpdateSection(a,b){var c=this.c_sec[a];c.rem.disabled=!b.internal_bracing&&!this.frames.PossibleRemoveSections();c.add.disabled=b.internal_bracing&&!this.frames.PossibleInternalBracing();var d=this.frames.GetFrameList();
for(let e=0;e<d.length;e++){let f=d[e],g=c.fsel.options[e];g.text=lu(f.name);g.disabled=!1;b.geodesic&&!f.geodesic&&(g.disabled=!0);b.internal_bracing||0!=f.basestruct||(g.disabled=!0)}c.fsel.selectedIndex=b.frame;b.internal_bracing?c.ssel.textContent=lu("Frames No Skin"):(d=this.frames.GetSkinList(),c.ssel.textContent=lu(d[this.frames.GetSkin()].name));c.geo.checked=b.geodesic;c.geo.disabled=!this.frames.PossibleGeodesic(a);c.mono.checked=b.monocoque;c.mono.disabled=!this.frames.PossibleMonocoque(a);
(c.int.checked=b.internal_bracing)||this.frames.PossibleInternalBracing(!0)&&this.frames.PossibleRemoveSections()?c.int.disabled=!1:c.int.disabled=!0;c.lb.checked=b.lifting_body;c.lb.disabled=!this.frames.PossibleLiftingBody(a)}CreateTailSection(a,b){var c={fspan:document.createElement("SPAN"),fsel:document.createElement("SELECT"),sspan:document.createElement("SPAN"),ssel:document.createElement("LABEL"),ospan:document.createElement("SPAN"),geo:document.createElement("INPUT"),mono:document.createElement("INPUT"),
lb:document.createElement("INPUT")},d=this.frames.GetFrameList();for(let e of d)d=document.createElement("OPTION"),d.text=lu(e.name),c.fsel.add(d);c.fsel.onchange=()=>{this.frames.SetTailFrame(a,c.fsel.selectedIndex)};c.fspan.appendChild(c.fsel);c.fspan.appendChild(document.createElement("BR"));this.t_frame.appendChild(c.fspan);c.sspan.appendChild(c.ssel);c.sspan.appendChild(document.createElement("BR"));this.t_skin.appendChild(c.sspan);CreateCheckbox(lu("Frames Geodesic"),c.geo,c.ospan,!1);c.geo.onchange=
()=>{this.frames.SetTailGeodesic(a,c.geo.checked)};CreateCheckbox(lu("Frames Monocoque"),c.mono,c.ospan,!1);c.mono.onchange=()=>{this.frames.SetTailMonocoque(a,c.mono.checked)};CreateCheckbox(lu("Frames Lifting Body"),c.lb,c.ospan,!0);c.lb.onchange=()=>{this.frames.SetTailLiftingBody(a,c.lb.checked)};this.t_options.appendChild(c.ospan);this.t_sec.push(c);this.UpdateTailSection(a,b)}RemoveTailSection(){var a=this.t_sec.pop();this.t_frame.removeChild(a.fspan);this.t_skin.removeChild(a.sspan);this.t_options.removeChild(a.ospan)}UpdateTailSection(a,
b){for(var c=this.t_sec[a],d=this.frames.GetFrameList(),e=0;e<d.length;e++){let f=d[e],g=c.fsel.options[e];g.text=lu(f.name);g.disabled=!1;b.geodesic&&!f.geodesic&&(g.disabled=!0);b.internal_bracing||0!=f.basestruct||(g.disabled=!0)}c.fsel.selectedIndex=b.frame;d=this.frames.GetSkinList();e=this.frames.GetSkin();this.frames.GetUseFarman()&&(e=0);c.ssel.textContent=lu(d[e].name);c.geo.checked=b.geodesic;c.geo.disabled=!this.frames.PossibleTailGeodesic(a);c.mono.checked=b.monocoque;c.mono.disabled=
!this.frames.PossibleTailMonocoque(a);c.lb.checked=b.lifting_body;c.lb.disabled=!this.frames.PossibleTailLiftingBody(a)}}
class Wings_HTML extends Display{constructor(a){super();this.wings=a;this.fw_list=[];this.mw_list=[];document.getElementById("lbl_wings").textContent=lu("Wings Section Title");document.getElementById("lbl_wing_stagger").textContent=lu("Wings Wing Stagger");this.stagger=document.getElementById("wing_stagger");document.getElementById("lbl_wing_closed").textContent=lu("Wings Closed Wing");this.closed=document.getElementById("wing_closed");document.getElementById("lbl_wing_swept").textContent=lu("Wings Swept Wing");
this.swept=document.getElementById("wing_swept");for(var b of a.GetStaggerList())a=document.createElement("OPTION"),a.textContent=lu(b.name),this.stagger.append(a);this.stagger.onchange=()=>{this.wings.SetStagger(this.stagger.selectedIndex)};this.closed.onchange=()=>{this.wings.SetClosed(this.closed.checked)};this.swept.onchange=()=>{this.wings.SetSwept(this.swept.checked)};b=document.getElementById("wing_table");a=document.createDocumentFragment();var c=insertRow(a);CreateTH(c,lu("Wings Wing Type"));
CreateTH(c,lu("Wings Wing Options"));CreateTH(c,lu("Wings Wing Stats"));c=insertRow(a);CreateTH(c,lu("Wings Full Wings"));var d=insertRow(a);CreateTH(d,lu("Wings Miniature Wings"));this.full_cell=c.insertCell();this.mini_cell=d.insertCell();c=c.insertCell();c.rowSpan=0;this.InitStatDisplay(c);b.appendChild(a)}InitStatDisplay(a){a.className="inner_table";var b=document.createElement("TABLE");b.className="inner_table";a.appendChild(b);a=b.insertRow();CreateTH(a,lu("Stat Wing Area"));CreateTH(a,lu("Stat Mass"));
CreateTH(a,lu("Stat Drag"));a=b.insertRow();this.d_area=a.insertCell();this.d_mass=a.insertCell();this.d_drag=a.insertCell();a=b.insertRow();CreateTH(a,lu("Stat Control"));CreateTH(a,lu("Stat Pitch Stability"));CreateTH(a,lu("Stat Lateral Stability"));a=b.insertRow();this.d_cont=a.insertCell();this.d_pstb=a.insertCell();this.d_lstb=a.insertCell();a=b.insertRow();CreateTH(a,lu("Stat Raw Strain"));CreateTH(a,lu("Stat Crash Safety"));CreateTH(a,lu("Stat Lift Bleed"));a=b.insertRow();this.d_maxs=a.insertCell();
this.d_crsh=a.insertCell();this.d_lift=a.insertCell();a=b.insertRow();CreateTH(a,lu("Stat Cost"));CreateTH(a,lu("Stat Visibility"));CreateTH(a,lu("Stat Charge"));a=b.insertRow();this.d_cost=a.insertCell();this.d_visi=a.insertCell();this.d_chrg=a.insertCell();a=b.insertRow();CreateTH(a,"");CreateTH(a,lu("Wings Sesquiplane"));CreateTH(a,lu("Derived Is Flammable Question"));b=b.insertRow();b.insertCell();this.d_sesq=b.insertCell();this.d_flam=b.insertCell()}UpdateDisplay(){for(var a=this.wings.CanStagger(),
b=0;b<a.length;b++)this.stagger.options[b].disabled=!a[b];this.stagger.selectedIndex=this.wings.GetStagger();this.closed.checked=this.wings.GetClosed();this.closed.disabled=!this.wings.CanClosed();this.swept.checked=this.wings.GetSwept();this.swept.disabled=!this.wings.CanSwept();this.fw_add&&this.full_cell.removeChild(this.fw_add);this.mw_add&&this.mini_cell.removeChild(this.mw_add);a=this.wings.GetWingList();for(b=0;b<a.length;b++)this.fw_list.length==b&&this.AddFullWing(),this.UpdateFullWing(this.fw_list[b],
b,a[b]);for(;this.fw_list.length>a.length;)this.PopFullWing();b=this.wings.GetMiniWingList();for(let c=0;c<b.length;c++)this.mw_list.length==c&&this.AddMiniWing(),this.UpdateMiniWing(this.mw_list[c],c,b[c]);for(;this.mw_list.length>b.length;)this.PopMiniWing();this.CreateFWAdd(a.length);this.CreateMWAdd(b.length);a=this.wings.PartStats();BlinkIfChanged(this.d_area,a.wingarea.toString(),!0);BlinkIfChanged(this.d_mass,(a.mass+this.wings.GetPaperMass()).toString(),!1);BlinkIfChanged(this.d_drag,a.drag.toString(),
!1);BlinkIfChanged(this.d_cont,a.control.toString(),!0);BlinkIfChanged(this.d_pstb,a.pitchstab.toString(),!0);BlinkIfChanged(this.d_lstb,a.latstab.toString(),!0);BlinkIfChanged(this.d_maxs,a.maxstrain.toString(),!0);BlinkIfChanged(this.d_lift,a.liftbleed.toString(),!1);BlinkIfChanged(this.d_crsh,a.crashsafety.toString(),!0);BlinkIfChanged(this.d_cost,a.cost.toString(),!1);BlinkIfChanged(this.d_visi,a.visibility.toString(),!0);BlinkIfChanged(this.d_chrg,a.charge.toString(),!0);this.wings.GetIsSesquiplane().is?
BlinkIfChanged(this.d_sesq,lu("Yes")):BlinkIfChanged(this.d_sesq,lu("No"));this.wings.IsFlammable()?BlinkIfChanged(this.d_flam,lu("Yes")):BlinkIfChanged(this.d_flam,lu("No"))}AddFullWing(){var a={span:document.createElement("SPAN"),deck:document.createElement("SELECT"),skin:document.createElement("SELECT"),area:document.createElement("INPUT"),wspan:document.createElement("INPUT"),gull:document.createElement("INPUT"),dihedral:document.createElement("INPUT"),anhedral:document.createElement("INPUT"),
br:document.createElement("BR")};a.span.appendChild(a.deck);var b=this.wings.GetDeckList(),c=document.createElement("OPTION");c.textContent=lu("Wings No Wing");a.deck.append(c);for(c=0;c<b.length;c++){let d=b[c],e=document.createElement("OPTION");e.textContent=lu(d.name);a.deck.append(e)}a.span.appendChild(a.skin);for(let d of this.wings.GetSkinList())b=document.createElement("OPTION"),b.textContent=lu(d.name),a.skin.append(b);CreateInput(lu("Wings Area"),a.area,a.span,!1);a.area.min="3";CreateInput(lu("Wings Span"),
a.wspan,a.span,!1);a.wspan.min="1";CreateCheckbox(lu("Wings Gull"),a.gull,a.span,!1);CreateInput(lu("Wings Dihedral"),a.dihedral,a.span,!1);a.dihedral.min="0";CreateInput(lu("Wings Anhedral"),a.anhedral,a.span,!1);a.anhedral.min="0";this.full_cell.appendChild(a.span);this.full_cell.appendChild(a.br);this.fw_list.push(a)}PopFullWing(){var a=this.fw_list.pop();this.full_cell.removeChild(a.span);this.full_cell.removeChild(a.br)}UpdateFullWing(a,b,c){for(let d=1;d<a.deck.options.length;d++){let e=a.deck.options[d];
c.deck==d-1||this.wings.CanAddFullWing(d-1)||this.wings.CanMoveFullWing(b,d-1)?e.disabled=!1:e.disabled=!0}a.deck.onchange=()=>{let d=Object.assign({},c);d.deck=a.deck.selectedIndex-1;this.wings.SetFullWing(b,d)};a.deck.selectedIndex=c.deck+1;a.skin.onchange=()=>{let d=Object.assign({},c);d.surface=a.skin.selectedIndex;this.wings.SetFullWing(b,d)};a.skin.selectedIndex=c.surface;a.area.onchange=()=>{let d=Object.assign({},c);d.area=a.area.valueAsNumber;this.wings.SetFullWing(b,d)};a.area.valueAsNumber=
c.area;a.wspan.onchange=()=>{let d=Object.assign({},c);d.span=a.wspan.valueAsNumber;this.wings.SetFullWing(b,d)};a.wspan.valueAsNumber=c.span;a.gull.onchange=()=>{let d=Object.assign({},c);d.gull=a.gull.checked;this.wings.SetFullWing(b,d)};a.gull.checked=c.gull;a.gull.disabled=!this.wings.CanGull(c.deck);a.dihedral.onchange=()=>{let d=Object.assign({},c);d.dihedral=a.dihedral.valueAsNumber;this.wings.SetFullWing(b,d)};a.dihedral.max=(c.span-c.anhedral-1).toString();a.dihedral.valueAsNumber=c.dihedral;
a.anhedral.onchange=()=>{let d=Object.assign({},c);d.anhedral=a.anhedral.valueAsNumber;this.wings.SetFullWing(b,d)};a.anhedral.max=(c.span-c.dihedral-1).toString();a.anhedral.valueAsNumber=c.anhedral}AddMiniWing(){var a={span:document.createElement("SPAN"),deck:document.createElement("SELECT"),skin:document.createElement("SELECT"),area:document.createElement("INPUT"),wspan:document.createElement("INPUT"),gull:void 0,dihedral:void 0,anhedral:void 0,br:document.createElement("BR")};a.span.appendChild(a.deck);
var b=this.wings.GetDeckList(),c=document.createElement("OPTION");c.textContent=lu("Wings No Wing");a.deck.append(c);for(c=0;c<b.length;c++){let d=b[c],e=document.createElement("OPTION");e.textContent=lu(d.name);a.deck.append(e)}a.span.appendChild(a.skin);for(let d of this.wings.GetSkinList())b=document.createElement("OPTION"),b.textContent=lu(d.name),a.skin.append(b);CreateInput(lu("Wings Area"),a.area,a.span,!1);a.area.min="1";a.area.max="2";CreateInput(lu("Wings Span"),a.wspan,a.span,!1);a.wspan.min=
"1";this.mini_cell.appendChild(a.span);this.mini_cell.appendChild(a.br);this.mw_list.push(a)}UpdateMiniWing(a,b,c){for(let d=1;d<a.deck.options.length;d++){let e=a.deck.options[d];c.deck==d||this.wings.CanAddMiniWing(d-1)||this.wings.CanMoveMiniWing(b,d-1)?e.disabled=!1:e.disabled=!0}a.deck.onchange=()=>{let d=Object.assign({},c);d.deck=a.deck.selectedIndex-1;this.wings.SetMiniWing(b,d)};a.deck.selectedIndex=c.deck+1;a.skin.onchange=()=>{let d=Object.assign({},c);d.surface=a.skin.selectedIndex;this.wings.SetMiniWing(b,
d)};a.skin.selectedIndex=c.surface;a.area.onchange=()=>{let d=Object.assign({},c);d.area=a.area.valueAsNumber;this.wings.SetMiniWing(b,d)};a.area.valueAsNumber=c.area;a.wspan.onchange=()=>{let d=Object.assign({},c);d.span=a.wspan.valueAsNumber;this.wings.SetMiniWing(b,d)};a.wspan.valueAsNumber=c.span}PopMiniWing(){var a=this.mw_list.pop();this.mini_cell.removeChild(a.span);this.mini_cell.removeChild(a.br)}CreateFWAdd(a){this.fw_add=document.createElement("SELECT");var b=this.wings.GetDeckList(),c=
document.createElement("OPTION");c.textContent=lu("Wings No Wing");this.fw_add.append(c);c=!1;for(let d=0;d<b.length;d++){let e=b[d],f=document.createElement("OPTION");f.textContent=lu(e.name);this.wings.CanAddFullWing(d)?c=!0:f.disabled=!0;this.fw_add.append(f)}this.fw_add.onchange=()=>{this.wings.SetFullWing(a,{surface:0,area:10,span:5,gull:!1,dihedral:0,anhedral:0,deck:this.fw_add.selectedIndex-1})};this.fw_add.selectedIndex=0;this.fw_add.disabled=!c;this.full_cell.appendChild(this.fw_add)}CreateMWAdd(a){this.mw_add=
document.createElement("SELECT");var b=this.wings.GetDeckList(),c=document.createElement("OPTION");c.textContent=lu("Wings No Wing");this.mw_add.append(c);c=!1;for(let d=0;d<b.length;d++){let e=b[d],f=document.createElement("OPTION");f.textContent=lu(e.name);this.wings.CanAddMiniWing(d)?c=!0:f.disabled=!0;this.mw_add.append(f)}this.mw_add.onchange=()=>{this.wings.SetMiniWing(a,{surface:0,area:2,span:2,gull:!1,dihedral:0,anhedral:0,deck:this.mw_add.selectedIndex-1})};this.mw_add.selectedIndex=0;this.mw_add.disabled=
!c;this.mini_cell.appendChild(this.mw_add)}}
class Stabilizers_HTML extends Display{constructor(a){super();this.stab=a;document.getElementById("lbl_stab").textContent=lu("Stabilizers Section Title");var b=document.getElementById("stab_table"),c=document.createDocumentFragment(),d=insertRow(c);CreateTH(d,lu("Stabilizers Horizontal Stabilizers"));CreateTH(d,lu("Stabilizers Vertical Stabilizers"));CreateTH(d,lu("Stabilizers Stabilizer Stats"));d=insertRow(c);var e=d.insertCell(),f=d.insertCell();this.h_type=document.createElement("SELECT");this.h_count=
document.createElement("INPUT");e.appendChild(this.h_type);e.append(document.createElement("BR"));CreateInput(lu("Stabilizers # of Stabilizers"),this.h_count,e);this.h_count.min="0";this.h_count.max="20";this.h_count.onchange=()=>{this.stab.SetHStabCount(this.h_count.valueAsNumber)};this.h_type.onchange=()=>{this.stab.SetHStabType(this.h_type.selectedIndex)};for(let g of a.GetHStabList())e=document.createElement("OPTION"),e.text=lu(g.name),this.h_type.add(e);this.v_type=document.createElement("SELECT");
this.v_count=document.createElement("INPUT");f.appendChild(this.v_type);f.appendChild(document.createElement("BR"));CreateInput(lu("Stabilizers # of Stabilizers"),this.v_count,f);this.v_count.min="0";this.v_count.max="20";this.v_count.onchange=()=>{this.stab.SetVStabCount(this.v_count.valueAsNumber)};this.v_type.onchange=()=>{this.stab.SetVStabType(this.v_type.selectedIndex)};for(let g of a.GetVStabList())a=document.createElement("OPTION"),a.text=lu(g.name),this.v_type.add(a);d=d.insertCell();d.rowSpan=
0;this.InitStatDisplay(d);b.appendChild(c)}InitStatDisplay(a){a.className="inner_table";var b=document.createElement("TABLE");b.className="inner_table";a.appendChild(b);a=b.insertRow();CreateTH(a,lu("Stat Drag"));CreateTH(a,lu("Stat Control"));CreateTH(a,lu("Stat Cost"));a=b.insertRow();this.d_drag=a.insertCell();this.d_cont=a.insertCell();this.d_cost=a.insertCell();a=b.insertRow();CreateTH(a,lu("Stat Pitch Stability"));CreateTH(a,lu("Stat Lateral Stability"));CreateTH(a,lu("Stat Lift Bleed"));b=
b.insertRow();this.d_pstb=b.insertCell();this.d_lstb=b.insertCell();this.d_lift=b.insertCell()}UpdateDisplay(){this.h_type.selectedIndex=this.stab.GetHStabType();this.v_type.selectedIndex=this.stab.GetVStabType();for(var a=this.stab.GetHValidList(),b=0;b<a.length;b++)this.h_type.options[b].disabled=!a[b];a=this.stab.GetVValidList();for(b=0;b<a.length;b++)this.v_type.options[b].disabled=!a[b];this.h_count.valueAsNumber=this.stab.GetHStabCount();this.h_count.step=this.stab.GetHStabIncrement().toString();
this.v_count.valueAsNumber=this.stab.GetVStabCount();this.v_count.step=this.stab.GetVStabIncrement().toString();a=this.stab.PartStats();BlinkIfChanged(this.d_drag,a.drag.toString(),!1);BlinkIfChanged(this.d_cont,a.control.toString(),!0);BlinkIfChanged(this.d_cost,a.cost.toString(),!1);BlinkIfChanged(this.d_pstb,a.pitchstab.toString(),!0);BlinkIfChanged(this.d_lstb,a.latstab.toString(),!0);BlinkIfChanged(this.d_lift,a.liftbleed.toString(),!1)}}
class ControlSurfaces_HTML extends Display{constructor(a){super();this.cs=a;document.getElementById("lbl_control_surfaces").textContent=lu("Control Surfaces Section Title");var b=document.getElementById("tbl_control_surfaces"),c=document.createDocumentFragment(),d=insertRow(c);CreateTH(d,lu("Control Surfaces Control Surfaces"));CreateTH(d,lu("Control Surfaces Drag Inducers"));CreateTH(d,lu("Control Surfaces Stats"));d=insertRow(c);var e=d.insertCell();this.aileron_select=document.createElement("SELECT");
for(var f of a.GetAileronList()){let l=document.createElement("OPTION");l.text=lu(f.name);this.aileron_select.add(l)}this.aileron_select.onchange=()=>{this.cs.SetAileron(this.aileron_select.selectedIndex)};this.rudder_select=document.createElement("SELECT");for(var g of a.GetRudderList())f=document.createElement("OPTION"),f.text=lu(g.name),this.rudder_select.add(f);this.rudder_select.onchange=()=>{this.cs.SetRudder(this.rudder_select.selectedIndex)};this.elevator_select=document.createElement("SELECT");
for(var h of a.GetElevatorList())g=document.createElement("OPTION"),g.text=lu(h.name),this.elevator_select.add(g);this.elevator_select.onchange=()=>{this.cs.SetElevator(this.elevator_select.selectedIndex)};this.flaps_select=document.createElement("SELECT");for(var k of a.GetFlapsList())h=document.createElement("OPTION"),h.text=lu(k.name),this.flaps_select.add(h);this.flaps_select.onchange=()=>{this.cs.SetFlaps(this.flaps_select.selectedIndex)};this.slats_select=document.createElement("SELECT");for(let l of a.GetSlatsList())k=
document.createElement("OPTION"),k.text=lu(l.name),this.slats_select.add(k);this.slats_select.onchange=()=>{this.cs.SetSlats(this.slats_select.selectedIndex)};e=CreateFlexSection(e);FlexSelect(lu("Control Surfaces Ailerons"),this.aileron_select,e);FlexSelect(lu("Control Surfaces Rudders"),this.rudder_select,e);FlexSelect(lu("Control Surfaces Elevators"),this.elevator_select,e);FlexSelect(lu("Control Surfaces Flaps"),this.flaps_select,e);FlexSelect(lu("Control Surfaces Slats"),this.slats_select,e);
e=d.insertCell();e=CreateFlexSection(e);this.drag_chbx=[];a=a.GetDragList();for(let l=0;l<a.length;l++){let n=document.createElement("INPUT");FlexCheckbox(lu(a[l].name),n,e);n.onchange=()=>{this.cs.SetDrag(l,n.checked)};this.drag_chbx.push(n)}this.InitStatDisplay(d.insertCell());b.appendChild(c)}InitStatDisplay(a){a.className="inner_table";var b=document.createElement("TABLE");b.className="inner_table";a.appendChild(b);a=b.insertRow();CreateTH(a,lu("Stat Drag"));CreateTH(a,lu("Stat Mass"));CreateTH(a,
lu("Stat Cost"));a=b.insertRow();this.d_drag=a.insertCell();this.d_mass=a.insertCell();this.d_cost=a.insertCell();a=b.insertRow();CreateTH(a,lu("Stat Control"));CreateTH(a,lu("Stat Pitch Stability"));CreateTH(a,lu("Stat Lateral Stability"));a=b.insertRow();this.d_cont=a.insertCell();this.d_pstb=a.insertCell();this.d_lstb=a.insertCell();a=b.insertRow();CreateTH(a,lu("Stat Lift Bleed"));CreateTH(a,lu("Stat Crash Safety"));CreateTH(a," ");b=b.insertRow();this.d_lift=b.insertCell();this.d_crsh=b.insertCell();
this.d_none=b.insertCell()}UpdateDisplay(){for(var a=this.cs.CanAileron(),b=0;b<a.length;b++)this.aileron_select.options[b].disabled=!a[b];this.aileron_select.selectedIndex=this.cs.GetAileron();this.rudder_select.selectedIndex=this.cs.GetRudder();this.rudder_select.disabled=!this.cs.CanRudder();this.elevator_select.selectedIndex=this.cs.GetElevator();this.elevator_select.disabled=!this.cs.CanElevator();this.flaps_select.selectedIndex=this.cs.GetFlaps();this.slats_select.selectedIndex=this.cs.GetSlats();
a=this.cs.GetDrag();for(b=0;b<this.drag_chbx.length;b++)this.drag_chbx[b].checked=a[b];a=this.cs.PartStats();b=a.cost+this.cs.GetFlapCost();BlinkIfChanged(this.d_drag,a.drag.toString(),!1);BlinkIfChanged(this.d_mass,a.mass.toString(),!1);BlinkIfChanged(this.d_cost,b.toString(),!1);BlinkIfChanged(this.d_cont,a.control.toString(),!0);BlinkIfChanged(this.d_pstb,a.pitchstab.toString(),!0);BlinkIfChanged(this.d_lstb,a.latstab.toString(),!0);BlinkIfChanged(this.d_lift,a.liftbleed.toString(),!1);BlinkIfChanged(this.d_crsh,
a.crashsafety.toString(),!0)}}
class Reinforcement_HTML extends Display{constructor(a){super();this.rf=a;this.ext_wood_inp=[];this.ext_steel_inp=[];this.cant_inp=[];document.getElementById("lbl_reinforcements").textContent=lu("Reinforcement Section Title");a=document.getElementById("tbl_reinforcements");var b=document.createDocumentFragment(),c=insertRow(b);CreateTH(c,lu("Reinforcement External Reinforcements"));CreateTH(c,lu("Reinforcement Internal Reinforcements"));CreateTH(c,lu("Reinforcement Reinforcement Stats"));c=insertRow(b);
this.InitExternal(c.insertCell());this.InitInternal(c.insertCell());this.InitStatDisplay(c.insertCell());a.appendChild(b)}InitExternal(a){a=CreateFlexSection(a);var b=CreateFlexSection(a.div2),c=CreateFlexSection(b.div1);b=CreateFlexSection(b.div2);var d=this.rf.GetExternalList();for(let e=0;e<d.length;e++){let f=d[e],g=document.createElement("INPUT"),h=document.createElement("INPUT");FlexLabel(lu(f.name),a.div1);FlexInput(lu("Reinforcement Wood"),g,c);FlexInput(lu("Reinforcement Steel"),h,b);g.min=
"0";h.min="0";g.onchange=()=>{this.rf.SetExternalWoodCount(e,g.valueAsNumber)};h.onchange=()=>{this.rf.SetExternalSteelCount(e,h.valueAsNumber)};this.ext_wood_inp.push(g);this.ext_steel_inp.push(h)}this.cabane=document.createElement("SELECT");FlexSelect(lu("Reinforcement Cabane"),this.cabane,a);for(let e of this.rf.GetCabaneList())c=document.createElement("OPTION"),c.text=lu(e.name),this.cabane.add(c);this.cabane.onchange=()=>{this.rf.SetCabane(this.cabane.selectedIndex)};this.cabane.selectedIndex=
0;this.wires=document.createElement("INPUT");FlexCheckbox(lu("Reinforcement Wires"),this.wires,a);this.wires.onchange=()=>{this.rf.SetWires(this.wires.checked)}}InitInternal(a){a=CreateFlexSection(a);var b=this.rf.GetCantileverList();for(let c=0;c<b.length;c++){let d=b[c],e=document.createElement("INPUT");FlexInput(lu(d.name),e,a);e.min="0";e.onchange=()=>{this.rf.SetCantileverCount(c,e.valueAsNumber)};this.cant_inp.push(e)}this.wing_blades=document.createElement("INPUT");FlexCheckbox(lu("Reinforcement Wing Blades"),
this.wing_blades,a);this.wing_blades.onchange=()=>{this.rf.SetWingBlade(this.wing_blades.checked)}}InitStatDisplay(a){a.className="inner_table";var b=document.createElement("TABLE");b.className="inner_table";a.appendChild(b);a=b.insertRow();CreateTH(a,lu("Stat Drag"));CreateTH(a,lu("Stat Mass"));CreateTH(a,lu("Stat Cost"));a=b.insertRow();this.d_drag=a.insertCell();this.d_mass=a.insertCell();this.d_cost=a.insertCell();a=b.insertRow();CreateTH(a,lu("Stat Structure"));CreateTH(a,lu("Stat Raw Strain"));
CreateTH(a,lu("Reinforcement Aircraft Max Strain"));b=b.insertRow();this.d_strc=b.insertCell();this.d_maxs=b.insertCell();this.d_amax=b.insertCell();this.d_amax.className="part_local"}UpdateDisplay(){this.cabane.selectedIndex=this.rf.GetCabane();this.wires.checked=this.rf.GetWires();for(var a=this.rf.GetExternalWoodCount(),b=this.rf.CanExternalWood(),c=0;c<a.length;c++)this.ext_wood_inp[c].valueAsNumber=a[c],this.ext_wood_inp[c].disabled=!b[c];a=this.rf.GetExternalSteelCount();b=this.rf.CanExternalWood();
for(c=0;c<a.length;c++)this.ext_steel_inp[c].valueAsNumber=a[c],this.ext_steel_inp[c].disabled=!b[c];a=this.rf.GetCantileverCount();for(b=0;b<a.length;b++)this.cant_inp[b].valueAsNumber=a[b];this.wing_blades.disabled=!this.rf.CanWingBlade();this.wing_blades.checked=this.rf.GetWingBlade();a=this.rf.PartStats();BlinkIfChanged(this.d_drag,a.drag.toString(),!1);BlinkIfChanged(this.d_mass,a.mass.toString(),!1);BlinkIfChanged(this.d_cost,a.cost.toString(),!1);BlinkIfChanged(this.d_strc,a.structure.toString(),
!0);BlinkIfChanged(this.d_maxs,a.maxstrain.toString(),!0)}UpdateMaxStrain(a){BlinkIfChanged(this.d_amax,a.toString(),!0)}}
class Load_HTML extends Display{constructor(a,b,c){super();this.fuel=a;this.boom=b;this.cargo=c;this.fuel_list=[];document.getElementById("lbl_load").textContent=lu("Load Section Title");a=document.getElementById("tbl_load");b=document.createDocumentFragment();c=insertRow(b);CreateTH(c,lu("Load Fuel"));CreateTH(c,lu("Load Munitions"));CreateTH(c,lu("Load Cargo and Passengers"));CreateTH(c,lu("Load Load Stats"));c=insertRow(b);this.InitFuel(c.insertCell());this.InitMunitions(c.insertCell());this.InitCargoAndPassengers(c.insertCell());
this.InitStats(c.insertCell());a.appendChild(b)}InitFuel(a){var b=this.fuel.GetTankList();a=CreateFlexSection(a);for(let c=0;c<b.length;c++){let d=document.createElement("INPUT");FlexInput(lu(b[c].name),d,a);d.onchange=()=>{this.fuel.SetTankCount(c,d.valueAsNumber)};this.fuel_list.push(d)}this.seal=document.createElement("INPUT");FlexCheckbox(lu("Load Self-Sealing Gas Tank"),this.seal,a);this.seal.onchange=()=>{this.fuel.SetSelfSealing(this.seal.checked)};this.extinguish=document.createElement("INPUT");
FlexCheckbox(lu("Load Remote Fire Extinguisher"),this.extinguish,a);this.extinguish.onchange=()=>{this.fuel.SetExtinguisher(this.extinguish.checked)}}InitMunitions(a){a=CreateFlexSection(a);this.bombs=document.createElement("INPUT");FlexInput(lu("Load Bombs"),this.bombs,a);this.bombs.onchange=()=>{this.boom.SetBombCount(this.bombs.valueAsNumber)};this.rockets=document.createElement("INPUT");FlexInput(lu("Load Rockets"),this.rockets,a);this.rockets.onchange=()=>{this.boom.SetRocketCount(this.rockets.valueAsNumber)};
this.bay_count=document.createElement("INPUT");FlexInput(lu("Load Internal Bay Count"),this.bay_count,a);this.bay_count.onchange=()=>{this.boom.SetBayCount(this.bay_count.valueAsNumber)};this.bay1=document.createElement("INPUT");FlexCheckbox(lu("Load Widen Internal Bay 1"),this.bay1,a);this.bay1.onchange=()=>{this.boom.SetUseBays(this.bay1.checked,this.bay2.checked)};this.bay2=document.createElement("INPUT");FlexCheckbox(lu("Load Widen Internal Bay 2"),this.bay2,a);this.bay2.onchange=()=>{this.boom.SetUseBays(this.bay1.checked,
this.bay2.checked)}}InitCargoAndPassengers(a){this.carg=document.createElement("SELECT");a.appendChild(this.carg);a=this.cargo.GetSpaceList();for(let b of a)a=document.createElement("OPTION"),a.text=lu(b.name),this.carg.add(a);this.carg.onchange=()=>{this.cargo.SetSpace(this.carg.selectedIndex)}}InitStats(a){a.className="inner_table";var b=document.createElement("TABLE");b.className="inner_table";a.appendChild(b);a=b.insertRow();CreateTH(a,lu("Stat Drag"));CreateTH(a,lu("Stat Mass"));CreateTH(a,lu("Stat Wet Mass"));
a=b.insertRow();this.d_drag=a.insertCell();this.d_mass=a.insertCell();this.d_wmas=a.insertCell();a=b.insertRow();CreateTH(a,lu("Stat Required Sections"));CreateTH(a,lu("Stat Fuel"));CreateTH(a,lu("Stat Cost"));a=b.insertRow();this.d_rsec=a.insertCell();this.d_fuel=a.insertCell();this.d_cost=a.insertCell();a=b.insertRow();CreateTH(a,"");CreateTH(a,lu("Derived Fuel Uses"));CreateTH(a,"");a=b.insertRow();a.insertCell();this.d_fuse=a.insertCell();a.insertCell()}UpdateFuelUses(a){a=Math.floor(1E-6+10*
a)/10;isFinite(a)||(a=0);BlinkIfChanged(this.d_fuse,a.toString(),!1)}UpdateDisplay(){var a=this.fuel.GetTankCount(),b=this.fuel.GetTankEnabled();for(let c=0;c<a.length;c++)this.fuel_list[c].valueAsNumber=a[c],this.fuel_list[c].disabled=!b[c];this.seal.checked=this.fuel.GetSelfSealing();this.seal.disabled=!this.fuel.GetSealingEnabled();this.extinguish.checked=this.fuel.GetExtinguisher();this.bombs.valueAsNumber=this.boom.GetBombCount();this.rockets.valueAsNumber=this.boom.GetRocketCount();this.bay_count.valueAsNumber=
this.boom.GetBayCount();this.bay1.checked=this.boom.GetBay1();this.bay2.checked=this.boom.GetBay2();0<this.boom.GetBayCount()?(this.bay1.disabled=!1,this.bay2.disabled=this.bay1.checked?!1:!0):(this.bay1.disabled=!0,this.bay2.disabled=!0);this.carg.selectedIndex=this.cargo.GetSpace();a=this.fuel.PartStats();a=a.Add(this.boom.PartStats());a=a.Add(this.cargo.PartStats());BlinkIfChanged(this.d_drag,a.drag.toString(),!1);BlinkIfChanged(this.d_mass,a.mass.toString(),!1);BlinkIfChanged(this.d_wmas,a.wetmass.toString(),
!1);BlinkIfChanged(this.d_rsec,a.reqsections.toString(),!1);BlinkIfChanged(this.d_fuel,a.fuel.toString(),!0);BlinkIfChanged(this.d_cost,a.cost.toString(),!1)}}
class LandingGear_HTML extends Display{constructor(a){super();this.gear=a;document.getElementById("lbl_landing_gear").textContent=lu("Landing Gear Section Title");a=document.getElementById("tbl_gear");var b=document.createDocumentFragment(),c=insertRow(b);CreateTH(c,lu("Landing Gear Landing Gear"));CreateTH(c,lu("Landing Gear Extras"));CreateTH(c,lu("Landing Gear Gear Stats"));c=insertRow(b);this.InitGear(c.insertCell());this.InitExtras(c.insertCell());this.InitStats(c.insertCell());a.appendChild(b)}InitGear(a){var b=
this.gear.GetGearList();a=CreateFlexSection(a);this.sel=document.createElement("SELECT");FlexSelect("Type",this.sel,a);for(let c=0;c<b.length;c++){let d=document.createElement("OPTION");d.text=lu(b[c].name);this.sel.add(d)}this.sel.onchange=()=>{this.gear.SetGear(this.sel.selectedIndex)};this.retract=document.createElement("INPUT");FlexCheckbox(lu("Landing Gear Retractable"),this.retract,a);this.retract.onchange=()=>{this.gear.SetRetract(this.retract.checked)}}InitExtras(a){this.extras=[];var b=this.gear.GetExtraList();
a=CreateFlexSection(a);for(let c=0;c<b.length;c++){let d=document.createElement("INPUT");FlexCheckbox(lu(b[c].name),d,a);d.onchange=()=>{this.gear.SetExtraSelected(c,d.checked)};this.extras.push(d)}}InitStats(a){a.className="inner_table";var b=document.createElement("TABLE");b.className="inner_table";a.appendChild(b);a=b.insertRow();CreateTH(a,lu("Stat Drag"));CreateTH(a,lu("Stat Mass"));CreateTH(a,lu("Stat Cost"));a=b.insertRow();this.d_drag=a.insertCell();this.d_mass=a.insertCell();this.d_cost=
a.insertCell();a=b.insertRow();CreateTH(a,lu("Stat Structure"));CreateTH(a,lu("Stat Crash Safety"));CreateTH(a,"");b=b.insertRow();this.d_strc=b.insertCell();this.d_crsh=b.insertCell();b.insertCell()}UpdateDisplay(){this.sel.selectedIndex=this.gear.GetGear();for(var a=this.gear.CanGear(),b=0;b<a.length;b++)this.sel.options[b].disabled=!a[b];this.retract.checked=this.gear.GetRetract();this.retract.disabled=!this.gear.CanRetract();a=this.gear.GetExtraSelected();for(b=0;b<a.length;b++)this.extras[b].checked=
a[b];a=this.gear.PartStats();BlinkIfChanged(this.d_drag,a.drag.toString(),!1);BlinkIfChanged(this.d_mass,a.mass.toString(),!1);BlinkIfChanged(this.d_cost,a.cost.toString(),!1);BlinkIfChanged(this.d_strc,a.structure.toString(),!0);BlinkIfChanged(this.d_crsh,a.crashsafety.toString(),!0)}}
class Accessories_HTML extends Display{constructor(a){super();this.acc=a;document.getElementById("lbl_accessories").textContent=lu("Accessories Section Title");a=document.getElementById("tbl_accessories");var b=document.createDocumentFragment(),c=insertRow(b);CreateTH(c,lu("Accessories Climate"));CreateTH(c,lu("Accessories Armour Coverage"));CreateTH(c,lu("Accessories Visibility"));CreateTH(c,lu("Accessories Additional Part Stats"));c=insertRow(b);this.InitClimate(c.insertCell());this.InitArmour(c.insertCell());
this.InitVisibility(c.insertCell());this.InitStats(c.insertCell());c=insertRow(b);CreateTH(c,lu("Accessories Information"));CreateTH(c,lu("Accessories Electrical"));CreateTH(c,lu("Accessories Control"));c=insertRow(b);this.InitInformation(c.insertCell());this.InitElectrical(c.insertCell());this.InitControl(c.insertCell());a.appendChild(b)}InitArmour(a){var b=CreateFlexSection(a);a=CreateFlexSection(b.div1);b=CreateFlexSection(b.div2);this.a_AP=[];for(var c=this.acc.GetArmourCoverage().length,d=0;d<
c;d++)this.a_AP.push(document.createElement("INPUT"));for(let e=0;e<c/2;e++){d=e+1;FlexInput("Thickness "+d.toString(),this.a_AP[e],a);this.a_AP[e].onchange=()=>{this.acc.SetArmourCoverage(e,this.a_AP[e].valueAsNumber)};let f=e+c/2;d=f+1;FlexInput("Thickness "+d.toString(),this.a_AP[f],b);this.a_AP[f].onchange=()=>{this.acc.SetArmourCoverage(f,this.a_AP[f].valueAsNumber)}}}InitElectrical(a){a=CreateFlexSection(a);this.radio=document.createElement("SELECT");FlexSelect(lu("Accessories Radio"),this.radio,
a);var b=this.acc.GetRadioList();for(let c=0;c<b.length;c++){let d=document.createElement("OPTION");d.text=lu(b[c].name);this.radio.add(d)}this.radio.onchange=()=>{this.acc.SetRadioSel(this.radio.selectedIndex)};this.elect=[];b=this.acc.GetElectricalList();for(let c=0;c<b.length;c++){let d=document.createElement("INPUT");FlexInput(lu(b[c].name),d,a);d.onchange=()=>{this.acc.SetElectricalCount(c,d.valueAsNumber)};this.elect.push(d)}}InitInformation(a){a=CreateFlexSection(a);var b=this.acc.GetReconList();
this.recon=[];for(let c=0;c<b.length;c++){let d=document.createElement("INPUT");FlexInput(lu(b[c].name),d,a);d.min="0";d.onchange=()=>{this.acc.SetReconSel(c,d.valueAsNumber)};this.recon.push(d)}}InitVisibility(a){a=CreateFlexSection(a);var b=this.acc.GetVisibilityList();this.visi=[];for(let c=0;c<b.length;c++){let d=document.createElement("INPUT");FlexCheckbox(lu(b[c].name),d,a);d.onchange=()=>{this.acc.SetVisibilitySel(c,d.checked)};this.visi.push(d)}}InitClimate(a){a=CreateFlexSection(a);var b=
this.acc.GetClimateList();this.clim=[];for(let c=0;c<b.length;c++){let d=document.createElement("INPUT");FlexCheckbox(lu(b[c].name),d,a);d.onchange=()=>{this.acc.SetClimateSel(c,d.checked)};this.clim.push(d)}}InitControl(a){a=CreateFlexSection(a);this.auto=document.createElement("SELECT");var b=this.acc.GetAutopilotList();FlexSelect(lu("Accessories Autopilot"),this.auto,a);for(var c=0;c<b.length;c++){let d=document.createElement("OPTION");d.text=lu(b[c].name);this.auto.add(d)}this.auto.onchange=()=>
{this.acc.SetAutopilotSel(this.auto.selectedIndex)};b=this.acc.GetControlList();this.cont=document.createElement("SELECT");FlexSelect(lu("Accessories Control Aids"),this.cont,a);for(a=0;a<b.length;a++)c=document.createElement("OPTION"),c.text=lu(b[a].name),this.cont.add(c);this.cont.onchange=()=>{this.acc.SetControlSel(this.cont.selectedIndex)}}InitStats(a){a.rowSpan=3;a.className="inner_table";var b=document.createElement("TABLE");b.className="inner_table";a.appendChild(b);a=b.insertRow();CreateTH(a,
lu("Stat Drag"));CreateTH(a,lu("Stat Mass"));CreateTH(a,lu("Stat Cost"));a=b.insertRow();this.d_drag=a.insertCell();this.d_mass=a.insertCell();this.d_cost=a.insertCell();a=b.insertRow();CreateTH(a,lu("Stat Structure"));CreateTH(a,lu("Stat Charge"));CreateTH(a,lu("Stat Lift Bleed"));a=b.insertRow();this.d_strc=a.insertCell();this.d_chgh=a.insertCell();this.d_lift=a.insertCell();a=b.insertRow();CreateTH(a,lu("Stat Visibility"));CreateTH(a,lu("Stat Flight Stress"));CreateTH(a,lu("Stat Required Sections"));
b=b.insertRow();this.d_visi=b.insertCell();this.d_strs=b.insertCell();this.d_rsec=b.insertCell()}UpdateDisplay(){for(var a=this.acc.GetArmourCoverage(),b=0;b<a.length;b++)this.a_AP[b].valueAsNumber=a[b];this.radio.selectedIndex=this.acc.GetRadioSel();a=this.acc.GetElectricalCount();for(b=0;b<a.length;b++)this.elect[b].valueAsNumber=a[b];a=this.acc.GetReconSel();for(b=0;b<a.length;b++)this.recon[b].valueAsNumber=a[b];a=this.acc.GetVisibilitySel();b=this.acc.GetCanVisibility();for(var c=0;c<a.length;c++)this.visi[c].checked=
a[c],this.visi[c].disabled=!b[c];b=this.acc.GetClimateSel();c=this.acc.GetClimateEnable();for(let d=0;d<a.length;d++)this.clim[d].checked=b[d],this.clim[d].disabled=!c[d];this.auto.selectedIndex=this.acc.GetAutopilotSel();this.cont.selectedIndex=this.acc.GetControlSel();a=this.acc.PartStats();BlinkIfChanged(this.d_drag,a.drag.toString(),!1);BlinkIfChanged(this.d_mass,a.mass.toString(),!1);BlinkIfChanged(this.d_cost,a.cost.toString(),!1);BlinkIfChanged(this.d_strc,a.structure.toString(),!0);BlinkIfChanged(this.d_chgh,
a.charge.toString(),!0);BlinkIfChanged(this.d_lift,a.liftbleed.toString(),!1);BlinkIfChanged(this.d_visi,a.visibility.toString(),!0);BlinkIfChanged(this.d_strs,a.flightstress.toString(),!1);BlinkIfChanged(this.d_rsec,a.reqsections.toString(),!1)}}
class Optimization_HTML extends Display{constructor(a){super();this.opt=a;document.getElementById("lbl_optimization").textContent=lu("Optimization Section Title");document.getElementById("lbl_num_opt").textContent=lu("Optimization Num Free Optimizations");this.free_inp=document.getElementById("num_opt");this.free_inp.onchange=()=>{this.opt.SetFreeDots(this.free_inp.valueAsNumber)};a=document.getElementById("tbl_optimization");var b=document.createDocumentFragment(),c=insertRow(b);CreateTH(c,lu("Optimization Negative"));
CreateTH(c,lu("Optimization Effect"));CreateTH(c,lu("Optimization Positive"));CreateTH(c,lu("Optimization Optimization Stats"));c=insertRow(b);this.cost_cbx=this.InitRow(c,lu("Optimization Cost"),d=>this.opt.SetCost(d));this.bleed_cbx=this.InitRow(insertRow(b),lu("Optimization Lift Bleed"),d=>this.opt.SetBleed(d));this.escape_cbx=this.InitRow(insertRow(b),lu("Optimization Leg Room"),d=>this.opt.SetEscape(d));this.mass_cbx=this.InitRow(insertRow(b),lu("Optimization Mass"),d=>this.opt.SetMass(d));this.toughness_cbx=
this.InitRow(insertRow(b),lu("Optimization Toughness"),d=>this.opt.SetToughness(d));this.maxstrain_cbx=this.InitRow(insertRow(b),lu("Optimization Max Strain"),d=>this.opt.SetMaxStrain(d));this.reliability_cbx=this.InitRow(insertRow(b),lu("Optimization Reliability"),d=>this.opt.SetReliability(d));this.drag_cbx=this.InitRow(insertRow(b),lu("Optimization Drag"),d=>this.opt.SetDrag(d));this.InitStatDisplay(c.insertCell());a.appendChild(b)}InitRow(a,b,c){var d=[];for(let g=0;6>g;g++)d.push(document.createElement("INPUT")),
d[g].setAttribute("type","checkbox"),d[g].onchange=3>g?()=>{d[g].checked?c(g-3):c(g-2)}:()=>{d[g].checked?c(g-2):c(g-3)};var e=a.insertCell(),f=a.insertCell();a=a.insertCell();e.appendChild(d[0]);e.appendChild(d[1]);e.appendChild(d[2]);f.textContent=b;a.appendChild(d[3]);a.appendChild(d[4]);a.appendChild(d[5]);return d}InitStatDisplay(a){a.rowSpan=0;a.className="inner_table";var b=document.createElement("TABLE");b.className="inner_table";a.appendChild(b);a=b.insertRow();CreateTH(a,lu("Stat Cost"));
CreateTH(a,lu("Stat Lift Bleed"));CreateTH(a,lu("Stat Escape"));a=b.insertRow();this.d_cost=a.insertCell();this.d_lift=a.insertCell();this.d_escp=a.insertCell();a=b.insertRow();CreateTH(a,lu("Stat Visibility"));CreateTH(a,lu("Stat Mass"));CreateTH(a,lu("Stat Toughness"));a=b.insertRow();this.d_visi=a.insertCell();this.d_mass=a.insertCell();this.d_tugh=a.insertCell();a=b.insertRow();CreateTH(a,lu("Stat Max Strain"));CreateTH(a,lu("Stat Reliability"));CreateTH(a,lu("Stat Drag"));b=b.insertRow();this.d_mstr=
b.insertCell();this.d_reli=b.insertCell();this.d_drag=b.insertCell()}UpdateChecked(a,b){for(let c=0;c<b.length;c++)b[c].checked=!1;0>a?(b[2].checked=!0,-1>a&&(b[1].checked=!0,-2>a&&(b[0].checked=!0))):0<a&&(b[3].checked=!0,1<a&&(b[4].checked=!0,2<a&&(b[5].checked=!0)))}UpdateEnabled(a,b){var c=0;for(let d=3;d<b.length;d++)b[d].checked||c++,b[d].disabled=c>a}UpdateDisplay(){this.free_inp.valueAsNumber=this.opt.GetFreeDots();this.UpdateChecked(this.opt.GetCost(),this.cost_cbx);this.UpdateChecked(this.opt.GetBleed(),
this.bleed_cbx);this.UpdateChecked(this.opt.GetEscape(),this.escape_cbx);this.UpdateChecked(this.opt.GetMass(),this.mass_cbx);this.UpdateChecked(this.opt.GetToughness(),this.toughness_cbx);this.UpdateChecked(this.opt.GetMaxStrain(),this.maxstrain_cbx);this.UpdateChecked(this.opt.GetReliabiilty(),this.reliability_cbx);this.UpdateChecked(this.opt.GetDrag(),this.drag_cbx);var a=this.opt.GetUnassignedCount();this.UpdateEnabled(a,this.cost_cbx);this.UpdateEnabled(a,this.bleed_cbx);this.UpdateEnabled(a,
this.escape_cbx);this.UpdateEnabled(a,this.mass_cbx);this.UpdateEnabled(a,this.toughness_cbx);this.UpdateEnabled(a,this.maxstrain_cbx);this.UpdateEnabled(a,this.reliability_cbx);this.UpdateEnabled(a,this.drag_cbx);a=this.opt.PartStats();BlinkIfChanged(this.d_cost,a.cost.toString(),!1);BlinkIfChanged(this.d_lift,a.liftbleed.toString(),!1);BlinkIfChanged(this.d_escp,a.escape.toString(),!0);BlinkIfChanged(this.d_visi,a.visibility.toString(),!0);BlinkIfChanged(this.d_mass,a.mass.toString(),!1);BlinkIfChanged(this.d_tugh,
a.toughness.toString(),!0);BlinkIfChanged(this.d_mstr,this.opt.final_ms.toString(),!0);BlinkIfChanged(this.d_reli,a.reliability.toString(),!0);BlinkIfChanged(this.d_drag,a.drag.toString(),!1)}}
class Weapons_HTML extends Display{constructor(a){super();this.weap=a;document.getElementById("lbl_weapons").textContent=lu("Weapons Section Title");document.getElementById("lbl_num_wsets").textContent=lu("Weapons Number of Weapon Sets");this.inp_w_count=document.getElementById("num_wsets");this.inp_w_count.onchange=()=>{this.weap.SetWeaponSetCount(this.inp_w_count.valueAsNumber)};document.getElementById("lbl_num_wbraces").textContent=lu("Weapons Number of Weapon Braces");this.inp_w_brace=document.getElementById("num_wbraces");
this.inp_w_brace.onchange=()=>{this.weap.SetBraceCount(this.inp_w_brace.valueAsNumber)};this.tbl=document.getElementById("table_weapons");a=this.tbl.insertRow();CreateTH(a,lu("Weapons Weapon Set"));CreateTH(a,lu("Weapons Weapons"));CreateTH(a,lu("Weapons Weapon Stats"));this.wrow=[]}CreateWSetRow(){var a=document.createDocumentFragment(),b=insertRow(a),c=b.insertCell(),d=CreateFlexSection(c);c={type:document.createElement("SELECT"),dirs:[],count:document.createElement("INPUT"),action:document.createElement("SELECT"),
projectile:document.createElement("SELECT"),fixed:document.createElement("INPUT"),wcell:null,weaps:[],ammo:document.createElement("INPUT"),stats:{mass:null,drag:null,cost:null,sect:null,mounting:null,jams:null,hits:null,damg:null,shots:null,shots_header:null},repeating:document.createElement("INPUT"),seat:document.createElement("SELECT")};var e=this.weap.GetWeaponList();for(f of e)e=document.createElement("OPTION"),e.text=lu(f.name)+" ("+lu(f.era)+")",c.type.add(e);c.type.required=!0;var f=this.weap.GetSeatList();
for(g of f)f=document.createElement("OPTION"),f.text=g,c.seat.add(f);var g=this.weap.GetActionList();for(h of g)g=document.createElement("OPTION"),g.text=lu(h.name),c.action.add(g);c.action.required=!0;var h=this.weap.GetProjectileList();for(var k of h)h=document.createElement("OPTION"),h.text=lu(k.name),c.projectile.add(h);c.projectile.required=!0;FlexSelect(lu("Weapons Type"),c.type,d);FlexSelect(lu("Seat Location"),c.seat,d);k=CreateFlexSection(d.div1);d=CreateFlexSection(d.div2);FlexInput(lu("Weapons Number of Mounts"),
c.count,k);FlexInput(lu("Weapons Ammunition"),c.ammo,d);FlexSelect(lu("Weapons Action"),c.action,k);FlexSelect(lu("Weapons Projectile"),c.projectile,d);FlexCheckbox(lu("Weapons Belt Fed"),c.repeating,k);FlexSpace(d);FlexCheckbox(lu("Fixed"),c.fixed,k);FlexSpace(d);h=this.weap.GetDirectionList();for(f=0;f<h.length;f+=2)e=lu(h[f]),g=document.createElement("INPUT"),FlexCheckbox(e,g,k),c.dirs.push(g),e=lu(h[f+1]),g=document.createElement("INPUT"),FlexCheckbox(e,g,d),c.dirs.push(g);c.wcell=b.insertCell();
d=b.insertCell();d.classList.toggle("inner_table");b=document.createElement("TABLE");b.classList.toggle("inner_table");d.appendChild(b);d=b.insertRow();CreateTH(d,lu("Stat Mass"));CreateTH(d,lu("Stat Drag"));CreateTH(d,lu("Stat Cost"));d=b.insertRow();c.stats.mass=d.insertCell();c.stats.drag=d.insertCell();c.stats.cost=d.insertCell();d=b.insertRow();CreateTH(d,lu("Stat Required Sections"));CreateTH(d,lu("Weapons Stat Mounting"));CreateTH(d,lu("Weapons Stat Jam"));d=b.insertRow();c.stats.sect=d.insertCell();
c.stats.mounting=d.insertCell();c.stats.jams=d.insertCell();d=b.insertRow();CreateTH(d,lu("Weapons Stat Hits"));CreateTH(d,lu("Weapons Stat Damage"));c.stats.shots_header=CreateTH(d,lu("Weapons Stat Shots"));b=b.insertRow();c.stats.hits=b.insertCell();c.stats.damg=b.insertCell();c.stats.shots=b.insertCell();this.tbl.appendChild(a);return c}CreateWRow(a){var b={span:document.createElement("SPAN"),wing:document.createElement("INPUT"),covered:document.createElement("INPUT"),accessible:document.createElement("INPUT"),
free_access:document.createElement("INPUT"),synch:document.createElement("SELECT"),count:document.createElement("INPUT")};CreateCheckbox(lu("Weapons Wing Mount"),b.wing,b.span,!1);CreateCheckbox(lu("Weapons Accessible"),b.accessible,b.span,!1);CreateCheckbox(lu("Weapons Free Accessible"),b.free_access,b.span,!1);CreateCheckbox(lu("Weapons Covered"),b.covered,b.span,!0);CreateInput(lu("Weapons # Weapons at Mount"),b.count,b.span,!1);CreateSelect(lu("Weapons Synchronization"),b.synch,b.span,!1);b.span.appendChild(document.createElement("HR"));
var c=this.weap.GetSynchronizationList();for(let d of c)c=document.createElement("OPTION"),c.text=lu(d),b.synch.add(c);a.appendChild(b.span);return b}UpdateWSet(a,b){b.type.selectedIndex=a.GetWeaponSelected();b.type.onchange=()=>{a.SetWeaponSelected(b.type.selectedIndex)};var c=this.weap.GetSeatList();if(b.seat.options.length!=c.length){for(;0<b.seat.options.length;)b.seat.options.remove(b.seat.options.length-1);for(var d of c)c=document.createElement("OPTION"),c.text=d,b.seat.add(c)}b.seat.selectedIndex=
a.GetSeat();b.seat.onchange=()=>{a.SetSeat(b.seat.selectedIndex)};b.count.valueAsNumber=a.GetMountingCount();b.count.onchange=()=>{a.SetMountingCount(b.count.valueAsNumber)};b.action.selectedIndex=a.GetAction();d=a.GetCanAction();for(c=0;c<d.length;c++)b.action.options[c].disabled=!d[c];b.action.onchange=()=>{a.SetAction(b.action.selectedIndex)};b.projectile.selectedIndex=a.GetProjectile();d=a.GetCanProjectile();for(c=0;c<d.length;c++)b.projectile.options[c].disabled=!d[c];b.projectile.onchange=()=>
{a.SetProjectile(b.projectile.selectedIndex)};b.repeating.checked=a.GetRepeating();b.repeating.onchange=()=>{a.SetRepeating(b.repeating.checked)};b.repeating.disabled=!a.CanRepeating();b.fixed.checked=a.GetFixed();b.fixed.onchange=()=>{a.SetFixed(b.fixed.checked)};d=a.GetDirection();c=a.CanDirection();for(let f=0;f<d.length;f++)b.dirs[f].checked=d[f],b.dirs[f].onchange=()=>{a.SetDirection(f,b.dirs[f].checked)},b.dirs[f].disabled=!c[f];b.ammo.valueAsNumber=a.GetAmmo();b.ammo.onchange=()=>{a.SetAmmo(b.ammo.valueAsNumber)};
for(var e=a.GetWeapons();b.weaps.length<e.length;)b.weaps.push(this.CreateWRow(b.wcell));for(;b.weaps.length>e.length;)d=b.weaps.pop(),b.wcell.removeChild(d.span);for(let f=0;f<e.length;f++)for(b.weaps[f].wing.checked=e[f].GetWing(),b.weaps[f].wing.onchange=()=>{e[f].SetWing(b.weaps[f].wing.checked)},b.weaps[f].wing.disabled=!e[f].CanWing(),b.weaps[f].covered.checked=e[f].GetCovered(),b.weaps[f].covered.onchange=()=>{e[f].SetCovered(b.weaps[f].covered.checked)},b.weaps[f].covered.disabled=!e[f].CanCovered(),
b.weaps[f].accessible.checked=e[f].GetAccessible(),b.weaps[f].accessible.onchange=()=>{e[f].SetAccessible(b.weaps[f].accessible.checked)},b.weaps[f].free_access.checked=e[f].GetFreeAccessible(),b.weaps[f].free_access.onchange=()=>{e[f].SetFreeAccessible(b.weaps[f].free_access.checked)},b.weaps[f].free_access.disabled=!(e[f].can_free_accessible||e[f].GetFreeAccessible()),b.weaps[f].count.valueAsNumber=e[f].GetCount(),b.weaps[f].count.onchange=()=>{e[f].SetCount(b.weaps[f].count.valueAsNumber)},b.weaps[f].synch.selectedIndex=
e[f].GetSynchronization()+1,b.weaps[f].synch.onchange=()=>{e[f].SetSynchronization(b.weaps[f].synch.selectedIndex-1)},b.weaps[f].synch.disabled=!e[f].can_synchronize,d=e[f].CanSynchronization(),c=0;c<d.length;c++)b.weaps[f].synch.options[c].disabled=!d[c];d=a.PartStats();BlinkIfChanged(b.stats.mass,d.mass.toString(),!1);BlinkIfChanged(b.stats.drag,d.drag.toString(),!1);BlinkIfChanged(b.stats.cost,d.cost.toString(),!1);BlinkIfChanged(b.stats.sect,d.reqsections.toString(),!1);d=a.GetHits();d=d[0].toString()+
"/"+d[1].toString()+"/"+d[2].toString()+"/"+d[3].toString();a.GetFixed()?BlinkIfChanged(b.stats.mounting,lu("Fixed")):2>=a.GetDirectionCount()?BlinkIfChanged(b.stats.mounting,lu("Flexible")):BlinkIfChanged(b.stats.mounting,lu("Turret"));BlinkIfChanged(b.stats.jams,a.GetJam());BlinkIfChanged(b.stats.hits,d);BlinkIfChanged(b.stats.damg,a.GetDamage().toString());a.GetProjectile()==ProjectileType.HEATRAY||a.IsLightningArc()?(d=a.GetHRCharges(),b.stats.shots_header.textContent=lu("Weapons Stat Charges"),
BlinkIfChanged(b.stats.shots,StringFmt.Join("/",d))):(b.stats.shots_header.textContent=lu("Weapons Stat Shots"),BlinkIfChanged(b.stats.shots,a.GetShots().toString()))}UpdateWSets(){var a=this.weap.GetWeaponSets();this.tbl.style.display=0==a.length?"none":"";for(this.inp_w_count.valueAsNumber=a.length;a.length>this.wrow.length;)this.wrow.push(this.CreateWSetRow());for(;a.length<this.wrow.length;)this.tbl.deleteRow(this.wrow.length),this.wrow.pop();for(let b=0;b<a.length;b++)this.UpdateWSet(a[b],this.wrow[b])}UpdateDisplay(){this.UpdateWSets();
this.inp_w_count.valueAsNumber=this.weap.GetWeaponSets().length;this.inp_w_brace.valueAsNumber=this.weap.GetBraceCount()}}
function WeaponName(a,b){var c=a.GetDirection(),d=0;for(let e of c)e&&d++;c="";c=1==d&&a.GetFixed()?c+(lu("Fixed")+" "):2>=d?c+(lu("Flexible")+" "):c+(lu("Turreted")+" ");a.GetAction()==ActionType.MECHANICAL?c+=lu("Weapon Tag Mechanical Action")+" ":a.GetAction()==ActionType.GAST?c+=lu("Weapon Tag Gast Principle")+" ":a.GetAction()==ActionType.ROTARY&&(c+=lu("Weapon Tag Rotary")+" ");a.GetProjectile()==ProjectileType.HEATRAY?c+=lu("Weapon Tag Heat Ray")+" ":a.GetProjectile()==ProjectileType.GYROJETS?
c+=lu("Weapon Tag Gyrojet")+" ":a.GetProjectile()==ProjectileType.PNEUMATIC&&(c+=lu("Weapon Tag Pneumatic")+" ");return c+b[a.GetWeaponSelected()].abrv}
function WeaponTags(a){var b=[lu("Weapon Tag Jam",a.GetJam())];let c=a.GetFinalWeapon();0<a.GetReload()&&(1==a.GetReload()?b.push(lu("Weapon Tag Manual")):b.push(lu("Weapon Tag Reload",a.GetReload())));c.rapid&&b.push(lu("Weapon Tag Rapid Fire"));c.shells&&b.push(lu("Weapon Tag Shells"));0<c.ap&&b.push(lu("Weapon Tag AP",c.ap));a.GetIsFullyAccessible()?b.push(lu("Weapon Tag Fully Accessible")):a.GetIsPartlyAccessible()?b.push(lu("Weapon Tag Partly Accessible")):b.push(lu("Weapon Tag Inaccessible"));
c.deflection&&b.push(lu("Weapon Tag Awkward",c.deflection));return b}
function WeaponString(a,b,c){for(var d="",e=a.GetDirection(),f=[],g=0;g<c.length;g++)e[g]&&f.push(lu(c[g]));c=a.GetHits();e=WeaponTags(a);a.GetProjectile()==ProjectileType.HEATRAY?(g=a.GetHRCharges(),d+=lu("Weapon Description Heat Ray",lu("Seat #",a.GetSeat()+1),a.GetWeaponCount(),this.WeaponName(a,b),StringFmt.Join(" ",f),b[a.GetWeaponSelected()].damage,StringFmt.Join("/",c),StringFmt.Join("/",g),StringFmt.Join(", ",e))):d+=lu("Weapon Description",lu("Seat #",a.GetSeat()+1),a.GetWeaponCount(),this.WeaponName(a,
b),StringFmt.Join(" ",f),b[a.GetWeaponSelected()].damage,StringFmt.Join("/",c),a.GetShots(),StringFmt.Join(", ",e));return d}
class Derived_HTML{constructor(a){var b=document.createDocumentFragment(),c=insertRow(b),d=c.insertCell();d.colSpan=2;this.name_inp=document.createElement("INPUT");this.name_inp.defaultValue=lu("Derived Aircraft Name");d.appendChild(this.name_inp);CreateTH(c,lu("Stat Cost"));this.cost_cell=c.insertCell();CreateTH(c,lu("Stat Upkeep"));this.upkeep_cell=c.insertCell();CreateTH(c,lu("Derived Era Report"));this.version_cell=c.insertCell();c=insertRow(b);CreateTH(c,lu("Derived Mass Variations"));CreateTH(c,
lu("Derived Boost"));CreateTH(c,lu("Derived Handling"));CreateTH(c,lu("Derived Rate of Climb"));CreateTH(c,lu("Derived Stall Speed"));CreateTH(c,lu("Derived Top Speed"));CreateTH(c,lu("Derived Vital Components")).colSpan=2;this.bomb_row2=insertRow(b);CreateTH(this.bomb_row2,lu("Derived Full Fuel with Bombs"));this.boost_fullwB=this.bomb_row2.insertCell();this.hand_fullwB=this.bomb_row2.insertCell();this.roc_fullwB=this.bomb_row2.insertCell();this.ss_fullwB=this.bomb_row2.insertCell();this.ts_fullwB=
this.bomb_row2.insertCell();this.vital_components=this.bomb_row2.insertCell();this.vital_components.rowSpan=3;this.vital_components.colSpan=3;this.bomb_row1=insertRow(b);CreateTH(this.bomb_row1,lu("Derived Half Fuel with Bombs"));this.boost_halfwB=this.bomb_row1.insertCell();this.hand_halfwB=this.bomb_row1.insertCell();this.roc_halfwB=this.bomb_row1.insertCell();this.ss_halfwB=this.bomb_row1.insertCell();this.ts_halfwB=this.bomb_row1.insertCell();this.full_row=insertRow(b);CreateTH(this.full_row,
lu("Derived Full Fuel"));this.boost_full=this.full_row.insertCell();this.hand_full=this.full_row.insertCell();this.roc_full=this.full_row.insertCell();this.ss_full=this.full_row.insertCell();this.ts_full=this.full_row.insertCell();c=insertRow(b);CreateTH(c,lu("Derived Half Fuel"));this.boost_half=c.insertCell();this.hand_half=c.insertCell();this.roc_half=c.insertCell();this.ss_half=c.insertCell();this.ts_half=c.insertCell();c=insertRow(b);CreateTH(c,lu("Derived Empty Fuel"));this.boost_empty=c.insertCell();
this.hand_empty=c.insertCell();this.roc_empty=c.insertCell();this.ss_empty=c.insertCell();this.ts_empty=c.insertCell();c=insertRow(b);CreateTH(c,lu("Derived Propulsion")).colSpan=2;CreateTH(c,lu("Derived Aerodynamics")).colSpan=2;CreateTH(c,lu("Derived Survivability")).colSpan=2;CreateTH(c,lu("Derived Crew Members")).colSpan=2;c=insertRow(b);CreateTH(c,lu("Derived Dropoff"));this.dropoff_cell=c.insertCell();CreateTH(c,lu("Derived Stability"));this.stability_cell=c.insertCell();CreateTH(c,lu("Derived Crash Safety"));
this.crashsafety_cell=c.insertCell();CreateTH(c,lu("Derived Crew/Passengers"));this.crew_cell=c.insertCell();c=insertRow(b);CreateTH(c,lu("Derived Overspeed"));this.overspeed_cell=c.insertCell();CreateTH(c,lu("Derived Energy Loss"));this.eloss_cell=c.insertCell();CreateTH(c,lu("Stat Toughness"));this.toughness_cell=c.insertCell();CreateTH(c,lu("Stat Visibility"));this.visibility_cell=c.insertCell();c=insertRow(b);CreateTH(c,lu("Derived Fuel Uses"));this.maxfuel_cell=c.insertCell();this.turnbleed_label=
CreateTH(c,lu("Derived Turn Bleed"));this.turnbleed_cell=c.insertCell();CreateTH(c,lu("Stat Max Strain"));this.mxstrain_cell=c.insertCell();CreateTH(c,lu("Derived Attack Modifier"));this.attack_cell=c.insertCell();c=insertRow(b);CreateTH(c,lu("Stat Reliability"));this.reliability_cell=c.insertCell();CreateTH(c,lu("Derived Landing Gear"));this.landing_cell=c.insertCell();CreateTH(c,lu("Derived Communications"));this.communications_cell=c.insertCell();CreateTH(c,lu("Derived Escape"));this.escape_cell=
c.insertCell();c=insertRow(b);CreateTH(c,lu("Derived Ideal Engine Altitude"));this.maxalt_cell=c.insertCell();CreateTH(c,lu("Derived Is Flammable Question"));this.flammable_cell=c.insertCell();this.desc_cell=c.insertCell();this.desc_cell.colSpan=2;CreateTH(c,lu("Stat Flight Stress"));this.flightstress_cell=c.insertCell();c=insertRow(b);d=insertRow(b);this.weapon_head=CreateTH(c,lu("Derived Weapon Systems"));this.weapon_head.colSpan=6;this.weapon_cell=d.insertCell();this.weapon_cell.colSpan=6;this.warning_head=
CreateTH(insertRow(b),lu("Derived Special Rules"));this.warning_head.colSpan=6;this.warning_cell=insertRow(b).insertCell();this.warning_cell.colSpan=6;CreateTH(c,lu("Derived Electrics")).colSpan=2;this.electric_cell=d.insertCell();this.electric_cell.colSpan=2;this.electric_cell.rowSpan=3;a.appendChild(b);this.tbl=a}UpdateDisplay(a,b,c){for(this.name_inp.value=a.name;0<this.version_cell.children.length;)this.version_cell.removeChild(this.version_cell.children[0]);this.version_cell.className="tooltip";
var d=document.createElement("DIV");d.className="tooltiptext";var e=document.createElement("P");e.textContent=lu("Derived Problematic Parts");d.appendChild(e);var f=era2numHl(a.GetEra().GetSelectedText());e=0;for(var g of b.era){var h=era2numHl(g.era);h>f&&(e+=h-f,h=document.createElement("P"),h.textContent=g.name+": "+g.era,d.appendChild(h))}0==e&&(g=document.createElement("P"),g.textContent=lu("None"),d.appendChild(g));g=document.createElement("P");g.textContent=lu(a.GetEra().GetSelectedText());
g.className=0==e?"green":2<e?"red":"yellow";this.version_cell.appendChild(g);this.version_cell.appendChild(d);this.cost_cell.textContent=b.cost.toString()+"\u00fe ";a.GetUsed().GetEnabled()&&(this.cost_cell.textContent+=" ("+Math.floor(1E-6+b.cost/2).toString()+"\u00fe "+lu("Price Word Used")+")");this.upkeep_cell.textContent=b.upkeep.toString()+"\u00fe";this.ts_empty.textContent=(0).toString();this.ss_empty.textContent=c.StallSpeedEmpty.toString();this.hand_empty.textContent=c.HandlingEmpty.toString();
this.boost_empty.textContent=(0).toString();this.roc_empty.textContent=(0).toString();this.ts_half.textContent=Math.floor(1E-6+(c.MaxSpeedEmpty+c.MaxSpeedFull)/2).toString();this.ss_half.textContent=Math.floor(1E-6+(c.StallSpeedEmpty+c.StallSpeedFull)/2).toString();this.hand_half.textContent=Math.floor(1E-6+(c.HandlingEmpty+c.HandlingFull)/2).toString();this.boost_half.textContent=Math.floor(1E-6+(c.BoostEmpty+c.BoostFull)/2).toString();this.roc_half.textContent=Math.floor(1E-6+(c.RateOfClimbEmpty+
c.RateOfClimbFull)/2).toString();this.ts_full.textContent=Math.floor(1E-6+c.MaxSpeedFull).toString();this.ss_full.textContent=c.StallSpeedFull.toString();this.hand_full.textContent=c.HandlingFull.toString();this.boost_full.textContent=c.BoostFull.toString();this.roc_full.textContent=c.RateOfClimbFull.toString();0<b.bomb_mass||this.show_bombs?(this.bomb_row1.hidden=!1,this.bomb_row2.hidden=!1,this.bomb_row2.appendChild(this.vital_components),this.vital_components.rowSpan=5,this.ts_halfwB.textContent=
Math.floor(1E-6+(c.MaxSpeedEmpty+c.MaxSpeedwBombs)/2).toString(),this.ss_halfwB.textContent=Math.floor(1E-6+(c.StallSpeedEmpty+c.StallSpeedFullwBombs)/2).toString(),this.hand_halfwB.textContent=Math.floor(1E-6+(c.HandlingEmpty+c.HandlingFullwBombs)/2).toString(),this.boost_halfwB.textContent=Math.floor(1E-6+(c.BoostEmpty+c.BoostFullwBombs)/2).toString(),this.roc_halfwB.textContent=Math.floor(1E-6+(c.RateOfClimbEmpty+c.RateOfClimbwBombs)/2).toString(),this.ts_fullwB.textContent=Math.floor(1E-6+c.MaxSpeedwBombs).toString(),
this.ss_fullwB.textContent=c.StallSpeedFullwBombs.toString(),this.hand_fullwB.textContent=c.HandlingFullwBombs.toString(),this.boost_fullwB.textContent=c.BoostFullwBombs.toString(),this.roc_fullwB.textContent=c.RateOfClimbwBombs.toString(),this.turnbleed_label.textContent=lu("Derived Turn Bleed wB"),this.turnbleed_cell.textContent=StringFmt.Format("{0} ({1})",c.TurnBleed,c.TurnBleedwBombs)):(this.bomb_row1.hidden=!0,this.bomb_row2.hidden=!0,this.full_row.appendChild(this.vital_components),this.vital_components.rowSpan=
3,this.turnbleed_label.textContent=lu("Derived Turn Bleed"),this.turnbleed_cell.textContent=StringFmt.Format("{0}",c.TurnBleed));this.dropoff_cell.textContent=c.Dropoff.toString();this.overspeed_cell.textContent=c.Overspeed.toString();this.maxfuel_cell.textContent=(Math.floor(1E-6+10*c.FuelUses)/10).toString();a.GetIsFlammable()?this.flammable_cell.textContent=lu("Yes"):this.flammable_cell.textContent=lu("No");this.stability_cell.textContent=c.Stabiilty.toString();this.eloss_cell.textContent=c.EnergyLoss.toString();
this.landing_cell.textContent=a.GetGearName();this.maxalt_cell.textContent=a.GetMinAltitude().toString()+"-"+a.GetMaxAltitude().toString();this.reliability_cell.textContent=StringFmt.Join(", ",a.GetReliabilityList());this.toughness_cell.textContent=c.Toughness.toString();this.mxstrain_cell.textContent=c.MaxStrain.toString();this.escape_cell.textContent=StringFmt.Join(", ",a.GetEscapeList());this.crashsafety_cell.textContent=b.crashsafety.toString();this.crew_cell.textContent=a.GetCockpits().GetNumberOfCockpits().toString()+
"/"+(a.GetPassengers().GetSeats()+a.GetPassengers().GetBeds()).toString();this.flightstress_cell.textContent=this.Stress2Str(a.GetStressList());this.visibility_cell.textContent=StringFmt.Join(", ",a.GetVisibilityList());this.attack_cell.textContent=StringFmt.Join(", ",a.GetAttackList());for(this.communications_cell.textContent=a.GetCommunicationName();0<this.electric_cell.childElementCount;)this.electric_cell.removeChild(this.electric_cell.firstChild);c=a.GetElectrics();d=CreateFlexSection(this.electric_cell);
0<c.storage&&FlexLabels(lu("Derived Battery"),c.storage.toString(),d);for(var k of c.equipment)FlexLabels(k.source,k.charge,d);k="";c=a.VitalComponentList();for(var l of c)k+=l+"<br/>";this.vital_components.innerHTML=k;l=a.GetWeapons().GetWeaponList();k=a.GetWeapons().GetDirectionList();f=a.GetMunitions().GetBombCount();d=a.GetMunitions().GetRocketCount();e=a.GetMunitions().GetInternalBombCount();c="";0<f&&(g=Math.min(f,e),f=Math.max(0,f-g),0<g&&(c+=lu(" Bomb Mass Internally.",g)),0<f&&(c+=lu(" Bomb Mass Externally.",
f)),0<g&&(f=Math.min(g,a.GetMunitions().GetMaxBombSize()),c+=lu("Largest Internal Bomb",f.toString())),e-=g,c+="<br/>");0<d&&(e=Math.min(d,e),d=Math.max(0,d-e),0<e&&(c+=lu(" Rocket Mass Internally.",e)),0<d&&(c+=lu(" Rocket Mass Externally.",d)),c+="<br/>");for(var n of a.GetWeapons().GetWeaponSets())c+=WeaponString(n,l,k),c+="<br>";this.weapon_cell.innerHTML=c;b.warnings.sort((u,q)=>u.color-q.color);n="";for(var m of b.warnings){switch(m.color){case WARNING_COLOR.RED:n+='<div style="color:#FF0000;">';
break;case WARNING_COLOR.YELLOW:n+='<div style="color:#FFFF00;">';break;default:n+='<div style="color:var(--inp_txt_color);;">'}n+=m.source+":  "+m.warning+"</div>"}this.warning_cell.innerHTML=n;b="";m=a.GetWings().GetWingList().length;1==m?(n=a.GetWings().GetWingList()[0].deck,b=n<WING_DECK.MID?b+"High-Wing Monoplane ":n==WING_DECK.MID?b+"Mid-Wing Monoplane ":b+"Low-Wing Monoplane "):b=a.GetWings().GetIsSesquiplane().is?2==m?b+"Sesquiplane ":b+("Sesqui-"+this.prefix(m)):a.GetWings().GetTandem()?
2==m&&a.GetWings().GetClosed()?b+"Annular Monoplane ":b+("Tandem "+this.prefix(m)):b+this.prefix(m);a.GetFrames().GetFlyingWing()?b+="Flying Wing ":a.GetFrames().CanFlyingWing()?b+="Lifting Body ":0==m&&(b+="Falling Rock ");this.desc_cell.textContent=b}prefix(a){switch(a){case 0:return"";case 1:return"Monoplane ";case 2:return"Biplane ";case 3:return"Triplane ";case 4:return"Quadruplane ";case 5:return"Pentaplane ";case 6:return"Hexaplane ";case 7:return"Heptaplane ";case 8:return"Octoplane ";case 9:return"Nonaplane ";
case 10:return"Decaplane ";case 11:return"Undecaplane ";case 12:return"Duodecaplane ";case 13:return"Tredecaplane ";case 14:return"Quattuordecaplane ";case 15:return"Quindecaplane ";case 16:return"Sexdecaplane ";case 17:return"Septendecaplane ";case 18:return"Octodecaplane ";case 19:return"Novendecaplane ";case 20:return"Vigintiplane ";default:return"Window Blinds "}}GetName(){return this.name_inp.value}SetName(a){this.name_inp.value=a}SetShowBombs(a){this.show_bombs=a}Stress2Str(a){for(var b="",
c=0;c<a.length-1;c++)b=2==a[c].length&&a[c][0]!=a[c][1]?b+(a[c][0].toString()+"("+a[c][1].toString()+"), "):b+(a[c][0].toString()+", ");0<a.length&&(c=a.length-1,b=2==a[c].length&&a[c][0]!=a[c][1]?b+(a[c][0].toString()+"("+a[c][1].toString()+")"):b+a[c][0].toString());return b}}var FUEL_STATE;(function(a){a[a.FULLWBOMBS=0]="FULLWBOMBS";a[a.HALFWBOMBS=1]="HALFWBOMBS";a[a.FULL=2]="FULL";a[a.HALF=3]="HALF";a[a.EMPTY=4]="EMPTY"})(FUEL_STATE||={});
class Altitude_HTML{constructor(a){document.getElementById("lbl_altitude").textContent=lu("Altitude Section Title");this.tbl=document.getElementById("table_altitude");this.fuel_state=document.getElementById("select_fuelstate");let b=document.createElement("OPTION");b.textContent=lu("Derived Full Fuel with Bombs");this.fuel_state.appendChild(b);b=document.createElement("OPTION");b.textContent=lu("Derived Half Fuel with Bombs");this.fuel_state.appendChild(b);b=document.createElement("OPTION");b.textContent=
lu("Derived Full Fuel");this.fuel_state.appendChild(b);b=document.createElement("OPTION");b.textContent=lu("Derived Half Fuel");this.fuel_state.appendChild(b);this.fuel_state.onchange=()=>{a()};this.fires=document.getElementById("input_fires");this.fires.onchange=()=>{a()};this.oxidized=document.getElementById("input_oxidized");this.oxidized.onchange=()=>{a()};this.fRow=insertRow(this.tbl);CreateTH(this.fRow,lu("Altitude Altitude"));CreateTH(this.fRow,lu("Derived Boost"));CreateTH(this.fRow,lu("Derived Rate of Climb"));
CreateTH(this.fRow,lu("Derived Stall Speed"));CreateTH(this.fRow,lu("Derived Top Speed"));this.rows=[]}AddRow(a){var b=document.createElement("TR");b.insertCell().textContent=StringFmt.Format("{0}-{1}",10*a,10*a+9);b.insertCell();b.insertCell();b.insertCell();b.insertCell();this.rows.push(b)}UpdateDisplay(a,b){for(;this.tbl.lastChild;)this.tbl.removeChild(this.tbl.lastChild);var c=document.createDocumentFragment();c.appendChild(this.fRow);var d=0,e=0,f=0,g=0;switch(this.fuel_state.selectedIndex){case FUEL_STATE.FULLWBOMBS:d=
b.BoostFullwBombs;e=b.RateOfClimbwBombs;f=b.StallSpeedFullwBombs;g=b.MaxSpeedwBombs;break;case FUEL_STATE.HALFWBOMBS:d=Math.floor(1E-6+(b.BoostEmpty+b.BoostFullwBombs)/2);e=Math.floor(1E-6+(b.RateOfClimbEmpty+b.RateOfClimbwBombs)/2);f=Math.floor(1E-6+(b.StallSpeedEmpty+b.StallSpeedFullwBombs)/2);g=Math.floor(1E-6+(b.MaxSpeedEmpty+b.MaxSpeedwBombs)/2);break;case FUEL_STATE.FULL:d=b.BoostFull;e=b.RateOfClimbFull;f=b.StallSpeedFull;g=b.MaxSpeedFull;break;case FUEL_STATE.HALF:d=Math.floor(1E-6+(b.BoostEmpty+
b.BoostFull)/2),e=Math.floor(1E-6+(b.RateOfClimbEmpty+b.RateOfClimbFull)/2),f=Math.floor(1E-6+(b.StallSpeedEmpty+b.StallSpeedFull)/2),g=Math.floor(1E-6+(b.MaxSpeedEmpty+b.MaxSpeedFull)/2)}for(let m=0;100>m;m++){var h=b=0;if(m<a.GetMinIAF())b=a.GetMinIAF()-m;else{var k=a.GetMaxIAF();this.oxidized.checked&&(k+=3);h=Math.min(m-a.GetMinIAF(),k-a.GetMinIAF());m>k&&(b=m-k)}this.fires.checked&&(b=0);this.rows.length<=m&&this.AddRow(m);k=this.rows[m];var l=Math.max(1,e-b),n=Math.max(1,f+m);h=Math.max(1,g+
h-b);k.children[1].textContent=(0<b?Math.max(1,d-1):d).toString();k.children[2].textContent=l.toString();k.children[3].textContent=n.toString();k.children[4].textContent=h.toString();c.appendChild(k);if(n>h){for(;this.rows.length>m;)this.rows.pop();break}}this.tbl.appendChild(c)}}var ENGINE_TEXT;(function(a){a[a.SINGLE=0]="SINGLE";a[a.PUSHER=1]="PUSHER";a[a.PULLER=2]="PULLER"})(ENGINE_TEXT||={});
class Cards{constructor(){this.dash_canvas=document.createElement("CANVAS");this.dash_canvas.width=1122;this.dash_canvas.height=786;this.dash_image=document.getElementById("dash_img");this.dash_image.width=1122;this.dash_image.height=786;this.weap_canvas=document.createElement("CANVAS");this.weap_canvas.width=483;this.weap_canvas.height=291;this.weap_image=document.getElementById("weap_img");this.weap_image.width=483;this.weap_image.height=291;this.eng_canvas=document.createElement("CANVAS");this.eng_canvas.width=
600;this.eng_canvas.height=360;this.eng_image=document.getElementById("eng_img");this.eng_image.width=600;this.eng_image.height=360;this.rad_canvas=document.createElement("CANVAS");this.rad_canvas.width=479;this.rad_canvas.height=290;this.rad_image=document.getElementById("rad_img");this.rad_image.width=479;this.rad_image.height=290;this.npc_canvas=document.createElement("CANVAS");this.npc_canvas.width=482;this.npc_canvas.height=290;this.npc_image=document.getElementById("npc_img");this.npc_image.width=
482;this.npc_image.height=290;this.acft_data={full_bomb_boost:0,half_bomb_boost:0,full_boost:0,half_boost:0,empty_boost:0,full_bomb_hand:0,half_bomb_hand:0,full_hand:0,half_hand:0,empty_hand:0,full_bomb_climb:0,half_bomb_climb:0,full_climb:0,half_climb:0,empty_climb:0,full_bomb_stall:0,half_bomb_stall:0,full_stall:0,half_stall:0,empty_stall:0,full_bomb_speed:0,half_bomb_speed:0,full_speed:0,half_speed:0,empty_speed:0,fuel:0,dropoff:0,ordinance:[""],escape:0,crash:0,visibility:0,energy_loss:0,turn_bleed:0,
stability:0,stress:0,toughness:0,max_strain:0,vital_parts:[""],armour:[],warnings:[{source:"",warning:""}]};this.weap_data={type:"",abrv:"",ammo:0,ap:0,jam:"",hits:[],damage:[],tags:[],reload:0,gyrojet:!1};this.eng_data={reliability:"0",min_IAF:0,altitude:0,overspeed:0,radiator:0,notes:[]};this.rad_data={mount_type:"",coolant_type:""}}SaveDash(){var a=this.dash_canvas.getContext("2d");a.clearRect(0,0,this.dash_canvas.width,this.dash_canvas.height);a.textAlign="center";a.drawImage(this.dash_image,
0,0);a.font="35px Balthazar";a.fillText(this.acft_data.full_bomb_boost.toString(),493,94,80);a.fillText(this.acft_data.full_bomb_hand.toString(),555,94,80);a.fillText(this.acft_data.full_bomb_climb.toString(),617,94,80);a.fillText(this.acft_data.full_bomb_stall.toString(),679,94,80);a.fillText(this.acft_data.full_bomb_speed.toString(),741,94,80);a.fillText(this.acft_data.half_bomb_boost.toString(),493,134,80);a.fillText(this.acft_data.half_bomb_hand.toString(),555,134,80);a.fillText(this.acft_data.half_bomb_climb.toString(),
617,134,80);a.fillText(this.acft_data.half_bomb_stall.toString(),679,134,80);a.fillText(this.acft_data.half_bomb_speed.toString(),741,134,80);a.fillText(this.acft_data.full_boost.toString(),493,174,80);a.fillText(this.acft_data.full_hand.toString(),555,174,80);a.fillText(this.acft_data.full_climb.toString(),617,174,80);a.fillText(this.acft_data.full_stall.toString(),679,174,80);a.fillText(this.acft_data.full_speed.toString(),741,174,80);a.fillText(this.acft_data.half_boost.toString(),493,214,80);
a.fillText(this.acft_data.half_hand.toString(),555,214,80);a.fillText(this.acft_data.half_climb.toString(),617,214,80);a.fillText(this.acft_data.half_stall.toString(),679,214,80);a.fillText(this.acft_data.half_speed.toString(),741,214,80);a.fillText("0",493,254,80);a.fillText(this.acft_data.empty_hand.toString(),555,254,80);a.fillText("0",617,254,80);a.fillText(this.acft_data.empty_stall.toString(),679,254,80);a.fillText("0",741,254,80);a.fillText(Math.floor(this.acft_data.fuel).toString(),417,310,
35);a.fillText(this.acft_data.dropoff.toString(),1048,375,35);a.fillText(this.acft_data.escape.toString(),85,640,35);a.fillText(this.acft_data.crash.toString(),85,720,35);a.fillText(this.acft_data.visibility.toString(),135,460,35);a.fillText(this.acft_data.stability.toString(),135,550,35);a.fillText(this.acft_data.energy_loss.toString(),70,505,35);a.fillText(this.acft_data.turn_bleed.toString(),195,505,35);a.fillText(this.acft_data.stress.toString(),285,495,35);a.fillText(this.acft_data.toughness.toString(),
250,645,35);a.fillText(this.acft_data.max_strain.toString(),250,720,35);a.font="20px Balthazar";a.textAlign="left";for(var b=Math.min(this.acft_data.ordinance.length,2),c=Math.ceil(-1E-6+this.acft_data.ordinance.length/b),d=0,e=0;e<b;e++){for(var f=612+27*e,g="",h=0;h<c;h++)d<this.acft_data.ordinance.length&&(0!=h&&(g+=", "),g+=this.acft_data.ordinance[d]),d++;a.fillText(g,335,f,370)}b=Math.min(this.acft_data.vital_parts.length,5);c=Math.ceil(-1E-6+this.acft_data.vital_parts.length/b);for(e=d=0;e<
b;e++){f=392+27*e;g="";for(h=0;h<c;h++)d<this.acft_data.vital_parts.length&&(0!=h&&(g+=", "),g+=this.acft_data.vital_parts[d]),d++;a.fillText(g,335,f,370)}d="";for(b=0;b<this.acft_data.armour.length;++b)c=b+1,0<this.acft_data.armour[b]&&(d=""!=d?d+", ":d+(lu("Armour")+" "),d+=c.toString()+"/+"+(11-this.acft_data.armour[b]).toString());a.fillText(d,335,558,375);a.font="14px Balthazar";d=1;for(b=0;b<this.acft_data.warnings.length;++b)this.acft_data.warnings[b].source!=lu("Armour")&&(c=this.acft_data.warnings[b].source+
": "+this.acft_data.warnings[b].warning,6==d&&this.acft_data.warnings.length>b+1?a.fillText(lu("Cards Too Many Warnings Warning"),335,673+14*d,370):6<d||a.fillText(c,335,673+14*d,370),d++);this.download(this.name+"_Dashboard",this.dash_canvas)}SaveWeapon(a){a++;var b=this.weap_canvas.getContext("2d");b.clearRect(0,0,this.weap_canvas.width,this.weap_canvas.height);b.textAlign="center";b.drawImage(this.weap_image,0,0);b.font="25px Balthazar";b.fillText(this.weap_data.type,150,112,215);b.font="15px Balthazar";
var c="";0<this.weap_data.reload?(c+=lu("Cards Gun String Reload",(this.weap_data.ammo/this.weap_data.reload).toString(),this.weap_data.reload.toString()),this.weap_data.tags.push(lu("Weapon Tag Reload",this.weap_data.reload.toString()))):c+=lu("Cards Gun String No Reload",this.weap_data.ammo);b.fillText(c,95,158,105);b.fillText(this.weap_data.ap.toString(),172,158,23);b.fillText(this.weap_data.jam,230,158,65);b.fillText(this.weap_data.hits[0].toString(),157,208,80);b.fillText(this.weap_data.hits[1].toString(),
237,208,80);b.fillText(this.weap_data.hits[2].toString(),317,208,80);b.fillText(this.weap_data.hits[3].toString(),397,208,80);b.fillText(Math.floor(1E-6+this.weap_data.damage[0]).toString(),157,231,80);b.fillText(Math.floor(1E-6+this.weap_data.damage[1]).toString(),237,231,80);b.fillText(Math.floor(1E-6+this.weap_data.damage[2]).toString(),317,231,80);b.fillText(Math.floor(1E-6+this.weap_data.damage[3]).toString(),397,231,80);b.textAlign="left";b.fillText(this.weap_data.tags[0],90,256,350);c="";for(let d=
1;d<this.weap_data.tags.length;d++)1!=d&&(c+=", "),c+=this.weap_data.tags[d];b.fillText(c,90,276,350);this.download(this.name+"_Weapon_"+a.toString(),this.weap_canvas)}SaveEngine(a,b=ENGINE_TEXT.SINGLE){a++;var c=this.eng_canvas.getContext("2d");c.clearRect(0,0,this.eng_canvas.width,this.eng_canvas.height);c.drawImage(this.eng_image,0,0);c.textAlign="center";c.font="18px Balthazar";c.fillStyle="#000";c.strokeStyle="#000";c.fillText(this.eng_data.reliability,235,75,110);c.fillText(this.eng_data.min_IAF.toString()+
"-"+(this.eng_data.min_IAF+this.eng_data.altitude).toString(),347,75,110);c.fillText(this.eng_data.overspeed.toString(),480,75,110);var d="";for(let e=0;e<this.eng_data.notes.length;e++)0!=e&&(d+=", "),d+=this.eng_data.notes[e];c.fillText(d,365,105,306);0<=this.eng_data.radiator&&c.fillText(lu("Cards Uses Radiator",this.eng_data.radiator+1),109,340,270);c.textAlign="right";c.font="30px Balthazar";c.fillStyle="#fff";c.strokeStyle="#fff";c.fillText("#"+a.toString(),37,67,35);switch(b){case ENGINE_TEXT.SINGLE:this.download(this.name+
"_Engine_"+a.toString(),this.eng_canvas);break;case ENGINE_TEXT.PUSHER:this.download(this.name+"_Engine_"+a.toString()+"_Pusher",this.eng_canvas);break;case ENGINE_TEXT.PULLER:this.download(this.name+"_Engine_"+a.toString()+"_Puller",this.eng_canvas)}}SaveRadiator(a){a++;var b=this.rad_canvas.getContext("2d");b.clearRect(0,0,this.rad_canvas.width,this.rad_canvas.height);b.drawImage(this.rad_image,0,0);b.textAlign="center";b.font="25px Balthazar";b.fillStyle="#000";b.strokeStyle="#000";b.fillText(this.rad_data.mount_type,
162,141,230);b.fillText(this.rad_data.coolant_type,162,217,230);b.textAlign="right";b.font="25px Balthazar";b.fillStyle="#fff";b.strokeStyle="#fff";b.fillText("#"+a.toString(),37,56,35);this.download(this.name+"_Radiator_"+a.toString(),this.rad_canvas)}SaveNPC(){var a=this.npc_canvas.getContext("2d");a.clearRect(0,0,this.npc_canvas.width,this.npc_canvas.height);a.drawImage(this.npc_image,0,0);a.font="20px Balthazar";a.textAlign="center";a.fillStyle="#000";a.strokeStyle="#000";a.fillText(this.name,
100,100,145);a.fillText(""+this.lowest_overspeed,70,158,40);a.fillText(""+this.acft_data.full_speed,126,158,40);a.fillText(""+(this.acft_data.full_speed-this.acft_data.turn_bleed-Math.floor(1E-6+.1*this.acft_data.full_speed)),187,158,40);a.fillText(""+this.acft_data.full_stall,245,158,40);a.fillText(""+(this.acft_data.toughness+this.acft_data.max_strain),70,236,40);a.fillText(""+this.acft_data.full_hand,123,236,40);if(this.all_weapons[0]){var b=this.all_weapons[0];a.font="12px Avenir";a.fillText(b.abrv,
232,71,91);a.font="20px Balthazar";var c=StringFmt.Join("/",[b.hits[0],b.hits[1],b.hits[2],b.hits[3]]);b=StringFmt.Join("/",[Math.floor(1E-6+b.damage[0]),Math.floor(1E-6+b.damage[1]),Math.floor(1E-6+b.damage[2]),Math.floor(1E-6+b.damage[3])]);a.fillText(c,320,71,80);a.fillText(b,401,71,80)}this.all_weapons[1]&&(b=this.all_weapons[1],a.font="12px Avenir",a.fillText(b.abrv,232,103,91),a.font="20px Balthazar",c=StringFmt.Join("/",[b.hits[0],b.hits[1],b.hits[2],b.hits[3]]),b=StringFmt.Join("/",[Math.floor(1E-6+
b.damage[0]),Math.floor(1E-6+b.damage[1]),Math.floor(1E-6+b.damage[2]),Math.floor(1E-6+b.damage[3])]),a.fillText(c,320,103,80),a.fillText(b,401,103,80));this.download(this.name+"_NPC",this.npc_canvas)}download(a,b){var c=document.createElement("a");c.download=a+".png";c.href=b.toDataURL();document.createEvent&&(a=document.createEvent("MouseEvents"),a.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),c.dispatchEvent(a))}}
class Aircraft_HTML extends Display{constructor(a,b){super();this.acft=b;this.era=new Era_HTML(this.acft.GetEra());this.cockpits=new Cockpits_HTML(b.GetCockpits());this.passengers=new Passengers_HTML(b.GetPassengers());this.engines=new Engines_HTML(b.GetEngines());this.propeller=new Propeller_HTML(b.GetPropeller());this.frames=new Frames_HTML(b.GetFrames());this.wings=new Wings_HTML(b.GetWings());this.stabilizers=new Stabilizers_HTML(b.GetStabilizers());this.controlsurfaces=new ControlSurfaces_HTML(b.GetControlSurfaces());
this.reinforcements=new Reinforcement_HTML(b.GetReinforcements());this.load=new Load_HTML(b.GetFuel(),b.GetMunitions(),b.GetCargoAndPassengers());this.gear=new LandingGear_HTML(b.GetLandingGear());this.accessories=new Accessories_HTML(b.GetAccessories());this.optimization=new Optimization_HTML(b.GetOptimization());this.weapons=new Weapons_HTML(b.GetWeapons());this.used=new Used_HTML(b.GetUsed());this.rotor=new Rotor_HTML(b.GetRotor());this.alter=new AlterStats_HTML(b.GetAlter());this.altitude=new Altitude_HTML(()=>
{this.UpdateDisplay()});document.getElementById("lbl_acft_type").textContent=lu("Aircraft Type Section Title");this.acft_type=document.getElementById("acft_type");a=0;for(var c in AIRCRAFT_TYPE)isNaN(Number(c))&&(a+=1,2!=a&&(b=document.createElement("OPTION"),b.text=lu(c),this.acft_type.add(b)));this.acft_type.onchange=()=>{let g=this.acft_type.selectedIndex;1<=g&&(g+=1);this.acft.SetType(g)};document.getElementById("lbl_stats").textContent=lu("Aircraft Stats Section Title");c=document.getElementById("tbl_stats");
this.InitStats(c);document.getElementById("lbl_derived").textContent=lu("Aircraft Derived Section Title");c=document.getElementById("tbl_derived");this.InitDerived(c);this.acft.SetDisplayCallback(()=>{this.UpdateDisplay()});document.getElementById("lbl_acft_save_top").textContent=lu("Aircraft Button Save");document.getElementById("lbl_acft_save_bot").textContent=lu("Aircraft Button Save");document.getElementById("acft_save").onclick=()=>{this.SaveJSON()};document.getElementById("lbl_acft_load_top").textContent=
lu("Aircraft Button Load");document.getElementById("lbl_acft_load_bot").textContent=lu("Aircraft Button Load");var d=document.getElementById("acft_load");d.multiple=!1;d.accept="application/JSON";d.onchange=g=>{this.LoadJSON(d)};var e=document.getElementById("acft_load_text");e.onchange=()=>{this.LoadText(e)};var f=document.getElementById("acft_load_text2");f.onchange=()=>{this.LoadText(f)};document.getElementById("lbl_acft_save_link_top").textContent=lu("Aircraft Button Copy As Link");document.getElementById("lbl_acft_save_link_bot").textContent=
lu("Aircraft Button Copy As Link");document.getElementById("acft_save_link").onclick=()=>{this.SaveLink()};this.cards=new Cards;document.getElementById("lbl_acft_save_dash_top").textContent=lu("Aircraft Button Save Dashboard");document.getElementById("lbl_acft_save_dash_bot").textContent=lu("Aircraft Button Save Dashboard");document.getElementById("acft_save_dash").onclick=()=>{this.SaveDash()};document.getElementById("lbl_acft_interactive_dash_top").textContent=lu("Aircraft Button Interactive Dashboard");
document.getElementById("lbl_acft_interactive_dash_bot").textContent=lu("Aircraft Button Interactive Dashboard");document.getElementById("acft_interactive_dash").onclick=()=>{this.SaveInteractive()};document.getElementById("lbl_acft_save_npc_top").textContent=lu("Aircraft Button Save NPC");document.getElementById("lbl_acft_save_npc_bot").textContent=lu("Aircraft Button Save NPC");document.getElementById("acft_save_npc").onclick=()=>{this.SaveNPC()};document.getElementById("lbl_acft_reset_top").textContent=
lu("Aircraft Button Default Aircraft");document.getElementById("lbl_acft_reset_bot").textContent=lu("Aircraft Button Default Aircraft");document.getElementById("acft_reset").onclick=()=>{this.acft.Reset();this.derived.SetName(this.acft.name);this.acft.CalculateStats()};document.getElementById("lbl_acft_save_cat_top").textContent=lu("Aircraft Button Save Catalog");document.getElementById("lbl_acft_save_cat_bot").textContent=lu("Aircraft Button Save Catalog");document.getElementById("acft_save_cat").onclick=
()=>{this.CatalogStats()}}UpdateCard(){this.acft.name=this.derived.GetName();var a=this.acft.GetStats(),b=this.acft.GetDerivedStats();this.cards.name=this.acft.name;this.cards.acft_data.armour=this.acft.GetAccessories().GetEffectiveCoverage();this.cards.acft_data.crash=a.crashsafety;this.cards.acft_data.dropoff=b.Dropoff;this.cards.acft_data.empty_boost=b.BoostEmpty;this.cards.acft_data.empty_hand=b.HandlingEmpty;this.cards.acft_data.empty_climb=b.RateOfClimbEmpty;this.cards.acft_data.empty_stall=
b.StallSpeedEmpty;this.cards.acft_data.empty_speed=Math.floor(1E-6+b.MaxSpeedEmpty);this.cards.acft_data.energy_loss=b.EnergyLoss;this.cards.acft_data.escape=this.acft.GetCockpits().GetEscapeList()[0];this.cards.acft_data.fuel=b.FuelUses;this.cards.acft_data.full_bomb_boost=b.BoostFullwBombs;this.cards.acft_data.full_bomb_hand=b.HandlingFullwBombs;this.cards.acft_data.full_bomb_climb=b.RateOfClimbwBombs;this.cards.acft_data.full_bomb_stall=b.StallSpeedFullwBombs;this.cards.acft_data.full_bomb_speed=
b.MaxSpeedwBombs;this.cards.acft_data.full_boost=b.BoostFull;this.cards.acft_data.full_hand=b.HandlingFull;this.cards.acft_data.full_climb=b.RateOfClimbFull;this.cards.acft_data.full_stall=b.StallSpeedFull;this.cards.acft_data.full_speed=Math.floor(1E-6+b.MaxSpeedFull);this.cards.acft_data.half_bomb_boost=Math.floor((b.BoostFullwBombs+b.BoostEmpty)/2);this.cards.acft_data.half_bomb_hand=Math.floor((b.HandlingFullwBombs+b.HandlingEmpty)/2);this.cards.acft_data.half_bomb_climb=Math.floor(1E-6+(b.RateOfClimbEmpty+
b.RateOfClimbwBombs)/2);this.cards.acft_data.half_bomb_stall=Math.floor((b.StallSpeedFullwBombs+b.StallSpeedEmpty)/2);this.cards.acft_data.half_bomb_speed=Math.floor(1E-6+(b.MaxSpeedEmpty+b.MaxSpeedwBombs)/2);this.cards.acft_data.half_boost=Math.floor((b.BoostFull+b.BoostEmpty)/2);this.cards.acft_data.half_hand=Math.floor((b.HandlingFull+b.HandlingEmpty)/2);this.cards.acft_data.half_climb=Math.floor(1E-6+(b.RateOfClimbEmpty+b.RateOfClimbFull)/2);this.cards.acft_data.half_stall=Math.floor((b.StallSpeedFull+
b.StallSpeedEmpty)/2);this.cards.acft_data.half_speed=Math.floor(1E-6+(b.MaxSpeedEmpty+b.MaxSpeedFull)/2);this.cards.acft_data.max_strain=b.MaxStrain;var c=[],d=this.acft.GetMunitions().GetBombCount(),e=this.acft.GetMunitions().GetRocketCount(),f=this.acft.GetMunitions().GetInternalBombCount();if(0<d){var g=Math.min(d,f);d=Math.max(0,d-g);0<g&&c.push(lu(" Bomb Mass Internally.",g));0<d&&c.push(lu(" Bomb Mass Externally.",d));0<g&&(d=Math.min(g,this.acft.GetMunitions().GetMaxBombSize()),c.push(lu("Largest Internal Bomb",
d.toString())));f-=g}0<e&&(f=Math.min(e,f),e=Math.max(0,e-f),0<f&&c.push(lu(" Rocket Mass Internally.",f)),0<e&&c.push(lu(" Rocket Mass Externally.",e)));this.cards.acft_data.ordinance=c;this.cards.acft_data.stability=b.Stabiilty;this.cards.acft_data.stress=this.acft.GetCockpits().GetStressList()[0][0];this.cards.acft_data.toughness=b.Toughness;this.cards.acft_data.turn_bleed=b.TurnBleed;this.cards.acft_data.visibility=this.acft.GetCockpits().GetVisibilityList()[0];this.cards.acft_data.vital_parts=
this.acft.VitalComponentList();this.cards.acft_data.warnings=a.warnings}UpdateWeaponCard(a){var b=this.acft.GetWeapons().GetWeaponList(),c=this.acft.GetWeapons().GetDirectionList(),d=WeaponName(a,b);a.IsPlural()&&(d=a.GetWeaponCount().toString()+"x "+d);var e=a.GetDirection(),f="[";for(let g=0;g<c.length;g++)e[g]&&(f+=lu(c[g])+" ");f=f.substr(0,f.length-1);f+="] ";c=a.GetFinalWeapon();this.cards.weap_data.ammo=a.GetShots();this.cards.weap_data.ap=c.ap;this.cards.weap_data.hits=a.GetHits();"PR"==b[a.GetWeaponSelected()].abrv?
this.cards.weap_data.damage=[5,5,5,5]:this.cards.weap_data.damage=[c.damage*this.cards.weap_data.hits[0],c.damage*this.cards.weap_data.hits[1],c.damage*this.cards.weap_data.hits[2],c.damage*this.cards.weap_data.hits[3]];this.cards.weap_data.jam=a.GetJam();this.cards.weap_data.tags=[f];this.cards.weap_data.type=d;this.cards.weap_data.abrv=c.abrv;this.cards.weap_data.reload=c.reload;this.cards.weap_data.tags.concat(WeaponTags(a))}UpdateEngineCard(a){var b=a.GetCurrentStats();this.cards.eng_data.reliability=
a.GetReliability();this.cards.eng_data.overspeed=a.GetOverspeed();this.cards.eng_data.altitude=b.altitude;a.NeedCooling()?this.cards.eng_data.radiator=a.GetRadiator():this.cards.eng_data.radiator=-1;this.cards.eng_data.notes=[];b.pulsejet?(this.cards.eng_data.notes.push(lu("Pulsejet")),""!=a.GetSelectedList()&&(a=engine_list.get(a.GetSelectedList()).get_name(b.name),0<a.power&&a.starter&&this.cards.eng_data.notes.push(lu("Starter")))):(a.IsRotary()&&a.IsTractor()?this.cards.eng_data.notes.push(lu("Turns Right")):
a.IsRotary()&&a.IsPusher()&&this.cards.eng_data.notes.push(lu("Turns Left")),""!=a.GetSelectedList()&&(a=engine_list.get(a.GetSelectedList()).get_name(b.name),this.cards.eng_data.min_IAF=a.min_IdealAlt,a.upgrades[1]?this.cards.eng_data.notes.push(lu("War Emergency Power")):0<a.compressor_count&&1==a.compressor_type&&this.cards.eng_data.notes.push(lu("War Emergency Power from altitudes 0-9"))))}UpdateRadiatorCard(a){this.cards.rad_data.mount_type=lu(a.GetMountList()[a.GetMountIndex()].name);this.cards.rad_data.coolant_type=
lu(a.GetCoolantList()[a.GetCoolantIndex()].name)}LoadJSON(a){if(0!=a.files.length){var b=a.files[0],c=new FileReader;c.onloadend=()=>{try{var d=JSON.parse(c.result);(new Aircraft(parts_JSON,weapon_JSON,!1)).fromJSON(d)&&(d=JSON.parse(c.result),console.log(d),this.acft.fromJSON(d),this.derived.SetName(this.acft.name),this.acft.CalculateStats())}catch(e){console.error(e,e.stack)}};c.readAsText(b);a.value=""}}Stress2Str(a){for(var b="",c=0;c<a.length-1;c++)b=2==a[c].length&&a[c][0]!=a[c][1]?b+(a[c][0].toString()+
"("+a[c][1].toString()+"), "):b+(a[c][0].toString()+", ");0<a.length&&(c=a.length-1,b=2==a[c].length&&a[c][0]!=a[c][1]?b+(a[c][0].toString()+"("+a[c][1].toString()+")"):b+a[c][0].toString());return b}CatalogStats(){this.acft.name=this.derived.GetName();var a=this.acft.GetStats(),b=this.acft.GetDerivedStats(),c=this.MakeLink()+"\n";c+=this.acft.name+"\n";c=c+"Insert Nickname Here\n"+StringFmt.Format("{0}\u00fe New, {1}\u00fe Used\n",a.cost,Math.floor(1E-6+a.cost/2));c+=StringFmt.Format("{0}\u00fe Upkeep\n\n",
a.upkeep);0<a.bomb_mass&&(c+=StringFmt.Format("Full Load\t{0}\t{1}\t{2}\t{3}\t{4}\n",b.BoostFullwBombs,b.HandlingFullwBombs,b.RateOfClimbwBombs,b.StallSpeedFullwBombs,b.MaxSpeedwBombs),c+=StringFmt.Format("\u00bd, Bombs\t{0}\t{1}\t{2}\t{3}\t{4}\n",Math.floor(1E-6+(b.BoostEmpty+b.BoostFullwBombs)/2),Math.floor(1E-6+(b.HandlingEmpty+b.HandlingFullwBombs)/2),Math.floor(1E-6+(b.RateOfClimbEmpty+b.RateOfClimbwBombs)/2),Math.floor(1E-6+(b.StallSpeedEmpty+b.StallSpeedFullwBombs)/2),Math.floor(1E-6+(b.MaxSpeedEmpty+
b.MaxSpeedwBombs)/2)));c+=StringFmt.Format("Full Fuel\t{0}\t{1}\t{2}\t{3}\t{4}\n",b.BoostFull,b.HandlingFull,b.RateOfClimbFull,b.StallSpeedFull,b.MaxSpeedFull);c+=StringFmt.Format("Half Fuel\t{0}\t{1}\t{2}\t{3}\t{4}\n",Math.floor(1E-6+(b.BoostEmpty+b.BoostFull)/2),Math.floor(1E-6+(b.HandlingEmpty+b.HandlingFull)/2),Math.floor(1E-6+(b.RateOfClimbEmpty+b.RateOfClimbFull)/2),Math.floor(1E-6+(b.StallSpeedEmpty+b.StallSpeedFull)/2),Math.floor(1E-6+(b.MaxSpeedEmpty+b.MaxSpeedFull)/2));c+=StringFmt.Format("Empty\t\t{0}\t{1}\t{2}\t{3}\t{4}\n",
"-",b.HandlingEmpty,"-",b.StallSpeedEmpty,0);c=c+"\nVital Parts\n"+StringFmt.Join(", ",this.acft.VitalComponentList());c=c+"\n\n"+StringFmt.Format("Dropoff {0}, Reliability {1}, Overspeed {2}, Ideal Alt. {3}, Fuel {4}\n\n",b.Dropoff,StringFmt.Join("/",this.acft.GetReliabilityList()),b.Overspeed,this.acft.GetMinAltitude().toString()+"-"+this.acft.GetMaxAltitude().toString(),b.FuelUses);c=b.TurnBleed==b.TurnBleedwBombs?c+StringFmt.Format("Visibility {0}, Stability {1}, Energy Loss {2}, Turn Bleed {3}\n\n",
StringFmt.Join("/",this.acft.GetVisibilityList()),b.Stabiilty,b.EnergyLoss,b.TurnBleed):c+StringFmt.Format("Visibility {0}, Stability {1}, Energy Loss {2}, Turn Bleed {3} ({4})\n\n",StringFmt.Join("/",this.acft.GetVisibilityList()),b.Stabiilty,b.EnergyLoss,b.TurnBleed,b.TurnBleedwBombs);c+=StringFmt.Format("Toughness {0}, Max Strain {1}, Escape {2}, Crash Safety {3}, Flight Stress {4}\n\n",b.Toughness,b.MaxStrain,StringFmt.Join("/",this.acft.GetEscapeList()),StringFmt.Join("/",this.acft.GetCrashList()),
this.Stress2Str(this.acft.GetStressList()));b=this.acft.GetWeapons().GetWeaponList();var d=this.acft.GetWeapons().GetDirectionList(),e=this.acft.GetMunitions().GetBombCount(),f=this.acft.GetMunitions().GetRocketCount(),g=this.acft.GetMunitions().GetInternalBombCount();if(0<e){var h=Math.min(e,g);e=Math.max(0,e-h);0<h&&(c+=lu(" Bomb Mass Internally.",h));0<e&&(c+=lu(" Bomb Mass Externally.",e));0<h&&(e=Math.min(h,this.acft.GetMunitions().GetMaxBombSize()),c+=lu("Largest Internal Bomb",e.toString()));
g-=h;c+="\n"}0<f&&(g=Math.min(f,g),f=Math.max(0,f-g),0<g&&(c+=lu(" Rocket Mass Internally.",g)),0<f&&(c+=lu(" Rocket Mass Externally.",f)),c+="\n");f=this.acft.GetWeapons().GetWeaponSets();for(g=0;g<f.length;g++)c+=WeaponString(f[g],b,d)+"\n";for(let k of a.warnings)c+=k.source+":  "+k.warning+"\n";download(c,this.acft.name+"_"+this.acft.GetVersion()+".txt","txt")}LoadText(a){try{var b=JSON.parse(a.value);(new Aircraft(parts_JSON,weapon_JSON,!1)).fromJSON(b)&&(this.acft.fromJSON(b),this.derived.SetName(this.acft.name),
this.acft.CalculateStats())}catch(c){BlinkBad(a.parentElement)}finally{a.value=""}}SaveJSON(){this.acft.name=this.derived.GetName();download(JSON.stringify(this.acft.toJSON()),this.acft.name+"_"+this.acft.GetVersion()+".json","json")}MakeLink(){this.acft.name=this.derived.GetName();var a=new Serialize;this.acft.serialize(a);a=a.FinalArray();a=_arrayBufferToString(a);a=LZString.compressToEncodedURIComponent(a);return location.protocol+"//"+location.host+location.pathname+"?json="+a}SaveLink(){copyStringToClipboard(this.MakeLink())}SaveDash(){this.UpdateCard();
this.cards.SaveDash();for(var a=this.acft.GetWeapons().GetWeaponSets(),b=0;b<a.length;b++)this.UpdateWeaponCard(a[b]),this.cards.SaveWeapon(b);for(a=0;a<this.acft.GetEngines().GetNumberOfEngines();a++)b=this.acft.GetEngines().GetEngine(a),this.UpdateEngineCard(b),b.GetUsePushPull()?(b=this.cards.eng_data.reliability.split("/"),this.cards.eng_data.reliability=b[0].toString(),this.cards.SaveEngine(a,ENGINE_TEXT.PULLER),this.cards.eng_data.reliability=b[0].toString(),this.cards.SaveEngine(a,ENGINE_TEXT.PUSHER)):
this.cards.SaveEngine(a);for(a=0;a<this.acft.GetEngines().GetNumberOfRadiators();a++)this.UpdateRadiatorCard(this.acft.GetEngines().GetRadiator(a)),this.cards.SaveRadiator(a)}SaveInteractive(){var a="https://tetragramm.github.io/InteractiveDash/index.html?json="+btoa(this.InteractiveDash());window.open(a,"_blank")}InteractiveDash(){this.acft.name=this.derived.GetName();for(var a=this.acft.GetStats(),b=this.acft.GetDerivedStats(),c=this.acft.VitalComponentList(),d=!1;10<c.length;)c.pop(),d=!0;for(d&&
(c.pop(),c.push("And More. See Plane Builder for full list."));10>c.length;)c.push("");var e=this.acft.GetAccessories().GetEffectiveCoverage();d="";for(var f=0;f<e.length;++f){var g=f+1;0<e[f]&&(d=""!=d?d+", ":d+(lu("Armour")+" "),d+=g.toString()+"/+"+(11-e[f]).toString())}e=[];var h=this.acft.GetMunitions().GetBombCount();f=this.acft.GetMunitions().GetRocketCount();g=this.acft.GetMunitions().GetInternalBombCount();(0<h||0<f)&&e.push("Current load here.");if(0<h){var k=Math.min(h,g);h=Math.max(0,
h-k);0<k&&e.push(lu(" Bomb Mass Internally.",k));0<h&&e.push(lu(" Bomb Mass Externally.",h));0<k&&(h=Math.min(k,this.acft.GetMunitions().GetMaxBombSize()),e.push(lu("Largest Internal Bomb",h.toString())));g-=k}for(0<f&&(g=Math.min(f,g),f=Math.max(0,f-g),0<g&&e.push(lu(" Rocket Mass Internally.",g)),0<f&&e.push(lu(" Rocket Mass Externally.",f)));5>e.length;)e.push("");f="";for(let l of a.warnings)f+=l.source+": "+l.warning+"\n";a={altitude:0,airspeed:0,fuel:b.FuelUses,dropoff:b.Dropoff,visibility:this.acft.GetCockpits().GetCockpit(0).GetVisibility(),
energy_loss:b.EnergyLoss,turn_bleed:b.TurnBleed,stability:b.Stabiilty,stress:this.acft.GetCockpits().GetCockpit(0).GetFlightStress()[0],plane_escape:this.acft.GetCockpits().GetCockpit(0).GetEscape(),crash:this.acft.GetCockpits().GetCockpit(0).GetCrash(),max_toughness:b.Toughness,current_toughness:b.Toughness,max_strain:b.MaxStrain,current_strain:b.MaxStrain,g_force:0,kills:0,full_load_boost:b.BoostFullwBombs,full_load_handling:b.HandlingFullwBombs,full_load_climb:b.RateOfClimbwBombs,full_load_stall:b.StallSpeedFullwBombs,
full_load_speed:b.MaxSpeedwBombs,half_fuel_bombs_boost:Math.floor((b.BoostFullwBombs+b.BoostEmpty)/2),half_fuel_bombs_handling:Math.floor((b.HandlingFullwBombs+b.HandlingEmpty)/2),half_fuel_bombs_climb:Math.floor(1E-6+(b.RateOfClimbEmpty+b.RateOfClimbwBombs)/2),half_fuel_bombs_stall:Math.floor((b.StallSpeedFullwBombs+b.StallSpeedEmpty)/2),half_fuel_bombs_speed:Math.floor(1E-6+(b.MaxSpeedEmpty+b.MaxSpeedwBombs)/2),full_fuel_no_bombs_boost:b.BoostFull,full_fuel_no_bombs_handling:b.HandlingFull,full_fuel_no_bombs_climb:b.RateOfClimbFull,
full_fuel_no_bombs_stall:b.StallSpeedFull,full_fuel_no_bombs_speed:Math.floor(1E-6+b.MaxSpeedFull),half_fuel_no_bombs_boost:Math.floor((b.BoostFull+b.BoostEmpty)/2),half_fuel_no_bombs_handling:Math.floor((b.HandlingFull+b.HandlingEmpty)/2),half_fuel_no_bombs_climb:Math.floor(1E-6+(b.RateOfClimbEmpty+b.RateOfClimbFull)/2),half_fuel_no_bombs_stall:Math.floor((b.StallSpeedFull+b.StallSpeedEmpty)/2),half_fuel_no_bombs_speed:Math.floor(1E-6+(b.MaxSpeedEmpty+b.MaxSpeedFull)/2),empty_boost:0,empty_handling:b.HandlingEmpty,
empty_climb:0,empty_stall:b.StallSpeedEmpty,empty_speed:0,vital_part_1:c[0],vital_part_2:c[1],vital_part_3:c[2],vital_part_4:c[3],vital_part_5:c[4],vital_part_6:c[5],vital_part_7:c[6],vital_part_8:c[7],vital_part_9:c[8],vital_part_10:c[9],armor:d,max_bomb_load:e[0],ordinance_1:e[1],ordinance_2:e[2],ordinance_3:e[3],ordinance_4:e[4],notes:f,full_load_selected:!0,half_fuel_bombs_selected:!1,full_fuel_no_bombs_selected:!1,half_fuel_no_bombs_selected:!1,empty_selected:!1,engines:this.InteractiveEngines(),
weapons:this.InteractiveWeapons()};return JSON.stringify(a)}InteractiveEngines(){var a=[];for(let d=0;d<this.acft.GetEngines().GetNumberOfEngines();d++){let e=this.acft.GetEngines().GetEngine(d),f={rpm:0,wear:0,reliability:e.GetReliability(),ideal_altitide:e.GetMaxAltitude(),overspeed:e.GetOverspeed(),notes:""};var b=e.GetCurrentStats(),c=[];b.pulsejet?(c.push(lu("Pulsejet")),b=engine_list.get(e.GetSelectedList()).get_name(b.name),0<b.power&&b.starter&&c.push(lu("Starter"))):(e.IsRotary()&&e.IsTractor()?
c.push(lu("Turns Right")):e.IsRotary()&&e.IsPusher()&&c.push(lu("Turns Left")),b=engine_list.get(e.GetSelectedList()).get_name(b.name),b.upgrades[1]?c.push(lu("War Emergency Power")):0<b.compressor_count&&1==b.compressor_type&&c.push(lu("War Emergency Power from altitudes 0-9")));f.notes=StringFmt.Join(", ",c);e.GetUsePushPull()&&(c=f.reliability.split("/"),f.reliability=c[0].toString(),a.push(JSON.stringify(f)),f.reliability=c[0].toString());a.push(JSON.stringify(f))}return a}InteractiveWeapons(){var a=
[];for(let g of this.acft.GetWeapons().GetWeaponSets()){var b=this.acft.GetWeapons().GetWeaponList(),c=g.GetHits(),d=[];"PR"==b[g.GetWeaponSelected()].abrv?(d.push(5),d.push(5),d.push(5),d.push(5)):(d.push(Math.floor(1E-6+b[g.GetWeaponSelected()].damage*c[0])),d.push(Math.floor(1E-6+b[g.GetWeaponSelected()].damage*c[1])),d.push(Math.floor(1E-6+b[g.GetWeaponSelected()].damage*c[2])),d.push(Math.floor(1E-6+b[g.GetWeaponSelected()].damage*c[3])));var e=g.GetFinalWeapon(),f=[];e={type:WeaponName(g,b),
ammo:g.GetShots(),ap:e.ap,jam:g.GetJam(),knife_hits:c[0],close_hits:c[1],long_hits:c[2],extreme_hits:c[3],knife_damage:d[0],close_damage:d[1],long_damage:d[2],extreme_damage:d[3],tags:""};b=this.acft.GetWeapons().GetDirectionList();g.IsPlural()&&(e.type=g.GetWeaponCount().toString()+"x "+e.type);c=g.GetDirection();d="";d+="[";for(let h=0;h<b.length;h++)c[h]&&(d+=lu(b[h])+" ");d=d.substr(0,d.length-1);d+="]";f.push(d);f.concat(WeaponTags(g));e.tags=StringFmt.Join(", ",f);a.push(JSON.stringify(e))}return a}SaveNPC(){this.UpdateCard();
this.cards.lowest_overspeed=-1;for(var a=0;a<this.acft.GetEngines().GetNumberOfEngines();a++){var b=this.acft.GetEngines().GetEngine(a);if(b.GetOverspeed()<this.cards.lowest_overspeed||0>this.cards.lowest_overspeed)this.cards.lowest_overspeed=b.GetOverspeed()}this.cards.all_weapons=[];b=this.acft.GetWeapons().GetWeaponSets();for(a=0;a<b.length;a++)this.UpdateWeaponCard(b[a]),this.cards.all_weapons.push(Object.assign({},this.cards.weap_data));this.cards.SaveNPC()}InitStats(a){var b=document.createDocumentFragment(),
c=insertRow(b);CreateTH(c,lu("Stat Lift Bleed"));CreateTH(c,lu("Stat Drag"));CreateTH(c,lu("Stat Mass"));CreateTH(c,lu("Stat Wet Mass"));CreateTH(c,lu("Stat Bomb Mass"));CreateTH(c,lu("Stat Cost"));CreateTH(c,lu("Stat Upkeep"));c=insertRow(b);this.d_lift=c.insertCell();this.d_drag=c.insertCell();this.d_mass=c.insertCell();this.d_wmas=c.insertCell();this.d_bmas=c.insertCell();this.d_cost=c.insertCell();this.d_upkp=c.insertCell();c=insertRow(b);CreateTH(c,lu("Stat Control"));CreateTH(c,lu("Stat Pitch Stability"));
CreateTH(c,lu("Stat Lateral Stability"));CreateTH(c,lu("Stat Wing Area"));CreateTH(c,lu("Stat Raw Strain"));CreateTH(c,lu("Stat Structure"));CreateTH(c,lu("Stat Toughness"));c=insertRow(b);this.d_cont=c.insertCell();this.d_pstb=c.insertCell();this.d_lstb=c.insertCell();this.d_wara=c.insertCell();this.d_mstr=c.insertCell();this.d_strc=c.insertCell();this.d_tugh=c.insertCell();c=insertRow(b);CreateTH(c,lu("Stat Power"));CreateTH(c,lu("Stat Fuel Consumption"));CreateTH(c,lu("Stat Fuel"));CreateTH(c,
lu("Stat Pitch Speed"));CreateTH(c,lu("Stat Pitch Boost"));CreateTH(c,lu("Stat Charge"));CreateTH(c,lu("Stat Crash Safety"));c=insertRow(b);this.d_powr=c.insertCell();this.d_fcom=c.insertCell();this.d_fuel=c.insertCell();this.d_pspd=c.insertCell();this.d_pbst=c.insertCell();this.d_chrg=c.insertCell();this.d_crsh=c.insertCell();a.appendChild(b)}InitDerived(a){this.derived=new Derived_HTML(a)}UpdateStats(a){var b=StringFmt.Format("{0} + {1} ({2}/5)",a.drag,Math.floor(1E-6+a.mass/5),(a.drag+Math.floor(1E-6+
a.mass/5))%5),c=StringFmt.Format("{0} ({1}/5)",a.mass,a.mass%5);BlinkIfChanged(this.d_lift,a.liftbleed.toString(),!1);BlinkIfChanged(this.d_drag,b);BlinkIfChanged(this.d_mass,c);BlinkIfChanged(this.d_wmas,a.wetmass.toString(),!1);BlinkIfChanged(this.d_bmas,a.bomb_mass.toString(),!1);BlinkIfChanged(this.d_cost,a.cost.toString(),!1);BlinkIfChanged(this.d_upkp,a.upkeep.toString(),!1);BlinkIfChanged(this.d_cont,a.control.toString(),!0);BlinkIfChanged(this.d_pstb,a.pitchstab.toString(),!0);BlinkIfChanged(this.d_lstb,
a.latstab.toString(),!0);BlinkIfChanged(this.d_powr,a.power.toString(),!0);BlinkIfChanged(this.d_fcom,a.fuelconsumption.toString(),!1);BlinkIfChanged(this.d_fuel,a.fuel.toString(),!0);BlinkIfChanged(this.d_pspd,(Math.round(10*a.pitchspeed)/10).toString(),!0);BlinkIfChanged(this.d_pbst,(Math.round(10*a.pitchboost)/10).toString(),!0);BlinkIfChanged(this.d_wara,a.wingarea.toString(),!0);BlinkIfChanged(this.d_mstr,a.maxstrain.toString(),!0);BlinkIfChanged(this.d_strc,a.structure.toString(),!0);BlinkIfChanged(this.d_tugh,
a.toughness.toString(),!0);BlinkIfChanged(this.d_chrg,a.charge.toString(),!0);BlinkIfChanged(this.d_crsh,a.crashsafety.toString(),!0)}UpdateDerived(a,b){this.derived.GetName()!=lu("Derived Aircraft Name")&&(this.acft.name=this.derived.GetName());this.derived.UpdateDisplay(this.acft,a,b);this.altitude.UpdateDisplay(this.acft,b)}UpdateDisplay(){var a=this.acft.GetStats(),b=this.acft.GetDerivedStats();let c=this.acft.GetAircraftType();1<=c&&--c;this.acft_type.selectedIndex=c;this.era.UpdateDisplay();
this.cockpits.UpdateDisplay();this.passengers.UpdateDisplay();this.engines.UpdateDisplay();this.propeller.UpdateDisplay();this.frames.UpdateDisplay();this.wings.UpdateDisplay();this.stabilizers.UpdateDisplay();this.controlsurfaces.UpdateDisplay();this.reinforcements.UpdateDisplay();this.reinforcements.UpdateMaxStrain(b.MaxStrain);this.load.UpdateDisplay();this.load.UpdateFuelUses(a.fuel/a.fuelconsumption);this.gear.UpdateDisplay();this.accessories.UpdateDisplay();this.optimization.UpdateDisplay();
this.weapons.UpdateDisplay();this.used.UpdateDisplay();this.rotor.UpdateDisplay();this.alter.UpdateDisplay();this.UpdateStats(a);this.UpdateDerived(a,b)}}
var LZString=function(){function a(e,f){if(!c[e]){c[e]={};for(var g=0;g<e.length;g++)c[e][e.charAt(g)]=g}return c[e][f]}var b=String.fromCharCode,c={},d={compressToBase64:function(e){if(null==e)return"";e=d._compress(e,6,function(f){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f)});switch(e.length%4){default:case 0:return e;case 1:return e+"===";case 2:return e+"==";case 3:return e+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:d._decompress(e.length,
32,function(f){return a("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e.charAt(f))})},compressToUTF16:function(e){return null==e?"":d._compress(e,15,function(f){return b(f+32)})+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:d._decompress(e.length,16384,function(f){return e.charCodeAt(f)-32})},compressToUint8Array:function(e){e=d.compress(e);for(var f=new Uint8Array(2*e.length),g=0,h=e.length;g<h;g++){var k=e.charCodeAt(g);f[2*g]=k>>>8;f[2*g+1]=k%256}return f},
decompressFromUint8Array:function(e){if(null===e||void 0===e)return d.decompress(e);for(var f=Array(e.length/2),g=0,h=f.length;g<h;g++)f[g]=256*e[2*g]+e[2*g+1];var k=[];f.forEach(function(l){k.push(b(l))});return d.decompress(k.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":d._compress(e,6,function(f){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(f)})},decompressFromEncodedURIComponent:function(e){if(null==e)return"";if(""==e)return null;
e=e.replace(/ /g,"+");return d._decompress(e.length,32,function(f){return a("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",e.charAt(f))})},compress:function(e){return d._compress(e,16,function(f){return b(f)})},_compress:function(e,f,g){if(null==e)return"";var h,k={},l={},n="",m=2,u=3,q=2,x=[],p=0,t=0,v;for(v=0;v<e.length;v+=1){var w=e.charAt(v);Object.prototype.hasOwnProperty.call(k,w)||(k[w]=u++,l[w]=!0);var y=n+w;if(Object.prototype.hasOwnProperty.call(k,y))n=y;else{if(Object.prototype.hasOwnProperty.call(l,
n)){if(256>n.charCodeAt(0)){for(h=0;h<q;h++)p<<=1,t==f-1?(t=0,x.push(g(p)),p=0):t++;var r=n.charCodeAt(0);for(h=0;8>h;h++)p=p<<1|r&1,t==f-1?(t=0,x.push(g(p)),p=0):t++,r>>=1}else{r=1;for(h=0;h<q;h++)p=p<<1|r,t==f-1?(t=0,x.push(g(p)),p=0):t++,r=0;r=n.charCodeAt(0);for(h=0;16>h;h++)p=p<<1|r&1,t==f-1?(t=0,x.push(g(p)),p=0):t++,r>>=1}m--;0==m&&(m=Math.pow(2,q),q++);delete l[n]}else for(r=k[n],h=0;h<q;h++)p=p<<1|r&1,t==f-1?(t=0,x.push(g(p)),p=0):t++,r>>=1;m--;0==m&&(m=Math.pow(2,q),q++);k[y]=u++;n=String(w)}}if(""!==
n){if(Object.prototype.hasOwnProperty.call(l,n)){if(256>n.charCodeAt(0)){for(h=0;h<q;h++)p<<=1,t==f-1?(t=0,x.push(g(p)),p=0):t++;r=n.charCodeAt(0);for(h=0;8>h;h++)p=p<<1|r&1,t==f-1?(t=0,x.push(g(p)),p=0):t++,r>>=1}else{r=1;for(h=0;h<q;h++)p=p<<1|r,t==f-1?(t=0,x.push(g(p)),p=0):t++,r=0;r=n.charCodeAt(0);for(h=0;16>h;h++)p=p<<1|r&1,t==f-1?(t=0,x.push(g(p)),p=0):t++,r>>=1}m--;0==m&&(m=Math.pow(2,q),q++);delete l[n]}else for(r=k[n],h=0;h<q;h++)p=p<<1|r&1,t==f-1?(t=0,x.push(g(p)),p=0):t++,r>>=1;m--;0==
m&&q++}r=2;for(h=0;h<q;h++)p=p<<1|r&1,t==f-1?(t=0,x.push(g(p)),p=0):t++,r>>=1;for(;;)if(p<<=1,t==f-1){x.push(g(p));break}else t++;return x.join("")},decompress:function(e){return null==e?"":""==e?null:d._decompress(e.length,32768,function(f){return e.charCodeAt(f)})},_decompress:function(e,f,g){var h=[],k=4,l=4,n=3,m=[],u,q,x=g(0),p=f,t=1;for(u=0;3>u;u+=1)h[u]=u;var v=0,w=Math.pow(2,2);for(q=1;q!=w;){var y=x&p;p>>=1;0==p&&(p=f,x=g(t++));v|=(0<y?1:0)*q;q<<=1}switch(v){case 0:v=0;w=Math.pow(2,8);for(q=
1;q!=w;)y=x&p,p>>=1,0==p&&(p=f,x=g(t++)),v|=(0<y?1:0)*q,q<<=1;var r=b(v);break;case 1:v=0;w=Math.pow(2,16);for(q=1;q!=w;)y=x&p,p>>=1,0==p&&(p=f,x=g(t++)),v|=(0<y?1:0)*q,q<<=1;r=b(v);break;case 2:return""}u=h[3]=r;for(m.push(r);;){if(t>e)return"";v=0;w=Math.pow(2,n);for(q=1;q!=w;)y=x&p,p>>=1,0==p&&(p=f,x=g(t++)),v|=(0<y?1:0)*q,q<<=1;switch(r=v){case 0:v=0;w=Math.pow(2,8);for(q=1;q!=w;)y=x&p,p>>=1,0==p&&(p=f,x=g(t++)),v|=(0<y?1:0)*q,q<<=1;h[l++]=b(v);r=l-1;k--;break;case 1:v=0;w=Math.pow(2,16);for(q=
1;q!=w;)y=x&p,p>>=1,0==p&&(p=f,x=g(t++)),v|=(0<y?1:0)*q,q<<=1;h[l++]=b(v);r=l-1;k--;break;case 2:return m.join("")}0==k&&(k=Math.pow(2,n),n++);if(h[r])r=h[r];else if(r===l)r=u+u.charAt(0);else return null;m.push(r);h[l++]=u+r.charAt(0);k--;u=r;0==k&&(k=Math.pow(2,n),n++)}}};return d}();
class StringFmt{static IsNullOrWhiteSpace(a){try{return null==a||"undefined"==a?!0:1>a.toString().replace(/\s/g,"").length}catch(b){return console.log(b),!1}}static Join(a,...b){try{let c=b[0];if(Array.isArray(c)||c instanceof Array){let d=StringFmt.Empty;for(b=0;b<c.length;b++){let e=c[b];d=b<c.length-1?d+(e+a):d+e}return d}if("object"===typeof c){let d=StringFmt.Empty;Object.keys(c).forEach(e=>{d+=c[e]+a});return d=d.slice(0,d.length-a.length)}return StringFmt.join(a,...b)}catch(c){return console.log(c),
StringFmt.Empty}}static Format(a,...b){try{return a.match(StringFmt.regexNumber)?StringFmt.format(StringFmt.regexNumber,a,b):a.match(StringFmt.regexObject)?StringFmt.format(StringFmt.regexObject,a,b,!0):a}catch(c){return console.log(c),StringFmt.Empty}}static format(a,b,c,d=!1){return b.replace(a,function(e,f){let g=e.split(":");1<g.length&&(f=g[0].replace("{",""),e=g[1].replace("}",""));f=d?c[0][f]:c[f];if(null==f||void 0==f||e.match(/{\d+}/))return f;f=StringFmt.parsePattern(e,f);return"undefined"!=
typeof f&&null!=f?f:StringFmt.Empty})}static parsePattern(a,b){switch(a){case "L":return b.toLocaleLowerCase();case "U":return b.toLocaleUpperCase();case "d":if("string"===typeof b)return StringFmt.getDisplayDateFromString(b);if(b instanceof Date)return StringFmt.Format("{0:00}.{1:00}.{2:0000}",b.getDate(),b.getMonth(),b.getFullYear());break;case "s":if("string"===typeof b)return StringFmt.getSortableDateFromString(b);if(b instanceof Date)return StringFmt.Format("{0:0000}-{1:00}-{2:00}",b.getFullYear(),
b.getMonth(),b.getDate());break;case "n":"string"!==typeof b&&(b=b.toString());var c=b.replace(/,/g,".");if(isNaN(parseFloat(c))||3>=c.length)break;a=b=c.split(/[^0-9]+/g);1<b.length&&(a=[StringFmt.join("",...b.splice(0,b.length-1)),b[b.length-1]]);let d=a[0];c=d.length%3;b=0<c?d.substring(0,c):StringFmt.Empty;c=d.substring(c).match(/.{3}/g);b=b+"."+StringFmt.Join(".",c);return b+(1<a.length?","+a[1]:"");case "x":return this.decimalToHexString(b);case "X":return this.decimalToHexString(b,!0)}return"number"!==
typeof b&&isNaN(b)||isNaN(+a)||StringFmt.IsNullOrWhiteSpace(b)?b:StringFmt.formatNumber(b,a)}static decimalToHexString(a,b=!1){a=parseFloat(a).toString(16);return b?a.toLocaleUpperCase():a}static getDisplayDateFromString(a){var b=a.split("-");if(1>=b.length)return a;a=b[b.length-1];let c=b[b.length-2];b=b[b.length-3];a=a.split("T")[0];a=a.split(" ")[0];return`${a}.${c}.${b}`}static getSortableDateFromString(a){var b=a.replace(",","").split(".");if(1>=b.length)return a;let c=b[b.length-1].split(" ");
a=StringFmt.Empty;1<c.length&&(a=c[c.length-1]);b=`${b[b.length-1].split(" ")[0]}-${b[b.length-2]}-${b[b.length-3]}`;return!StringFmt.IsNullOrWhiteSpace(a)&&1<a.length?b+`T${a}`:b+"T00:00:00"}static formatNumber(a,b){b=b.length;a=a.toString();return b<=a.length?a:Array(b-a.length+1).join("0")+a}static join(a,...b){let c=StringFmt.Empty;for(let d=0;d<b.length;d++)if(!("string"==typeof b[d]&&StringFmt.IsNullOrWhiteSpace(b[d])||"number"!=typeof b[d]&&"string"!=typeof b[d])){c+=""+b[d];for(let e=d+1;e<
b.length;e++)if(!StringFmt.IsNullOrWhiteSpace(b[e])){c+=a;d=e-1;break}}return c}}StringFmt.regexNumber=/{(\d+(:\w*)?)}/g;StringFmt.regexObject=/{(\w+(:\w*)?)}/g;StringFmt.Empty="";
class StringBuilder{constructor(a){this.Values=[];StringFmt.IsNullOrWhiteSpace(a)||(this.Values=Array(a))}ToString(){return this.Values.join("")}Append(a){this.Values.push(a)}AppendLine(a){this.Values.push("\r\n"+a)}AppendFormat(a,...b){this.Values.push(StringFmt.Format(a,...b))}AppendLineFormat(a,...b){this.Values.push("\r\n"+StringFmt.Format(a,...b))}Clear(){this.Values=[]}}
function scrollToFragment(a={}){unmount();getElement=a.getElement||getElementById;scrollIntoView=a.scrollIntoView||defaultScrollIntoView;mount()}function mount(){documentObserver=new MutationObserver(handleDomMutation);addEventListener("click",handleDocumentClick);unlistenHistory=void 0;startObserving()}function unmount(){stopObserving();removeEventListener("click",handleDocumentClick);unlistenHistory&&unlistenHistory();documentObserver=unlistenHistory=void 0}
function startObserving(){stopObserving();getLocation().hash&&(STOP_EVENTS.forEach(addStopListener),null===documentObserver||void 0===documentObserver?void 0:documentObserver.observe(document,OBSERVER_CONFIG),adjustScrollPosition(),observeTimeout=setTimeout(stopObserving,OBSERVE_TIMEOUT_MS))}
function stopObserving(){clearTimeout(observeTimeout);cancelAnimationFrame(throttleRequestId);null===documentObserver||void 0===documentObserver?void 0:documentObserver.disconnect();STOP_EVENTS.forEach(removeStopListener)}function addStopListener(a){document.addEventListener(a,stopObserving)}function removeStopListener(a){document.removeEventListener(a,stopObserving)}
function handleDocumentClick(a){a.defaultPrevented||(a=closestAIncludingSelf(a.target))&&a.hash&&a.pathname===getLocation().pathname&&throttle(startObserving)}function closestAIncludingSelf(a){for(;a&&"A"!==a.nodeName;)a=a.parentElement;return a}function handleDomMutation(){throttle(adjustScrollPosition)}function adjustScrollPosition(){var a=getLocation().hash;a&&(a=decodeURIComponent(a.substring(1)),(a=getElement.call(null,a))&&scrollIntoView.call(null,a))}
function getLocation(){return location}function getElementById(a){return document.getElementById(a)}function defaultScrollIntoView(a){a.scrollIntoView()}function throttle(a){cancelAnimationFrame(throttleRequestId);throttleRequestId=requestAnimationFrame(a)}let getElement,scrollIntoView,unlistenHistory,documentObserver,observeTimeout,throttleRequestId;
const OBSERVER_CONFIG={attributes:!0,characterData:!0,childList:!0,subtree:!0},OBSERVE_TIMEOUT_MS=1E4,STOP_EVENTS=["selectstart","touchend","wheel"],init=()=>{var a=new URLSearchParams(location.search),b=a.get("json"),c=a.get("lang");a=["/PlaneBuilder/strings.json","/PlaneBuilder/parts.json","/PlaneBuilder/engines.json","/PlaneBuilder/weapons.json"].map(d=>fetch(d));Promise.all(a).then(d=>Promise.all(d.map(e=>e.json()))).then(d=>{var e=d[0];parts_JSON=d[1];engine_JSON=d[2];weapon_JSON=d[3];local=
new Localization(e);c?local.SetLanguages(c):window.localStorage.language&&local.SetLanguages(window.localStorage.language);d=window.localStorage.getItem("aircraft");if(e=window.localStorage.getItem("engines_names")){e=JSON.parse(e);for(var f of e)f=f.trim(),f=f.replace(/\s+/g," "),""!=f&&engine_list.set(f,new EngineList(f))}for(let l of engine_JSON.lists)engine_list.has(l.name)||engine_list.set(l.name,new EngineList(l.name)),"Custom"!=l.name?(engine_list.get(l.name).fromJSON(l,!0),engine_list.get(l.name).SetConstant()):
engine_list.get(l.name).fromJSON(l,!1);aircraft_model=new Aircraft(parts_JSON,weapon_JSON,!0);aircraft_display=new Aircraft_HTML(parts_JSON,aircraft_model);f=!1;if(b&&!f){console.log("Used Query Parameter");try{var g=LZString.decompressFromEncodedURIComponent(b),h=_stringToArrayBuffer(g),k=new Deserialize(h);console.log(k.version);aircraft_model.deserialize(k);f=!0}catch(l){console.log("Compressed Query Parameter Failed."),console.log(l),aircraft_model.Reset()}}if(d&&!f){console.log("Used Saved Data");
try{aircraft_model.fromJSON(JSON.parse(d))}catch(l){console.log("Saved Data Failed."),aircraft_model.Reset()}}aircraft_model.CalculateStats();enable_anim=!0});window.addEventListener("load",()=>{scrollToFragment();setTimeout(()=>{window.onscroll=debounce(SetScroll,250)},1E3)});a=document.getElementsByClassName("collapsible");for(let d=0;d<a.length;d++)a[d].addEventListener("click",function(){var e=this.classList.toggle("active"),f=this.nextElementSibling;f=f.nextElementSibling;f.style.maxHeight=e?
"inherit":"0px"})};window.addEventListener("DOMContentLoaded",init);function debounce(a,b){let c;return function(){clearTimeout(c);c=setTimeout(a,b)}}var hash="";
function SetScroll(a){a="Era Cockpit Passengers Engines Frames Tail Wings Rotors Stabilizers ControlSurfaces Reinforcements Weapons Load Landing_Gear Accessories Propeller Optimization Stats Flight".split(" ");var b="",c=window.pageYOffset;for(let d of a)if(0!=document.getElementById(d).offsetTop)if(c>document.getElementById(d).offsetTop)b=d;else break;hash!=b&&(hash=b,window.history.replaceState(null,null,"index.html#"+b))}
var parts_JSON,engine_JSON,weapon_JSON,aircraft_model,aircraft_display,engine_list=new Map([["Custom",new EngineList("Custom")]]),local,enable_anim=!1;
function test_published(){var a=JSON.parse(LZString.decompressFromEncodedURIComponent(String.raw`N4IghgxgZgLiBcBtEBBFBRFArFAVFAJigDICyAIgO4oBqKAYgOYCql5YA9ugCwoCS5AMooAnI3QAtAJoBhAOIB5FAGdGM4ihmFyKKaRkA2ABykATAE9zABQkBWALQBFBYxQALAEYoAQgQDWtihyAFKMUigAcm5+vAoADADqlNzU5K6k5mgA7GhypJrcAG7eALbUlNT6yih+MgTcpij2lPT2rsFyPn4ApgBeIkbK3pQANm4Aln4wwebjygCO3AYj88uM5PPKjjKClOgA0uPcWG6CyoXB+-sj6AZQmjIArtVorgAODLxucdT2KORKUiUCIRRylDxgACM03G3iMlAAEhIANSFcgADwSADsfCgAE4RDwJRjoiJYN7KGRYZjmXq9ZSmXqkDjmagQYimZEoBQyDxYiJSYhWKC2ZHI8zokR4vhWUwiORQEReGSMQqFXBZADMACUIJruqZqAd7LgRFhHhc4hEoDRxgptb0scEwAluuNSPRuKQEuNyI4wHiABrjPGCdC9MDoDjcBF8SgGfGBFAgAA0qAw2DwhBI+j43g+uBYlH23BkIkDfBQjjkzBQCJQu3IMFwNAg3gkKAkJQzCLc3coEhEkKwIj8xE1b3WPn2mjYpg+fA8NG1DEhsZQ2rcVkEvASb3o6MY1FKciYDE63gg4TkpSwwTcvXCfAIjHryPuViMhVcYE6GAkmr2MiSToMEkzTLMyhvPMcgrAYyIlOEBiFJgfh+OgRwjMEzDnJc+yPBwjglOSBg5N4-wPMiLwoK49A5DIjg6OQRj-JWQIyL0uCOD4vTkJCyJWN4mIeIU3AJFA+yBh6IweMocTcPQfFYFYj5GOQpi4FitjKB49CcSg+w6I8kLorg4zoqQEBWKQMC9DIWRWMoEgNEYIxZJQmooB45hZOiAmkFYCLdIFCqmFikIEMiYC2EYvQlAQUDKLYchyBIcgyJQWQcOiBggm84xGDAvroBAlCuKm6aYDg+BEGQ3jhCMKAjIw9CQo4rA8PwMiZGIMhSOEphKFIWDiIx+yZC+ChSN4jzeLgEiQtQ6xGFYbDeMi9iBpSCLkG4fDMNqwQlCx+zEIxnTdQOfj8IavCOI1Oz-Nqh4oL0aASI13iNN4fjhAejh8CM6ICEeDDkFo6DkFYQEkDorzeNw2pyKyKAcPMYBvHiYDdL9JT0DAXgoPkKAGG4WIGHEzDzKsKzcOMEBdiMWAeCxmAsXwlaMNsHb0NdKCFDQETUAxVj-CxpAGCUbwwHEaBQL0RDkJg7FvYI3jaqk9gyLY9B0GAhRvH42oImGMCPEYBgiKK6COAQ8IlCUWJGOYEDahIRjBAQpi2IURiBlAUBcvsMjaoU+zBAr6LEHiNDovsCK4M0vQjGICMoAkIxvBEEDpyIcR4pQ3j0CImqPCIxBYEYxAjDIHC1hVaBVVmtX5Bw7buIwwTAlICIRBWchPigMAoMwbVyDngaRCINCrTITDkU+nTcDoCjdI8-uOH8EByFk5Arn4pAKOg1Rcgitap8oIwjFI4jVAQjxuOY3D7MiCgQH4vSYPQl+BrwlDfowbwSgUCUG7OQF4KQSBYFIN4LIgYWpuFcJ0boQRGBvCkGCPgCICq0B2twPatgJDam1KPYg2o4hGCgMwMkQIYB4niBAQMjhiABAwM1boCQaA0BVNCQMghzDUk1BkfY6JlBIj2N2dA9BGEcFxOgeYeBKzKBgG4TAUBxgIm1OMcI2BGDdjkJWCQLUpaCBoLYUw+xSC4HRMEBQRg3DkBTo4bUEQFBYGUAJQoUhuA-R0VIby11ggIkKG4XAYAARYj8AodBwRuAsiMIIRkCgyqoxqAkYgthggRHsWgfaBh7C7WSCVbwCItBpHMPoe62pzD7D8FkGQwMSjIiElIS4yJuA0CMJqPqWT7zmHCAiZEBhugRCsBwEQEAIDjHKmmRumYao5mGLQBgRZ2BcF4JWcYCQO6kAkG3Q0NF8iQ3IHEbwjARC9CwMQXoi5iCaU1B4BEWIISMDkNxBYagEimHrAiWOHZeSVjxGgwujRXqVnAZoDg1BiDrHmIGa8pRmpJDSL0bo9gJCFAUIGGgUh9iA3mtrMAckDDEBdNdQQgYIDolMeiQoxCzEEEEBFXmsiqzeFCOgTIxB9jCG5BIeYmB1oRAyCqcgM5SCamDoA66A92yMF-kYUsjDAxYmgtHCQeIZCQggB4BQWIsjeF6HiAgBh6zagUMwCyCR0bk0DI8NAggERZEQhwmgMBAGOD0liEoIwShyBoG4J87AYD8kKAYegbgCAKAICULIjwZmVXmdmMgtdOxNUYBEUwzhKBTX4OQcYeBGBWE4DIEoSh6BBD4PIciMAsDak7rgbwlIvLUCkPQTUWpHxuG8HwbgXce38BoHwTAMKVBgAUPsEoZyUCmAiLgHAX00C9EyBC3Q0LxhYAUPccgcMWiUAYhwPw3FXDNHIG0DcF4-D0HMGkLA3Y3hvOYCMeg2KIgIkDHETdhdITajzMEQ+ARtScJoEIOIIhHBxHoI0dA6AsA6PIt4YQxBC7gO1LwKArhej0EeESVwKpuC4FsAoGgT8EToAiACcaGynWuARN4bwYAPCEOUGAEoEhKA0DkNqTUWIETlsQZoeVuARgwAIJQRwCJHCOHmLYNwHAFBWEYBIXoth0SUG6MUcT3hHCtLkLgSE3BuhYEKFgAwVgYB+EeEzIwjwoB+T4DEYd3BNRBXLFIPgmopBZCxKVbDvrvA1LQA3DM1Vk0UG4o1RB9BC5tpgRYJ4uJknkCSDRS8oI5DkEDKYOIVg4huAUDAWssjzCMFIB4NuChuzBHCFgXACJKCVjcDOdAMrGD4FKEu2RELyBxhIOMNw8wRj7CPGkagilZboDkLS2syhiZ8BgCMcwRg3gEBQX4BIpAP62CZRB3QPhIToAUM1cgmp8HMEDOgN4Ch2o0AIIGWRlZZFSfIuILllZvAeGua4dAjAZwIl4BIOINBpGsoMFiGcBjOzGNMEwCQOhBndBGL0RJjgUGMBMioxg3QDBwbQH4bw5A5CTnMG8fYjgJzamRFgfY9ADAQFMDAZEHqIjogRPMegIxAwEDJoGdGvQFDEEhCMGyJRbCPF6JCPwddzBuDeLgN4UBggkZGHIKw6JsYWeTLMkLzccxVncIWxwxZl7VEwJCEe1QBC4jU7oCgS5AweGEMjgg9PKAUMoOYZhqMpA5xoNxcwjQu5BB8AMgZ9aUCBjkNwPwxgEXjqyDATUeY+DhBkG4K24wA-MUSB4PFW3iQKA4PaqYbbvnMBw7+gtMHg9Q-oN2NlfBXskGIMEbi-3uA2OEMyV6Hhgi8usva4IsjFT7HQAQZgMA5DEm05wDwJR9h4jeI7ZgaQ6yhO1JsSAWBIT2u6N4Ot1NtSqreMYUwrGIB6IMRAOIwQYAcA4GAUIww2dyDcO+SEJRNQQFUFrxNoWW4qj5gkyMDEikBL5sqahhCkAlQQB8CCDMCCDEbwLabeAFpiARASD6DdiFgbhxAJYvgIj5DNQyA5LoDUAJD1ikC8DYqAIwCtCdjUAKK4DUB6oyBMTKBYj5DkDhDkC2KeQoAlD5AyDcCQiBgMTaaVBKwoBWiCBtzUDQzIjUD8CpAyj7jEIVxxC9BTYQCFB8CHDoAwDEDKBGBS7zCMBybDIcAeByC2BvAeCPAVKuB+BDBRyGoQDzDjAjBnCMB4j7DzB3rwR+CsYc5SB+CNAyDCGYZ640QyB7KFwSDkTMQoDBDzC4A-AoCe4iBWDUiQjwFf4yDIjoh6bajdDED5a4BuC2CYCQzoAVFQDoC2C9AIh+BI4EDoBuAoBGDcZYj1HJFwzkQeA2IwCBgwCzAzB8BYgB7IiQhLLdDIiQHMDl4cBUDigcDBCmDeCahxCHTqy2BfSP5IxkJYA+aPD1YQARCPCmDoCXHoAyAHzmTEDojjAzi-5zL-45iAEfAGAgGlZvANY6CQzDDkBnK4AVGZ6CCMTEBVzEAGBGr7AJBth+BEBSa8yaArglgoA4jVZzSLjUBgDMCagdFExGCAKh4+AvSBj5gjBGAdgE5oDFiCCkDKDbLCBnoGY+Dh7kSPCPCagjAEBI4GB7y3AeB8A0AjARAJARB+C0nVYoCGZQB4zUraiAY0DMBWCFilAEDvYYBMFKKFAVooAYa6CALdgJBgAvHBB8BgAwCmASCCD1EwCCDagwCQg3rogcBWQ0CO4eB4hZAKAcFZAiAEBvD3jKAlB8AQDMC9BGKaBuDOliJaKQgRCCD0CFB3YEBSCmCugkxyDzAlAjEtHYp+CcFYDcBZA5w5yPC4CkAjBWAeCuklDjBQAcByBiJNAeCOAxgIg5SvE64LJkB7aNTNStTtR7AbLdSiBqD9QzpKB8AjQ2xiopSCYDzyD4gwA5yVgFIsSUCJTQEnB8C7LEC8DMDEh5AMDNQ3IbgqLUBNYYAypYALr17Fj-DVA9brpv6FBWDjAgxjbgwYD0ARD2AsSzZoAyAIikxWGWBzDQRyB0KkzzBSApZwwKDzBXaUjaiCAhjzCnGTboglAuh-DkSiwRH8CYAlBggdj8CQgTJ45UBND-D2i-REB1hGCSYoDoj-D5DKCQhwEOa8D2B+mVE0DBDcoJByDIi4DhkeBQCkBYi8hYCijdC2CLhuCmB8BZASAYoyAJCQjBBYj2AKBrhSBc54g3z4ZtiPCOIEAqRYD3DIgiDIhBg7nBBZDBDsB-D0AUrTK8DqDGAeCMAeDaj0DIhHmODKDBBBba5Nz9kwKVh0CTi7CkDhAWYyA5yYCqByBqQOHdDhBvTMgyCyw4R5q4iIi6CGqQhZDLrgUiAC6wDmDpRuD2Cpk+AJaGDhBkyALaKdDcF0HcjUB6ZoAvj-AXgQD7CP68DTnIINgyA1w9hchQAsQyC9Y9ZZDs5uA7TEDmBHzUywWrDuZSAlCFgbBk47BzzoA5RvAcCBGsYoRLR+C1g0QoAfCejuCxSYlixBASB0LdCywoC-iCBWAZTdAEZSARAqL0ixhznkCMKCAGXmC4BhGkDageB0UmBoDMCnh4glD2D87cC9ARBlFxpGDlYRAyBvDIgDWGROocCnSOBYAwDkC4AFzkDKbohZDMDrCMBZBLZQCFC2AQByWUDajoB8AJDnWfY9yMA5wswJpvG64pqVhDktRtQdQbLeCYAcDNRUHyAKKBgjRgH0T-CUBvR6BDJ+TmB0Q-ARD7Z-ZS6dhuBC0cXTrbKLreDMB-QvQY1gARCuCyA+Ip7-CqUoDdDkAxRNAiAoLeBxDhDDB4h4i2SzRCnzAeCkCBgGrPbBC4BXHUoZyZIJCDzhDPbohuDcSCDfZEyyK9DEAKD77dCALIgIjjSAEyrTRGJtykAlCyLnBuDcBKAbEeAEDmDKDcC2D4UKB4gjBxAlDNl7FPEOQ6J8BCyowyBgASCmA0CFBxD2V+DiUfbmC2ClwSC1ZSC2AwA0BxASAEAIgq78kcCZJ1IJD2r1gECFBp3ED2AEDmJYDmAGDbIGA3hvDPLkgSAKC4CyLBbRVhZLVAGFisAlhlgVhVg1h1gNhsDNitgoDm7kCSJr79iDjDijjjiThEDeATlWmBKAIu7jAEAd18D83-CyHsqR7eCyIXhgBngIgjWKZaD2qrlnIEAEz0O8CDKBhGg4CaDqX2D2AlBaL0DajaUjASDdCLG3ajwJTah3x604rpRxzKl7HMEcBYAJBgbEBYhPZgglDMCyLkTyKKIqC8BbB1i8DciIUwAEwIgIiMDcAt77rIjKlKMyCmBeZ8BQASBqZ6ElDkDFmKC2l4hWB4hGCzqOzdj0BnKkod5Nl4jdCeOBgiDzDWUEAjQDqyB4j2AwDcAWaTJH5+CxpGD2DKCagiAlBWDdASAiSFBZBGDTGiJYD1R4j9IiCcPOzDQf6MBlHcQQNJoAGYARVAqlRWA9wCBKBaDcCMAp6LrwLECyDdjECEQs2mDLzzASjJFvCOA8CakYzilWAXgjw5zXT7q4CTrmASB8DKMoQ1AYCewKIFUYkHVwxqVZB+BIJnSECuCE4+AMySnXQB2dAdgY00Azi8BnpS1oCkDExxBOrahI1gQGCXXwQcAHUSBuDaVRC2BWKaC7ACH054gtnogIU6W6EFocx-URC9A5z8CaC4BgRAtJFSEqxZDcTq0cBWBaJ4hgT2B4h8ZxBghEwjDcCPB4gSCBguwVNxxZCVhRIvy9SUCCD8jIiZ4SR63EAeDMBxBwo0BZAvxhlWCHAlA8nKCPAQCCBZBuDECFCkAED2DmB1IByBjITBBaIYh0FZDjDoC6sECPJtqUDgNRVTOLLUAdgvOAJ-WOD7BSDjwZlNqnLVZrPQbTphB12kAIiOtKNw4SCQDIhZBSBGAaWywQ61gvTVBiBgjdBgArj0AEC2LW3SHR3EytI+DfRJUMDfpMCpPo6QilY+L2BuAsR+hKFYCmCFCajIhn1yCCBKPwGqNxAJTbJ7beCQjjqhBQCmABDeAJDMBK4QbDGODWjDb0YVjeCkBqCZBsoZW4olCQjD5HpBCt2mCV0CMKKKBgDeAKmCjrHeAjKMAwAyP6DMB+B8C9BlSmCkCcQjDgVQjKBky2neAyxGAVVQAGDoAJJl2QjbiUC+FwYCTNHeNcQ3L0zmBYi9AFTUysZYhY135xrSwGCU472UDohSDjAbEGqmDGS+DJYRD0ByCQhp5KEGBzZYAoJUBKGkDBCNJ+hQDOCgiOBQC6ilTJHqwQAIh4EjDMB2HdAOYNFYCUDzDoh4jMBYi-WOCGESA4hykKDkCPAEARitKdwy6MAKwcAwB4oRDjCBjJYBtK5BUEDainPKDvz7D+C9mQMAF5jkQ0AsBtTRZVgtZfS5mFqkCcDcidCjgbknaPsgmfZZAilYjZHB4yC1gc7MEE4aC8zzA8VqCkAcUkbUCOn0C9NgvoBWAaAGRCGQIwKkByBYAEDzDUCOBeA8gR2GnvhoBxBza4CainaFA0TjDEDjDMBYB8B4FQQCreBYyPCIQkwoSrOjWhtBfmDoABh5kkTtaiBzlJjvYpZ+BWDcR-AZGcUqDs3o29AwCFC2SXwybIi2D9Ms0lDmAJB33oh1rVhKgAWkB3r5AQDEwr6I-wQUC7yBjARGD2RKXUAcD-YeCag4dPL7BH38k0PG1bU0DcCoi82mAo3kD3C9DBDdAetyDW0p3BBpmjmy19lhaozeCNRMBG5bNyD+D0AwJKDkSWmLpuulbeJ8qiBYiW78zgJnJag1dJ4acpbhDBAJBpGCAKItQjCCnEURC1g0ANZDzCCNpgukByahAR4XiMDTeqS8NR7DD7QCD2BHlBACbeCy9SMjBDChtDZLYcC9BjWXWOBhQtm2Cwr1fagIxvDECCAX7zBIwjBXXIhWGm4qD8B8AGnvZiY1AZT0V-fkBcX2APXdDmAJRrNGA0CxrIi8zECh0wCYjOaUDWI9wlxQzKAVEY8UCmAEkEYEjKDKRnw-SwkGqaik9WAEYcAChYiBjdklDoBUT6r7A8gI1fhGciAyDSgJBiLc-tgdFFTsD+KhU+KRV-7y0wI3kdyBNnPG6pUZgcCTvgszQagQ2jADYB7ZzAcQAwJYEMqsw4YsiIhPsA9Ijx902yBDv9jlIPRWS1iUGBLzbwoAc4whYoNv02CoxiYXudzvfENKlhmgkQOGDIBaZ1McA3Ac0oyQuB+FHgbwMAPGmQp4gtEokI4HdxQRowMYV1YgPVlljMtQesiVvJoEiDXReg3gSeMkQKooBVoRMKIsQBBDSUHqJqCAJqikDuchgi7EkDID26XYXQqUC0JQC4wIUSgxAD7AkHBhuI4olhLIIUHP49xLS3QLEG4DN4Hgo6WIbwOjEkBj4SgpyRhCMC9LUJiAP1KAA8k1DVBVuHgPoNwAVJUkAspgOQBwErAwQRAVxdSF3AboyADKaQYIPQAoLMARAjwaBDlStKkAmcIgFjFgF9QwBvQWAHIBzzXanhcAMgB3gYC0AGA4wzADTmACZJgBF6+MPCh4FwDvNJm7xMgFQG8AdEmAo8T1A1mmil8b41WbBvVSYKW4dA5EIfroHQAWBkQFgYIEMl6CahzE3AGqkQGtr7tba8Aqzm7B8DkU6wf0cPJHh8COA9KLtNrOIAEzudBiDtItPYEgKEA-wEABQLYHgieNbgFYMUhEBcTogIAYIYIB+mlLKNmAt2ddilEATkQPGdAbwC8X9zrBs4DjMAHWBiiagJ0QQbiEYnoBYhpk4Yb4hxD2jzRcAUgEqLgEGLJRQgpAKAAQHdBBNt4zpdoYUG6B+p8B9ADgNBhehMBugHAKAFNjECSw+AQYCYL0EDBKBZIgw72KAKMC2A4MT4QQAYEFCXIsQ5AfJB4CyB4g4gZoj6AqFgjFpiAqRQQB4EfAc8rAFMAjlgDkAFpxg4SJ1IUEGIv85aMVWuO3EQRdwBQvcfuE+HowMA1K8vFAFW3ED2A+41g+eAwHdQTcCiyIBogYFsAyBGc9gdLm8gyJ1xcAvAOIC1HHwNgq6ssXMoUHEz-BZR6cAdmgCvDDtTAosSGKzC4IoBaRRgI+AOmhjfhzwjcegHgUYDrZki+wGgFegkC4BqE0wyEOQG6Dfoe07KZgDWTeDdBN2UAX5G+kcBI1HAJpKMHIl1L2NWybeXgJDkZF+o8MjwN0QxAVLXsac3QUCHIG6DVJMkfaAgHiDkAeB5g3QGgMcVcBLC8MbgVRB4EDCAUHYI8UhiW2DKlhr6UUfBPMHsC2ByAwrQZH4BECFBHg9QxhMoHsC8Ac4IVU0J+RZwJA6GlrdEMhxEAbYha4wAmtfEoAQACA9AcYNGwSAcUUajwarELTuKCA7ejgP2IUHGCPBMAcwt-vwCAIeAc0lAarIQQBCndRAZhXkD4kV7-AA2OALQCICOHcifgJgHUBYHUiUAkq6tImPMFrAGBHgQVcIPYSwjXoY6-VEPB8IUAJAtUihImCRS9DkBhU0hPgMEEpCdAOgK3BIKRG6DyAOA4wQWIx3oD7AjGG4xhJgEEDbJCgWU4XNdifTJlIQ3QOuvRhoCCAdEgrbPsPlcBPVfs0yMVETCrp4YghbwCvrjm8D2B0QFIPfBmlYyPAyQvYAwH2IQpgAxAiTPgJpQxi+0F6XsUXOJk4YFdBAsFZmEnj2DTVNQgYKwAQGtItRSp28PfpiSHAbSuw9geYN0nRCzQ3c3yWHv-V24oURA9gN4KYAdpgA3AMxGAKOOWIntEgvoWCYqhzgi9kuHxSsObjEDJIqwHOWoBAGwZPU5MazWQI0FKFllZBxk-ANyNOEWAUAtgWwBUBcAG4RoKAXhlHFkQHVp0pgYqa4ByB8BWcUKf4OkDpgvApA66eUB0N3RyB90jgA+l4jPQR4uQNQa8I4H0q-ZpoUgXAPQA6DCZ6AL6ZgBABbDUUkg+7HcdVhkDoB5GggRRohlHjJYwMw4qQAmBgzTIMw9ASsFt0G6pR66QQHOB9GsLkiFWjwSqpDDT7kJksUgZQFIEg40QyQ4VDgEWzPxz5uUjyN4JOFRgp5SxqQzSu6gWhiAd4go7sMoHNHGSqCVsWQCPArTBlXkCIUwOCNBRbg8QdObkB1ISC9B7APcZpIwA2LQIEYh8NrLyHfSMAZK6AAdPJJio-Rki+IKWpQAWaxgAQsg--tiUaD3YwA8MoBCQBLr7AiQy8fYAthWTcEVBpnP3FmHQDlYh4zxaaH1AwDTo+AnQBRLIDeDMAYUOOGLoYABC9B4epAPECIEnDRs8J-AQQGADiBHZJ4SsayUEF6CFAc4CIMAJwWPCpAlkq6M8oTPbC-hXAFQCiHIDUCep5gEgD4J+H5gsQGwxMcwMECvj80wAcoaMDhjeDM8oAeIWEK8wRARVokw8ESrQCYSQg8QlRDTH4FJCUAxKqAsokoS0ClpoWUAAPMtERkTcDA1QFzvbO6Dog584CjgBIFdh4h5gRgRwEGCCF+AFEM4PEBaE4YqYpAWIQQH4EoTPBF8JYEQIdH2BNVuMEAZCDCQMDMBKCHSblJQEzxWBAwdWKMuGlsA6dr6o+TQL2C+5KA6MTrVRcwFwBD1DYaCTjIlKxAajZcAVWWTn01AFRbAEQKPg4hGK4AnSHNJLnGwWHUA6AKwtgJwE6gCBhAYgSQLIEUAqBxAGgLQAQB0B6BDAJgCwEgsQ57A3ANAaoFBgRq6Ap0rgCxPOi7FgoXyaAJmX1hEAGAvAO6ekvsA5mFBPGj1U9OeiRhdBAm9gCADAATDMCu48uVQL4TAC-QSYAqGoMoE3G+TdufgO8OYAt7zAZlDwIlGgEerPUvg6RQiqLnPZ0AGAPJOQL0DiBjADABgPELiCxByA4g4VcYBIAMCHhW+UANsInjAC8R7BXy-nFxQoAlB-Kc7PgKYAgDIKSceIE5NalpAOw2acQa-PCoMgecRA+wd+T9QIAMg4gr9OFbwG4AtNNQMAewFAAiBPxHlJQAYKQBECEhtk1bfYG4IxDhjReLcRSQWCLDwNywlYasMwE0kGhuIbYLZowAUB5ssgeiEBLfhTgWZNIh4A4TOAaRtxMs55AtK1ErDUhEcPXQQBXGnRKxiAw3SxAUEqCPtJu03WbvNzLAoICO9waQjUASh81uAYUs+NwFj6ZBSc8wBxPMASBYA8y3IGzskQuGgIeUpAMOFcE7poLF8RyE5PwGCDvcfAn3b7nXxXRcVAeI8YHiMXpC8SsgrTaHkHIkDKA68b8AEAoELHIhSAIyT0VgB6wIkbAViUgI0TooeIhuMALIPRDWbslmA4Ya-NwAjZZAtmmoXABcWhm2VphlAIwGpD6gocIgPPNogyFLERpwM9cWNvMJgRggvirgNZnmHyAbF8AuAMwgiEKWdgK0egcgB4HOJWLEC3iZENsHWD7AEwCwf-h2xYi7BEBqCdAFhHmD5B6APBNAK+WqB9R10ygBLj4F3TEBmACgLIBlgGRuA8QYudFBwHvgacjVnld2LYGtRWBggaEUsLYG6DqI5GF4kQEQlVKmASGJQcznIm9ZqBegzU+8WgCHwkkSZJpdOAQGlYRBVUWGAbHTj8DWFzqHABIG9L1kCawygCAluRgUCPB9UM0LAGgvRCfs3p8qwQHxFMDjAsQWIA8B6hb4dl2wgYEoCSE1CP1C4iIUYQYHGCyQqB9sqZJxAQgfLMYi+EoG4Eta4ABaWIUsKD2QiNNrozcsLHhOjGdxu48YreYPHNxbicOpybfsgLbhthJ48QVflImTbhAMa-2M5MH0g07Q9oEAIdAiFdiMB5gUAOIGOAcAIlyAnlEYGVHoBUg3AYABTvsDiD7AIg3gfmt0CUFnifAmAAgI82t7m5ggEgCIA-J35GrVSBAJei2B+A0rWN9wDrNwR8CuBhuL4FUWgEjzMBb1YIKQBjUwA0Bj4HwR6lAFHVQSPeoEfrFYVmguwucFCVinED4B-AIgL4K0ADDMxYAYgS27oAkIbC4AYAZ8eKEZiWzyb5gDEWbHBhsTWJ50OiUSGgEFaIwhgTjPAGCCfYcQ3RW6GFOQGICMJCCD6OOBRuoT8pIQEaSEIUAyT2BWyP0GyABriCGwAKYwZojAHQCcYhgJOZgPrAm0jgBAo9J5W8B+D1lkQbgFRG4y6m7JxgkIIwNDKj6CBRaYDX7SIEIB3pIol4fykYGZElw3gRgVJlIHUSVhcmTHPgDMTdbhVl44wOxTTny0YjggOqKCKQHmBLr5gMAa1BG3MgcA8QeFAVNxBgA6JRYYAEYI0H2BWB9+ygU1qJGDJup3m7RJMmLvg0vpRggYYIJcDKIMYfMhEQMnYoJBggc0zAaIBNwIykQ+A5gXbucWTJOAaAa9fRcuijTcA4e7IG1h5GCCQhmAC0MWZQD1rHwU1K4BJduoyhJjCwySYQoVtLQ3ovkuIXZIxGUBLR6AXEDLNyCsB8Q0Wcwa-By1UALNm4ryTAHuFAg4DXALtUFO7SXJnIcOu7RgBvW4h00GAdQJQFACKArd9A3mBON8VVmYA5AmoMEMQCIAdtYJaAQ5ZhwthuJLicgPEIoPWAKA3AIXWRAoCUYCpqk-AQYqamCCYBC8qMVwPsFdbPxc+SmDcGY27RFrEojxFHbLFU7k41cS1R4DyhJWXA5AWIEYIEBEqmAv8+hbtGcDRj1C3g0us4KctoiGTHAdAXlmxH3SopjwwJHnhuLMJxM3lS4szHxmskJA6kJQfpiIBsgpAsUAESbmWjT470rEXoQMBIBVFlkxKBA-ztogQ2kMBQcG9iiSCM4fzLwtoHSJulBAghtQ46IMQG0oDBle4sSzpIDMSWxV24w5aydwDPIJA5ohaKsI9DiSeoq0ssHIF3AamuzFJhQVKmcixBLteaiBkqAZHYoqYIAmQdAG2jJqWJuIr0ibqi1BQGoNYUCWHcEE8wQAuQGNXJPAjNSN5PwIHB8WHzqBSMXOHARJClLj7CC8WqQNAOPXRDohJsggOIE6BgyPcEgoiiANBCWhqAzhrgRqByyzQN9tUeOdmZmv+7xzqNXEHwFAD8DBAjRygP0miNKSAMsQd4GANc1kzw0sQjAZdvdiO7uYSCjQ8YDvHMDZIsiZCSEB4ErYKBwkvE7oEYCUpMT8OVIHoNkVfjKAC9pjLINek8YgrphDgRcIGGYAGlAtLcHrE1FqlMz6ol4DMB2CBRyAwAUgAEJ0AiA-5bAD7cGaVgwA7ohgXNHjFYEN7X0MWBREBFlnCB-Y8wjNDAE23WBJQbg7qbqLSHPmyIcA5AIcH7uTXNFxgvQKwClmtpZD2UxcBdKCl6BoxjwCo0BNkXdloABMN4R4OML8BcgfshpWwDgVVmAIrEOhI7JklXEYEtUCUcSZ5vMAM0Hl8c7UBFE1CC4HpBifdsGRfAJAbs4+bdt91bVxA6ECQKlfyFnVQBcsY4IIADhKC7swQw2TlCQAwIsbHxxiVfOpH2AXILIWzOpFgAKjOoAIo4qAIGBsS80Qkd6KgHwBeD740AwwboI2i+4bQo8ukVEH5EBqHjiAElXoMt1RhWA-A1nYcXtDBiK4GiYsjgA8fwHnVlAaGcWYbG7CQhXFQULAEiB22wI8jYAaxIHsUETT583KoGQsNkRK0RyqtLqD1CnIDQlAtW7xLZJKxykdaEePEKVxBNnJxM5h3aHOPIBYZxginG2CQBohNgmkKAMwrKQ0b7pHg5aeYI4CvDEw7A7Ur4V70cCYEa45ECIo3OLAE80AzQesLQNOVYBkQzANoo8ERBXBJ0D+MKDBDpaIUaA0YEmJrmLIHBzA1MTlEzW44dFRcbwCQBDGhrJqUssg2gFoDco5w1BT7V6CQAUDy6ggwhA7IwDiBrEo6jgfiOMHkjoh6mygZDFgCrpWAzE5qXyBxDWKSZRcjwewE2VUHFSY4WQRlDiu1D4aEOgFbJuR2UBQA-dWrbgM5ihJWARgrzKtOaj9jxRJZYSvqAFq3Vv8lqyyVJWsgyUMY0xMFkUquRfC8hlQogcoPkBn3dABG3QC-EBHyDCA54dSpPBNSaUzlWli6dpaui6Uwp5AT84KUoGEAIhWYdYeaqAi6D7As5kyAxDST0pYZ8InA-ABsD4DbBdgEQWwNyMOreFScIgowEQAiJX9ODT1T4O4Gr3VA1BRLQMFfEFZ8hURwUyAMQAQ5OSxmkIaBbixFaUA6EymRPIGG1RkQoc2mTUCcjkiKE6mcGigN4CsDWWIA2lTxsEA8CMhSefAR4FkMiBuCZAb8XAAiUnic0TIOkcXYUzFRV1Bl6IWAFjBSMQBNolYLEzmG4J+GWoARoIyEZwKTW5ShEY2SoMoL1VY0bo2RBYDk1LRE1BufQLxLQzKAwwVxtDIUE4LKLa1ygURnRT4CiM6SGJAVi1FrBPtYIC696NUFdrR0GA6IBFo4wEzbMzCojaQsTFIBbySEzAK0ouwfTQKiQBAIvtyCDkWQGMBEA6hzjQXYMxFyajog3xUDCxkiZFCitBaIvDi3059NAAkGDhYhDCnudYPYD4DygOpRxpWPKBVn2BOudnJRPoGiBX8PA3qiIMiD8An4cYyIDVqQHFzSYoA3mtQCwFEZHMRg3QbCixAkrmBkQwgGuoGEeJZFkQhULcKtnqzeBdCtnY2m8DwmKheg0V1-i3MLjkQ+9+6GMADdh7JZvomgIhOsCBCHIiYOgGBOsDuR4hTrdo7UVYG8wIT7RgJYgOArYpl0y+eTNQK-hIARxMVgQGQBJ1oD3ah4E3EWtyHpIrpFbvWCuLDvYoxx-J5EKlJPAULfaR4TqHuhICbrHdYKJ+NwE5B9RKbZY49D4CQooPsD0YCgA2CEE8DpJ9gtgZgOMANIucHq7QQpZpY+oYAAoWWEQFIHmDBBLKWCcCQoC4U0tiA0rdar0CMCKGfT4k4bv1kRgqJR1LgLIMfAJD-o61LEAgOxmUAEACipPMoXEF4JRwwuiMNel0gXaVgFIIgag+YqyD+jLUssxQHGB7r+iG9CQD1TW36weBYJkeEoJBuRATku9b-P0LiaiwxZ5eX0cwAlmIVsAtjgCc4tWEyzZZcs+WQrLoHGAJgpQrgCiqBJKC8AcQS85niQGz3wgdEWpjpajGhTiNgQpnDGiQyTWBHHwHUgwN1YwD7AjRhnRgLxkKD3dxg2EUwMbBaI0A0ihAeRg2EpTrwZG9UMWcEEEintz2B7fdYAV8DakSA+s37IjsrFPi3zGwGaBAGCN+BCQ16APNHFEIiI-SZsYOmoEQRmAc4xihEOJHh6igD4WAaQG2gUioHCgco5EEvh00qLvQwNrIDpX6h6Ui7yiuIMZAJhZARO9VDILLnpqahOnZhTtDoXsCkxzzPh4YEJFqldwEQ6bNsDeB0CHgBQGYMVJgTzRPyQEtuQwHEFMBQCp92oRkM+p9lKBxg2wTIFuMJnoBIQcgB9vnW9AQsEgZQMtRgAUD8dUYgYX6CqENJZFv9RbZKIGRGg05q22oKQCGSRwk4MRjEErWoHEnD0bNbgKAUYFMzKB0QMAY9Hhg0B8wmicyOvt4DNVaROtN8esBKHsF+7eIlAa0rsEhDYhBY7ASgNRT1nz8W+FxRfDAH9LeAmmRzIMrgD2vQqIMIwTmUQEIViAbSGQMAMa20p5yL698NwA7iwAb0hj3gJ7SMAihZypAmLrAIyXLGkBIQNAQE5CCcDlhssdjyMYXA4qTh6c2aJeWFOhd1hRYcgaDAZAUSUADB7SMTY8GlIwAzCFaGsEmNDMZgwA2wQfJCBuQcVpN7Ka7BoDPb0kSAYVTQA1fpqGRoN9JYy+ZkOpIasgkIDXatRoDWX3ZslQjJ4Q3yaE6wHNR4MEdf37bLgS48WS2AwIBKUEA8OsRmGrJcpgEFfOWDVKsybVOqP7dsCIGvhrso+3KJTEuE1CGMcYr6mgGdzeBFsFAQm2RDOBhKh9fspgJyLZgfRGAcosCSfALsAQcxL6r4KAAkBEC8BtMgOA8ZLjcRkwNK+SOwmn3bPcB5+lOHOAtQKSHAFSqwGWR0Q3T3Ay1HKzUDYBBfd624dAF8LsCjwuOa6WIOgI1YgDVFpCRaaaLW-cBIXTrRMLpYAkWgZYOp9gCDvzFDa7wyYGAVwOtX1yOCggoQcIGSFkPUAY03kFJ7O5kkQXd0s8T1OItGVsBxll6QHCqGkmKMvAYpP3NGaYSkAcgvyVZn+teSSzs9NASELgHITgYWg0GegCSSNkmzGXKCdAaQDiC-hLq9JCKtiRfAKn0AVbY9EXe7XmZewAeV6mnf5RtoQ6KGjgXgXwE3h0uWU8XGABvt4hr9XnLcIXnK+tMDAjgSUSEgYA0QwM7KR4IWIyTSVBwyQ6GPMDFBR4+PpkRVgoCFj6sYbRnTO7xuCBaA0i3h7dXtniqMBEqyVKGRmHMDNQEQIpGdBIEyCOgxmVaToHfmNyEzWbAU37o28Pj1IHaQY9AK51FVWAO2tgeSEtIRbagXlAYM3ikrQCnQayPbxVg8usF-UWotMiCdQBnDRJi84gYOScPW0fNh0YpDwKWTfSyGqBZPhGOSbdlZFcAjwZPnOm6gEwvoBAP0+LpDpgYAqWSZHAzlcoRRzAmoIneLLzB8zdoTNHFMh3QCkBxgggL83+32BR43gD0xelQCMVVPZR93CJY2nXLOE5RYi54AfamC2BLA8wGp-YCsAeFpYWITzvMDlXFtmATOeCX2HoQiBqGLEXumQX44E9zSLNIVwTWNSMZG6r9In4IFsAjBrkJsIr0lUngVMwAWoME82UMh8ALgTyKAIeaPKKnmBVwLno-lS1GARaWQRrTUA07uQUIzKgwAhIIWE4-T9AayBGgwRBB8wzZ+qBwDeDoA8QFFtuIn7Agk3UWLwBEOSAoCgUWQToMKIoSdDCulCfgBEEyD2gRgZwM4H0OD8eDCB1QPgGgPMAtSaAOcxAMuOArlLpQaTgy6thEDkBRhO4wk2MKZAUAR2pofxRaNGH3CStUQN4TbdqDAb7eFJ1ASLCTfqguP4s9qSfEEDUAZQDRBW6foJ0BWgyHGjwRAhQEVgZEpWOVhAIVWDVi4AagpgBwEgCBFQsMlLDGQSw2QGgAVIBQC2QjA1qPkBegPwgcLgIWQNbS98oFHWT3wZ0mMhvo5IFSjag0XmdDToZ8JQBZk-MOnDnUTpFeiZ0gsPmxl0SYrcR2MP+NIiMA9qA2BXiGGN4BYgEgJwjDYmgGACyExpB1jiQigdqCCEhpFkAGAb1jYA90BOLSIUubgJqDASt6sai-0tpFgDk4S+LwTWoNPG8AJAt6pkLSIYTIggWBHgM2AgW6WpORSAYjhsDIgR9I2QqobPLZCDgiZmIDX0XiJL7yIZ0MHapsjkOOh6g8wFQDLgE1gTJUAyFn9a-ehbkFof8hYEbglgEKJgArgt1qNAGQCYO25+AG5DICeQK9pjpM0G9rkwG4jdLIgwox8KIBvAvrl5AGQ00M8jnk9aJiqAInQIMiCA7iMkTbAytksiamTMrR5kkFhtORaAsvBnazcgxtUA7QeoP8D2ASAhIz4IwtjOL8A+6q1LTI8aMkSGEqeHiBfINNDIBMk2Mv-A58YCGUBvAhzpCD+EJWATAdgSBglJciJKGAA0A7DFiAYI7qJwIfQAeCBIJgRBltx8AmEMEBpuWFEGq0sJppKReIICAVTEKGgPYDnasGJtQ-06MAxZE4bgIoEucrsvbKHQmgNdAqwuSO9DXgDWj4BcgrcsFIcAcUo3AwIx8AoAgWK+BI5vQCKucQDwr4mmS2AUKCMCSipWF5wCwLAGMB+WDfIFAIYyFtxBkB+nKNQmcVnEXgaAHgLUGQgcmEcbSsnSEChAO4wOHZKK+YPR5Q8SXmTSWkZevhAH0gPt6jogg3rYBtETMm8ARKe8NLDjAMXAiwKI+QQARXm6aDeZjkd5pOR9Qj5hkTzkYIJnigshIJPBaA7kJPBtoJkJroxQudrgDKAgejnCywZ8LIiHiJpHRjoAtYBeADIj7Jao4qNmLoBkYPaDwSMAXINkyKA81KOZycaAARgbc3ADiDRqeEAqxgAxYI7h1iOwAFR6EXFig41aVYHSbrARjMsY0hEgBYyoiZ7H0rLY0zrwb8GHEL66xEeIBRSnqxANrCUg1lq24ZQVmNjT6oVAFB4QAHAPArKAxGBuggKpuhEAiANsOgDY0bgK+IeI2SOlzdATLmAbjAHAGqCeEkAmRDkAwSL-BykKAMiDSU2-uqCPwJQL3Dw0R0Dmi3EyINnACQWRFLTv+w9vFarI6SuOQFoO+J3DhASgL0AkCVuDoCUAOAO5in4UAq44iAvkIO7hAHABvRs0BAGcwjQMgNOiYBgTJoDqs7gEUyhsaADlAyeBkJlBZ2qeBSQCEmLgwAPhEQNwD7cryCeh+QPgAVwGApYDOj3UuIhFBQAjJNWTJOBALaDNOLRMQD0Aa4mkREAs6LgDYM5jMj4aBMdP8C9AOQJlRkm68kaSYELGKiwGCkIJBgJAQatFz7AYsn4A5Y0uhRw5GSrghaXW76Cthyk6AERJq41BmyxGIofswT84WpsiDMiaEMmQkRkvt-iPgdxK7rYUd+B+yGEjwDGDdAGIpcQ0AyIKcQ4cmeGJqoo--MiAAa9JF8hbgfkPTggclJD7LagRgPsDOkvMKyBs0DSAwDByRMMkQpAtQagRlYwoapLUKrgEtJoAV6jnBGK9VBiadUs0I6hU67LPRjRqtQXTJxAGSLdYaovMHIBpsMNmeFmwwYFoiRK1tNwhOSBHjih0MkGotgvsBNgrTE20WFQRk2J6uE7hG1NlWhaAw8EJCGSaLmeLDAnQBAAR0c6h+SahQSCIDaYNloXCwhUkL9hswxxGGB8AbgFwQ8EPtH1Q+A4jMJLOgLEHuIUQosODCCAHRDnA8yVgHzJ5GHJFiCpsMNnphXoKMbUqgg0IFYBriR7jwBToSjDiJ8AcnBFAZE0ii1TfuMZIKixIZvPXQki1QIGADYnYCMBgAQ8uGCmAjGjt7S+LUOiC2AVbDt6NUwIVNASAgyPsBSij8BsSPAMgCgiQiaAHFJao0ZFOiSQWQNqB0R3YBppJQ1BipAPG2mGFISAQoBwCBgeIKEIPA4uMD42E1Gs0zE0xlMWyFAzXp5pz4GCIGjoA8kKZEzsbvF4reIbvExxoopgAxC+h8bL3rSq49oPpT2I+uRC7I4eAvYZoHZBlg32osFYAKAbvI8A-Ue2CIHTQWQHQDkYWgOewIgbwAFgYAAnPiCEQDGEejdgCTCk60yH9iAjUybXJEw+AJYQpBPwHUuiCzsRuK8BWAn5MYSh0tcG4B94HYX4QBqxEMBKhqHFCJRcg3ylMAzA4wOMAwUVZIea4g7XAU6gUaADQD5AblLWAyWGghEDm4QQEWz1AEAPzi6o45q2COA5gGADIg+aO5w6c2MJQDEAxmhhiVUwqOqDU4UgJCApu5HDABfU1QDOAt2-QnIqxQeII2pfyUKO84TeNZkzxhkb6MbDeW2oMQCEePsO0JJgj0SvYS8NECARn6DRKLB5gFKn6hWhCeqoKjI1gu1AwIHwA7xJGGgKPAacmDKVqYA7FFoBngQ1JwwQshwDKyBAdJOiGeua-g2A7B7SByRQSX0DMZEYjxmFQKAfHtKp9cwQN8SF4a2GIhByVAUcAka6EPIzOkLdDfAZgjDCjpMaRCG+7qBppFIAvsV-uMDzANOuuxsBx4uYrgKxxvZxnQUII7igkoEh5zHGigXwDW+OEKdz34HgC1gBg9hNBaFApxmVFQAlYBjQsY0eGsSSw1CEESQYdMJMQoM9AAhRm+EGBNzb8Kmo-SZC2iAoFg4ZcO8EZxA5GCCNQjAAwkbgjajXR7YZ4opgZYUTJST5kuys5hYgo8Bajo4DTMvA00nQMNi-8iCBChMa+ApOSVg9qKwAIgsiJZjz2S2rLBbh7LA1YZoN9poDTI8-vLz5A10AiD2A9WHWDiM3yCCZesG0o8DjAtcK1JuO0ik9wn4g0STCSsgyhiD-87INpbg4VwBwJcCbwJeQuqDoeQBvKHLCHDC0EVEkQ1k6MHZxmxggIngPgDvDYBygnlFSiHYprMQgrmreOtyYE2xNX6qKQTHb6piOgfgLWiy0hMHX2nSZqCSwNKoUB+AXiB4ghUnIIbDsgUMFgDyQRHkA5F2YFAQBagnNKyZi2tdpqAlAeoL4LWCp8eBQB4D2pLEvgbGNFi9A5MsbRGAuKGXDQSLOBMwxWaEUd4neQ8Gd7pU8MoEyzMwArILlAnREEDAkLpI8Ag8ddIRTk40cCmTjSBXDYCCAhYvDSjAlEvdTzAsiGIDgIBaLW5gg1MeoqHKyhE0DRo8CCgAFoxIBCgYxdaoBpKs9eDkAR4txMbD7qimMmq44ximaYYIFPj4Ash6pC84lAXCNrLxe8Iaax0ICgC7BvWpgHUyH6FLm3DVYyMJCDEA59D1ikgCfKIgIg7aDoQIgmoKCa7+5EL+JQ4MjK4D2ECKq4k3wGgdM5oAHgBIBMAZBOIHw0NBmMAHwp9GwrzA+ENGYGAw2JXaMA2Qo0TMi-ovRJfxJQHfK4AihAoBiQJCHcg+QzAPsBYg2oAHqBgOihbz2AZjOPhQgB7E+p-KMUiuLLAGNFACScYRNKmZRmILW4icD8hHCSAulHpBQoaEFP7Kk2-ofCmQQtCFTmcdvpqDiUb1k2T7K+fAjBAGWKCQh-W4VOiCPKzpP6Ceu8bnxwtaiPISTvhM3PhmjwouHDz3yg0I0BnC0SL0B+WOKFSZ8+9AF9RxA6IEBZPh3PPYA0Gw6W8BZYfEqeD+o9AI4CA+pWjcAJcROHbCPAtgBa7VIEjgYALYWIIZRZQFwsJKhwwQNBA9BMAG8Cfs1QrEQDeSJGWDc8CoAgZ2ocpFyI+AiCB5BXYxmv0LaUmoLSBGAAcdqCZYNUtIBoAgUOVJ-gKmTYhYugYPzgWus6IHiZpVgAiojI4Im7wUo-lOeB5yCQOzSOCmoBGx1gQkMz6mo1zPYAmm8ILSASYaNNDBfkOUtWpxABhLlhyA7ggJRAUFPPBytJMCG3AdgiCDpQ8G49nmiToWMnszbMeAPrQp4AINsh5MluFSAUQraAFDzEtgA5Rzk8wNvYQAddJQAU87VshZx0w6CcD4IUkH4A-K98qHBUwV6oAiWAGgAYSdAMqgjQGA9oAXo7aG4PXSpS9YLZLDwEKFsZVakwAoB-gpSF-CuA4MsITWCTaKszkQqzAxAqKxAPlCBpTQIXA0CPaKkCOAngNF5+Ec+BB4g27iHJweAbwEWr1MEaGPgHgPytQBcKFyZSCRKhzraRYyAuJQpnOr+NwCCATpKQCCyIYDfGkALEDcjdAGaXEBbIvKL9wcUrttxTssNAseLBQEwTCRNUKwNUL2SZ+A0yxozAFAI5QYAEynGMggN5GMk5FqAxD0RsNw6nMbXLzgC4dSDeCZu7XvGCJIBgPMC9A-9NYKmARRNwBT0XYHYKSUJrAkCBgQGK-R0ucQIoA5o1GQoCtQQ8HEClE+oFiDqYmoKMaFAjQOCJl06xI3jwh9gmQCVEdDDQBlESFjooRA1xMY4SUuoCSASAVMBEB-IOUqWKGoCer4RuA8vLpnH+McTAAuW+YMQCA4YBBeG2Az0DCLmAPpqXD6YpLsiBZYFKnEBD0PqHXljgUCsDDEhLalg4dRuRA3qnQPiChAb4XUoUCuIauCIDBAp3I8AkYIMRsB6Yi+KuI7eA9G4xr+BoIYyLsKGjKIDgnoFCCWYxAUDAyAwITtxOoUgJ-B3ha8DNGMARwFZhfgAYJyGLsMOCMA2OZ4G7TRICuOoiugggNelxQR+PQi12MmFbojwGwHED2AcQOLpjUcCIaZQYoPMTDucJQB9KPEn6Zah3E6XOiCeYN9hYB4ohEPsANBxnu6h+Aw2AKyCgeiPlqdAxfKhFhYLDCFqxiPcH3ARaHLHQDRabYPgAyqhcEoBYAEAJCD3AjgNsiNy+6pLQwIajuRAHwRbOh48AIbqUhX6-wGGrcECiL0Al0CjMUqLY1JKbp6UlYI3lBCIfG9CLahOHhGpA4jEXjfIBAAhgVoiRPXKhmmUj4CnSwCA+G3xpSKPCxIomde4QA3wFkTkY1IJQDKA64SJgDpoKNyLA4bCJ3CqkhINF7y6WcMjiagEHi3x3YjgPND5kS5GyiZmXKFg7yo9dMbFaQeGMVLhA86aaQBgLnNEAfY7+Zi6dkVcaaC0Qr0EMgdMxYmE5cYUEkeCOMfgBqApSncFWAwIVujhDGxCXN6h9F5yOtSRkDtPYDhwnscbEE4NUovROosBDSluAIwI2ghAamPjhkJiEG1o5APJCTiMAlcAUiJhbwGnl6AzgHwBMuIwNWqBW7GFjKr5Dft0D6pQ9mwV5g-KnAylgQqkgy1g9YI2COkH2DfDsyN9ulxK8HSKVgdsxUp0RGi1oifIGQpZBYYqA4md4KuACiE6wYBPgIsAJs6QBOYvAQ8eIyeoHpqOIGQGShGSMhbQO-QgakgJ6zliJQOvHg4zOYGloKZjJ0DEwYOPIh7AJsPMCnW3AD7iiK8hnnJOgowuXz8whEFMGyCkSi6AvA6EL8D4BOxkNJ9agrHXZaEmJGyyiKWQLWr8I9QfoDVkSoAVSbmu3LYAnK1tIBRvA-UmU7j0F4r3zFOhQI6C2IEANRZ1aNAEGQnQOgFgAdof7DZCv6bgN0Dj8b+MLb32EAMFSdSPyvxBMov1sCSfwegHhRoKV4IJAqJPWT3p7qMRMOibKN4G8pMAqVAlgwoabEAhLQWOiAjslEQG9ZMkygPTCDAhwgZCAIjUBzDtgQ6PPh3xXCCtw1A4wHXm0Y70CxCu0SVKeBkQWJHAIYh4-GLJqA4eCgjQA8TKLS7u7sAsAwQNmQmAUABelGCFiQVi7BsGVwFnaBqNLEYARAeKK9BRMrwLERPq7YNBA+20GhiK8GysAIbWCRnBfpFo-ABAA5AWQMyrPEulowBYQtCtbxQOYADSR4gRIORKDgcUMRocq6IHWIdoh4BABSw3RjU7bE-fLoAjAJIo6iAMBGrhqOAgYPQBsGmDHsC-u0NAzgOFX+PyBfK6pMXKmcpyF4CL4+WlIBAGrssYq+5MdH+BLCosO9rWIxINZLFKNjhIAImI0NVhEsmOgTjucUgHPoecYbCbEV8adudwtELIXTJvAauAiDPMaQORi7MWAGnhQx4yHJidW2oBpy4AJ-k+owoSQLdJl0PiDQCKmckgali8eYMSZKYMWPtStkGYJmYzW2lKCw089YFoCzcaLNYJQwzwIlBuAkyIUDaoi7AiD9MWQLLDbI9XCGFSkLlmgArAkpP8ARAbwCuC8gR+cTBIseMuDKTcICA1gAwOgJPAVo6xHakeE9qCKC-cUUpoCZUs6lNAdAe1lLK-oBNOfRNkbphlA5wjEZkBZST1Ndj+ejgIIDWUOIswBdIB1NPjkQeAPXiCoaIQOrhARdswB9ArKLYD6opgNUayIM1D2j6sL4KtDGYR0AYI1xj9PVBi6BcGeAHgFhhUxhKTKY4DFiroTh70AcQjCR+WbkA-LKMuGpnx8+jgNZYtMJWb6RigBAHhTTsbiJslaw0aLKKb8+FLQruArxYDRvFEYh8V0JYMirRtQgyqlSEE+QK5xOEigunDmAUKDhzJsyCqVidAxGoVpGinoLLzdgbWmAzKAZej4D+AHwHihCQstlIBhgWgHtiSJrgAQAjUyFhRA0Qc+njhB4jgH8TbofwATzgwtRPqh+W5kGLKHQlLnU7YoNxpnro0jYmeKhE8ulsiKMLWDiJ28EUM9iDVR-I3ATB+6rWDrQoFADmV0qZPQhcC7mMwBzwvQPWQRA+ZK8j0S1+jyBNESoq7KYwU6KsAQACkA7rmIHnLkA3g9YAkBdguAF9qFWvOfIEfSC7EykGU-QPgCpMoTI2QWoMaH2A9KCIHbBboKaoUDSpv9FYA+VZRDZhCIWGP4gjpPQnID2AH+B1FRutdmDU8qHxP6HDkKtEGFVo95qGEzk9CU-YJASgP-yvqQmrILxhugO2jFyAmd2gIcHqHAF5ALoA3yjB3yD4BWMDYEUZVx-wDwQOO4MmjxoAZBsIRDUw6GgF-QNYQ2BSyr+eHz74hQGeIw2-Aa3k9OZCLI6ZknSvtguWNAPYAAhNBkrjRsWQPphKwpGD7RPYh6s+xoAuANyjcARHI0DoC7GKUC1KVIgZDJQX7rKgog8kKoKwUzSKCiBwOIFAqeg0ksSDbE2KK3o6iH2CdANEK4L2D1yeoDVq1K5ANzSZCtlLYCVxFEiPAZYrynjDEAJQE2lLmBPIDhxSlON-RZkpyI3hSRBzGRi1qVBAOnhkS2FiCU8RzAJ5v8YLuRA+0cYDwDy84LBoCjojEMIBAogJp9jWpQxWQQ3gVJqDwVlUAM8AOU98OqTUxOJueyFwdyDB55gkIGTgQowQBPQL4RSukDSBGaXVFg5CrN9AZoWTOPB7+pgFAAKATqO0LbIiyj5V2cEnMYzgYDOMRroiHgGVogMOIqoy8xoxrDrsoTeGaq8oWzIRwMhmgvsovqRMKYDzAIgS3TtgzORhDLw1lDbDvOfCmbCZ4igJV5Ti9fslD7sSICXByqGAN2g9BvyDABQAfgVoq+5UiKa6hVgTAyWQANmToSOgirGWhYgYUHiDJOx2t0Cy8moKYA9qCiDQnCE7FJEAn6OaLIBE8fqB5yNAhYAPCEyQ8HWAlB0SJ-wrKGYHWLFo6ADM0uVaLoCQrgHoHpjogNIGrBeExxqZCmMzzJ0mpYK4LKQIaibq3QYAHABPq0A6QLOCYxTAAbrFaEmNOhhg+OJvysue7PYBRIZsX+D7awhAhEAUQXlgB9cpAAfZuGB6rU1-o6bNRQQYfAO6anGPppgC1gmAFkXUAkmCSKaul8AHAWyZGNyCyI52MJLEFHGhoFLgZUgOrmENdCMC-oEaFxhyM2oHdhthoskBbQiyRH+CPAeYPBEs0jKGLQV2hmeihfaqRDiWUoToXEA6cHrCoBaKuSNaKhsclY8RhwKmRoj3cmfM4hNkZmFABYAJoN7U01VWo6hZA9HuPL7mleboTJlhcF8U-8vxdsCN6rZlCBSF2rowBUi1gk+HF0bbt8QRUKshPCzg8gPaghAoMD7Si472N5ofCvEa4A78EgJxilVS2mcipMbPM-YdSc6vSTUA1tLxiSUxATFByYHfARrag22PvUbAYRqJ6cRh8RBBzAlALWDMsVIqUBIW4lgfBp5P3LxE7G8LZ-WmIwahUgIsuqDgVOGBwhRDDaHgPuzQBzrE0Bgg88QxBmQ2RFhhMpvIOMlykxtN4hbSGLREC8CAQCeRHM0HF8oGAsCB3RGMpOkthec3gvqjsUaKaWQH059NQlmVKXBwVha3BTs15gkvJlwwIWzNxSF0xbH1A6AtDVlg1OW6DeATYHQaoLhAGlOOZ0035Obg3210DQCr8D9nIA3JwCOiBlIb9mk6w6ZBN7T0GE8athbcn4N+AjQikFuhhoufnIw7A0pBag4i4+LzHRF+2OZzso3IAeC5SCRD05Vpf8VRUuA9GDTioicyNq7hAjqNVJoAbwA1qmAO+PfDc4DTI9bHE40DopSAaUI1T4ZU2LPGAMryLRoeA-iAJJZYJREECEIcgFOg8k5aCBxLCZsI6AJA2oBHSMqwkixDbwflV0w1xqBAiBsYX1McQWltkCMA-p0pMI0xUikh2D+Gr0fkDBG70c21U2ZzFEZpiPEMo1niySBliSiAcI5BY4Eigi39YqlnBrKSqMKoBfQCYHWTYOcZA5jmebwtS3CRmbXflVCTXj4CLgMkZdT0mHUgMA+AoCiqDxoxirNhsC2FASFYgMEC97IQZGPIDyIr0pwKoOD6L2r4AJFAi57MzjFXw5oUpstj7YvNLWBEs-Pv8BXlHEKZzHG3EuYDUWVkKQBbuoiDUDI4sUMt58YZ0OZAe5UMKxriMgkDNBuGfUH6TSgWLDVwkw3mo3EgeqdT9BUBXaYRI4c8CpgBU4AVD3DUk-NuXBMkoxsKbH+sSFu5ak4SHOLJlfWaoLWCNdRkqmCdYJTKyA2yJjhQuuzQNj60b0FoDKSOIK0iBk4FYHQuVtZap7N4EvHqoo06wOYCFhbaaCRqAitj6hMArFtFhHY6jmALo+JBOqzcAEmJtDkAzjPKhqgB9LpiSyK4hPiSYaPBsKEAEElnkXeG7K2DQiYGHT7LMM6P+QmxmALniIUKDH-UPiDIsYhDyDFGDT2IVgDgWagdmHbCfkcqtpwTIBTn2jrAbgF4hEQB9MCEjA62FGiNNiCJJGssTGO+g8Y8aDQCBgIfqIQAQR9Cn4NMrDjZi7QNmKwXYm7ScaSMRiiNwRdB9qPAj5ldJmli+OWWDlh5YBWEVgFoh4PVA3AvABvhMInYDODkAtYC0QZqwCLOopO79kSV28e8nIDjuDfIW0tG1+odGcyoFeCJAIhQIcZBI5IIq6CA0gcWBfhVMOWT3AW4R0BRqA3XXnFiDwHWAJs0QK8Ce176AC1pAFaEkQEaKSlfD-8clpoIrGigBoDZixIUoD9e9pNWCbwjEHFCiwTNYfCXUeNJKyagODhUgWgRuMkg1ssjiMDPABkEAiNQAQdWT2ynFfBo7gywDQDUaknhbBE+vMT1k9YdCTfCMRZ0PVyrkOVcLJfQjQAaFggmQM1BbM4fB2D0geaMUBtg8qImam+obLBjloNsPvj3AdQDfYsMypDLafQCiPASUwKDJ2DdloKJTF6aXUMOoKAJcsehyY0rIMhwKl4D2hCwN4ESoNgExnoQW89FsN2JtOgHulBiopONBGArumNSF817U5CFQwAZ0lwgn1CsaVgcqvuzxGbnPKWxEhmu7FqBKsCCy-2UJFUJxoncqkwaiwisF4E0CIFYCiwyROIx0YhIN72eiyrLszsyIMW8DmAf5X4D3AMmQQDv0lmFoDBw+YIO6xElADY7mQlAPJqKG9GHDzRetmM1keMQIFHiZyYFI+ATmp4W5q3B5dReb6AySrVLGpKVGlTGkWDuSZ0moAdWDSEmaGixRuVgHbwDoYZHiAPGzROYBxSffmgCgo-SHZ5pO7bjgCKQk7uUDzA0QURbueUEn+C1gjvXJAWgM8PVR2kzZklJUiryj4jYk2CtDQsx90Fdju0zWNUSGIxiJ-btEp8VSIIgdioxEQcD7IISjEiiAoiaCzAIxBTowJI3pBMrwEYgGAYADs4g2bqP6Jugcqhpw9ofQJnLFsvuWphoSHjEpRbICIFo3o0IEnbzkAtSsRoIa+-ckAd0M1gkDYYs6Juio1vJQ6CQg3xBwCEkYA0RLOuzZMmWmN7Q9ZJZQDYE5gS+Abfui3hBANJwkAYHW7LAkvgpASBgZmoN5raRyCinBpH0tsinWBaLtyss10BPSAIKygfZwwpJozW0QI1AiiOC2oI8DMui9K+AgRH4KiA-gf4FIgUSF-LIBMdshnsSCdTKEQCagWeSuDsoBgnx3agNBtqCiMt2GjlvoH6OETeA+spDDwYMPtBiyuozpb114Jmv8AUEvsPlYO9kQC-BJUw8DVpvpo4MoB74gaGaT1Uq3mACBGmlQkCqYPdKnJ7ErfMSClYygFZ3mAdgqsDLwSBaXDB+3JCDE9wKINWphM9pdCWLxpWL-AhlZalyJ4gQGrxA1Yn7e8W8q7VIbjG4pQeC5Qc0qs6xM22hWrydi7wZODFo2zBUb0mkMLIIm8ikL+hRIb6GTRc5oDsyIoIJ-QlxpQKAvwDm14UsHTH2g2npTVA6XETDDwaYhLxpObYFtKDCxEZkbjAZzphWfgjVC8AS+y5vW30OoYFwJoO8nWbYcARasy2EIc4qyXIhLoO6h0wTVAJmN4UpfIISoQxiJZPxV-U9qNwS1J-B4oroW4A4i1GdHj0AKCK2JaAO-Lgr-N-lOMIdR8CshxoAVcJgAEBqct5F+A1yUIi1KNQDAjWE5gPYDlYJQMUD4aBgLqwa65SUPjLEUAFCRr5pHFHwgeMgDgo6Am6nOOLIVdcrSjkOPfXXTkg0EEARhqBEp43s-iLGE79nkKDRWwGxA5TYhB4LURKA47tpSE4owbQBsAQ0OQRKAmOmUIF5sEoXCZAQINxC8EEBrEh1gXwh4zbkPaHOxgwD0jsAH9XIIRhDUQkOXIVw1WBziOmE+IGCPW3BEIjXBVKp5C-IJJH+rXEPBhiaaWktcmQG6WLSCqM4mkIXTcQCsS9QVG5ELxJeAwbYZ6uKlErIjfE6sE-ihprdOsC8AjzI0DV0DSAWHZKblCIQg6HLER4kSMGGAOncdgz7i3qmAWYFbIimOvywYYSvwAlAEuDK16Iz8BImGoMrUUS1wA6vrhhS5zfRL4CmiIpJPZd+YVqBCtwiHmHFecKFmR5h6WF0fFw4pOTgynqAH2pUMMvJ3SqHAKuQ+0CLgZRLI7fBlCdAEjo6yBFwoDQx-cyDGgjUxQBCWC8AzUA6CsM5wFJj-ALDJ2K1WPYgeCOwDJmlRDinDOCL+0qgnaNVNoEE6MEmB4IuICBXCJ2lpEVbOGQNgvkgR2BjreSQgxePpiICFgLiQPCGymUu3SMax3hxSGkvtJxouBPodVguAa+Uv7Ua+IN-QKYjALYD6RWvOeysY75R8qfwjyNGjFktGEab8WpPN5ZyAD0pzjA0LnJgyR0prkBLpJnQAOqloQogwAyZAuDoWGE3OKToNNFlGRiD4UdF-hYY4-EBriZkTH1Ca5CQD+l7QN1nTULNMzO3LzMizD3JaAqgGmwk96wJqHaUjQNX3sMPiIICnloQCBKF8EHA1o88sgr2hX+ZyNwBGA46HNC8610OvCxe2YKQwdERXrTjyZu3S-LIwPmB8Lh8eiVCI+AZjOm3IllJLaAn9cMBQDCAa+ciCTomAM0DFCx4MtQOY2IFB6Ug46GyV4UiFLxrjo2-gajcgE9OGqKBcdNxw2aFaX+WjSSUA4SwmNEPbKnKlYOPI3kalMIAqQ4QChy4ADRGAnwgjOGXQeE6AH6wuwfNF+GihX4chbOoCQGHAMm19JjaBoJdqkAVAJSJ7k6wjyEyn-YUDgXm5MyIMDSLiVFc6wOQWQG003xpDH4CPwrgN4wMQclJVmOIEnBwAMlxWmFKchl8iIBxwHfG4h+AgYMl40JZVI1BQ17UDDX7ohnGizvUNQEbhdBjdoQC3WYIGSDJsaixNyuuFNM63iKc4hrADootNhArIEvl3j4A1ALnghklMp0q0kRwoTIB67sETBDiW3Dt6ehsgmTGMhlMVxhXJncOYi5SmSKwExe3aezL7s9En6OkMWyDwbikDUyzH1C4JSea4giGCQAoYQKLrXBSjkg-iRZIgD16YkzCEupFyatL0q7QtgLer1UkoGhw88IoGhUx4KybtBW6jcqJreAG9NbwKA0ZCcIxggYFgqlg9QIQCOUmKHiBHo2mETAlAltVM2yQqA8kOFQcdC0vkWdoky5Vxo4oMqWNJEd+Ru9HzAs1xUtUoMop4bjY3IRUGVuqwjyoiK4CEcBQktB8A8IIMleWM0IlCMAUjPkAu2k9B0TVY4ugmA3qEZOnAHuwgL1j2AHQO6i0tQatOiucZatEA9cgyljEgIXPPujB0XgBFRbOU8PkCrcfEzCSBoUZNQAcw93BKUGhsPCFyAwKwO0SxgKFOZzV6uaWLhHkzzNIB-zCQJ7hNte5aWJuA6II1BwchHMCFSAtaBoxKKAeA5mBjpDBwBrxZwH5VXAsuFwIBUqUBg6DGEUMY77o3LO21QQXylKDwUkcUBqzN+EJthggLEKlChDlYOxQzDTECxCggI8JWCAJLEEdCWDEgGoIbgoCOdQh06IFJCRZhg20DzYACV+S0iRHHVjj8sYG8DogtwlgCdQ+AuyjBZNELWaXAJ9EjR88Q+DT4JZ903UyxEv3GsS9AAMC8mCgG860LcQ+0AiT+AMgK+mCARgDLKcIKbkPhtYu0R6Dv5afBQD7aJwLJR8IQOMDO8qbcOIvSq0NamzSL8NXItI1OgI2C268gWuhDwybPUAwod+g4AxQF4tKRsAD2C9M6GlXexQD+TaLUiAIjQBoyHQnZZ2DdgtVkOwHgJCYAga2UvT2gIE2cB1JjMv3IyT4BUY4GgO878HsrQUT3PMD440DkdTowk1i0D0Ax8AN1dhzwA7B6IS0NCpfzBkC2z8AhVp5DMQ8ug3yBgP1IgVyjIgP81QkfGC6woxpkJYOGkwhJ5zxyjCPNgS6InL4RGAhqOpM+QqOTmhuIMlN4JGA92jQD1EhYzQ1Vc5LuYAJZi0KjAn+OcDXSlQWIC-RAaQ3HhiNySQF+CCGPktwCk0pSIZxR4RMNwDWE16TmgfwPdC8Q0Jojcs0SNCkBQCdAMjeE6ZG0Cp3BKNrlVWBFlmnukleWmHFtnWWNmJYpI4bcBNi7MHcBY1HoQgLQBnuEsBeIuqcsTXAeSQQEoJSJI1HkbJA-AAiimA-Sw7yr4x2mIBokNUqHB3BgnO4qt5F7FuxEAFSKkVNVUZBQ4tYAnVrLjG4GL2mDKzAr6O0a1jDqTiBGxa4lDwbkKiBlwkaL9ASQbaj4nljowz3SVxcGMXBpmmcMRBFZaufaAmxknLkACErwRACHOfy8OhWweIJqASA6yZ0DMiR8MVJi4PIFyDqgG0ImZ2KhGMQhPhbiBQBksAYghpBQMwCxifKbiNzFtwy6cor1gVDjWt64siEanWSp3r-wCTxyz4hyANcSgyxgKgowD7CgkEybwSw6RWBbcJOskQ+4kAN+CkMtYJaSRA1zP9w-Q6IGeBpQELBjTq4qztvBoAHAKOjdoYNAghQS38OvBbMYAIHo0AGuuriv0qLGgBcKnKBERpslDsd4h0z8C2MP4-U69AZqXMLEQMAfML6g4ymgI4AWF4sLYA8oljAHYMru3UTACGqoGyyLJsebYSdJbWlglw45Yp5DzxqkqmxbGKoMWA-l8qEthGiRsVCAXecYC5Sqg+gGaLtjgoqtQXInCIaByqoE8iMBQXnK7JQk4CNbxWoxzJRaRW6ffts-tcYn+2DwfBYXAwI+AOxg32BaJSh-ApvdIWeyvABNz-YzswoVosSXqMbMCYgupDHBGwMLlUV87l836FKmnqufpgXHLgfQ6-BgDfgrtsmnAtySDJQFA4RdkIqA6qgZCZ49idxDQwFRjUDCwUxpnB-AyyshpRIqqPgg-KdrG7DWoWzPTkZp+gIcCSuewNTDLAqwMXx0uthGbYBA8mjTSW472FABKEYLE1Ad9agiZqU7PfL+76WQQMY6viBehABE84Pp9inGgZsLBKYH9OxKbwMgMwRGEubnDB0YgDKw66E72hTxKAFdr9xHG6IJb7AwGcEYTqUg2JqCFA6IMLRUokO0Egd8WQMHoOQ1qB8AooCgr9bZrUpNzZgG8KKLAPoXIh1ESANsLpNAa0WDySbiM8PJnTWAkBCQ9ZHLJ5Bgys3JDJQz96AJhtwU6EoAvjREaDBjzOgNxqJQcxG-hGAMxtXCZRV-pMiPgCnKLBmrikEqK95QOIRiH4rFvJhnA2REQBfmUgGVLkQW8j4ATY+0CQCuA1QE+GdUYiSwRyjbeDVh35AMHWC6GDvOm2PsMdKNS1KXIBGi92gCM-BrSPbW0CtASCC9AZQTwKIrccqInWT9ANQIDROs8ISPTqeYyOygt8kyCNqUIBkBlB2gcGGgZUi1eA+wo6L7J66Zo9eFoC61mgFf5GAE6uMizob6e6j-AnMp4rmICBGAAMrHBKYD4UxYp2NgAF2P6gNAgrp1rzAdGFg4W8hWDOyWIw6YAbgFvyM0ydV+AOzId5CWffKQCG0t2BpmQ0rOgzNAedQAb5lACGSW+uAFqaUAvkXnB+WfpSPYckEG9zbMIFFqlJYtZ+C-BGqpvPsDxVcOY3bThgahHC+uXcC3z+gAmNBYoUX8tahhKe-D9g2ciwA6gMV4gIMTGsyQj8KncCFEED7An8KbU6EfYF4x6o8JPWjNmH+EgWTczZm5rmjgnJ6DR0k4ywiS+IrArFMStZhZDEQm6OMDb2CBCMatIWcLRoBoHAkFgAAugAC+QAA`)),b=
JSON.parse(LZString.decompressFromEncodedURIComponent(String.raw`NobwRAdghgtgpmAXGAKgCzgGzgJwAQDSA9gEY5R4CyAImADRjU4CelACkgKwMDqcALuyQA2XgPYB3AEJEYJAM4iG1NgFEYAB37MkARgBMytgDEArpkx7DjNtNkKrDSlAAeAZQ1w4AE3VadiLoAHE6uHl7eZhZ6IWDO7p4+dnKKgbFu-FAW4T5+2lwMGVmYOZHmloiiYEXZiWUWyQ6VDADyAG648nVI+gAsDDJE8vx5AQDMA0RD-FEVE2CDw7ONqfNMRBpEAGZbegAMhZkkAJbHmPmI1gASUBDemMcQAOajSACcAOwMN3cPz7PvKo-e6PJ7LGQpQGhdz8ciPHrWFBEUxPNAQODyVK6A7VWGmADG-FMOAQiE4ugYqnROCezAAMkNUv0wFTcLSGZiVgVUMSIFJsD49AwULz+REuZcGGYsABVeQYpRgADCRAgsKIJVhGKxDAASqY5NgMiTMUgcbqoPw4C0tkqHnIAWS9Zbrbb7SRXs0wBarTa7cc5BLOABfOjgaDwJBgAgk0wAL1weA8j3RVDG9EYLCEiGZfEEHCdYDzkghTW4Nk92KMjqrNgltfipUr5cbdRrLbCdXr5ZqJTqnp7mVqEUdVV7pXB9lSVXanW6lxxixGmgu1iXjrXUyW5Ql1nWmx270OUBOZwuAFpmcC-i8VwFsW9vrcQf9yvtYtfQZPIYE9rFG7CUDwpcFKoMiqLoqagRjnihLEqSwg4qyNL0oySDMsh7KMkGwqigK3hCjyOB8vhu5SqYsryqkXzKqq6qaiaqTWPqhpwMa2pms6vpugGJCOuWPquv6cielUgl+u6QahuGsCkt6xz8Fa+CUEQ3hYHgxh4AAOtUoJtEQTxYDpGZMKwBa5uIBblsWtiltORiVqBKg1k5tlTo4cSdhElZVK2I5vtB0KlN2x7Drkd7cuObYBTRUX+Q0dlILEs44F0ER6I+Cxbsu-hIPM64BZu0zfk0e44Bs2y7IgmVFKe5wBOeQLPjelZ7KBn6vtEv44h1YI7ol1WZQBcIQD0zJIiiaIcYgsWwUSJJ5bEmGoVBGHUlhnIDeWIrEWKgqBLhu2kQN1jSpgcoKjNDAqmq5UMdNzEGiQRpalB5ouhJvH8VxQnuqJP2fYGA29NJkCyVGzg4AA1k85BbHgABanT8AAbyS+BSCZWYFjRNlJWI+b1jiKievoxMmIV5O7tYfnhblgQ0bT9QVLojNeUkA2s6FfbeRFhZxT4324sUE79e5V1gClaX7fosRLp6zIFV1+XZSVTHKOVB5VbWtWnPVhG9Z6bztc1X4BW8PWm51mASkE-5hIBwH6FUE0QdNOtzfBXDWMtHLUZS60rfItuHSR6UHURYcc+Lp0UedVFIDRN30exUGgSxz1sa9qTvdxwl8QFzLiTxIl80XH0lyQEpjKDEZyegWCJkwUD4hgo0a2ZeUE9m8w2dXDl87oVTOQFQ9GPWvns74g84kzNaz1PRPc02fPWALzM9Mv0UJTHrQdKl876KB8ur5MxWFWf247z+ZUVYeObHnVFwm78oJGy-L59V1xtPq-1sSj-TyMIRp5RxK7KaUEYI4AJPNUkYwkKBz9uhAObIg44UjntAiEcdpR28GRMAZ0Lr+1ordDUqcdTeiei9RinFvQV3zo6eYxd86eiYfQySA0a5hjBpGZAdJjhtFBHgAA4uVDoeAAAUxgoA4BgLcAAlFjTuhY8Zej7gNYeahB5rApl1XQOj6zzCZpWNmCR4os1McFTms0Rb9j5jBWx5jE5b3MRKGiUtD6K2yqwy+MwL5ZXPtfUqGs77axxLrM8DUP4tT5p8X+n9HRvCan-L+NsBpJKCo7UaC5hTgQgakGqnsFo5nLL7NChYymbXFi7PC4dQI4MwfgwhCcvTJzuuQwiGdqHTVzr9L6AUBLsN4v9OhecOHixDNwuuUYfRtygKYPAHwoZKJ7t3cyayJTMhJoPVyLlx6c1AsYwek8zGC1Hicqx4sx7CzCtPem8x15C0eWLH85YPF1MyifemXjAlzF8WrLumZQlHmFk-Bq1wra3npm8TKvVEkfkhQC6q9tgFAWyWTXJk1ILEONDAr2iAxhVEqUyFBKE-boIafhQilLxQnXIpRS6Sc6LtOzp0qhWcaGIF6YDAuXUxJDNLtCgGlcJTCFruDZAUhyCmAgHgAAagAKRWVZNZziiyWTcQPemuhdmj1cvWQ5U9SaGtORvECQUuwnVAuvT0NjbnzxcWcoJWIcTvJliraYPiAlXwqEVH1+D9yVUVBE-WiBzzRLfnzD4sLEUxRonCl5TQPiWKyT0MBeTsXBqKXAn2iDynzGJZs0OmDN4YOOuLeYzTLoGGusyshrKI5dI5T04VDCApsLGcMvmgzO1AwreK3h0YeDnjcLoZV3JVFVHUdUrVz8aIjz0fOtyP4uZAJXtqjspr2wWtpVcwcji6YXGZM8rq+77WJtSG8-e0ssH6HLF8i4HqfWlqVmk3eQKtZZpPHrC8EbnhG3jbG7+ySEkXqhGu1NBLEQZvdta7NXAiV5qgqUpDwcNHFqpdg2p0cb70vjpdKobT62cvTuyjpXLW3ukYZRrt9yaN9p-FwmSg6CDDrcL0cdajLJqunT+JdlY9y6JZoJ+sNMjWDyGlPGsknTX1kKQeu5FwHHnq6nanmTq318b3nOcOvQ-U5Uff8-xr6A2ayDYEOD37IlIHPPMQ2sSQM3kSeWBNzr3ibuNGivK9SYNQX0GveDZJQLEuQSyVDFLsNYPqZFppcciFqqI-dNOeoyMNu5ZXIWzC-r2Po1XLaA65K6gUkpKgql1LUG0tULwbAtjzOMh3bMFl8wTo1VtWd95yYOrrJzBepqfI7o03oC5lqrnKfU4pgIZ7xuOjU6LNzEs3VRc+d4vmT6-FdX00i2+n7qqPx-eC+JMTtV7Ds0BlmewIUpKRdiMTqKnYu185ew40C4LFNlqSjaJKwuoPJW1stdSMO7twwQuLLSmWkKSxQpt5H0tttPbl21uWpJTIlagOAxxW6JkoCjCQcA8D6LcOeJVDWcaqt2+qwmBz2sxGrKPWIKhdy9fXc-Zkc9R6s8XpzB5Q5xsDkdWa2b29NNNGStezxvjSZGb0VL4XFDA333SEcfbtD7PQsA1d82LmzsAKMQ7EBBLYjgMzQSuDL3YFJQQT98piGrdVK0-9-a0WjpA+CSDhlWJ5iJfI6R1iMPcsbgR6tpHnMCszOK4mHSqhUqWjjEmermZlFNezFO1rM6KyDy2UJvQmf6wc76xJgbZrdAycuSu+Tty+c3OmwFRXCmkWi50zLY+K36b3tVu2mX-cP3mZ1Xt6zYb1ef1apd0Dei9iWw1-N7ETPIP6HmEb6aiuzf4t6AW1D3JC3oYd1FwHOHXdVtSLEL3DbHq+7S-7gK-Le0elicH6pofkAxjgPGRMyYICpjlUETjSeVUU5LBM6nCzWnPRfVKnNdOxbVEvIXDKQvOTfnSvE9CoMbObWXRURbHoOWFvI9GXQFEzThEJHbXvUFZXMNP9KFZ+P8Q7M2MfQfJzMDX8FNfXI+TFN2NOKBPFYpRCD7IOULTfAA7falGLOlN3fDYhY-EjFLM-TlWHKjGKQPIVUZPpBjJNB-MAK4FEIgAAcnkBEVuDjHgB5zwB4BlTUhwC2EwBRATBRAAEJONcZuNEBYheMRdACa0bAawRNOZbtmd7w88UDs9YDOZj0ecfCv0VMKhBdXEBp3Exdw4+gJdB4cCI48CrkCDzNa8wUbMyCjYR86Dv4yCkVAFhovMcxMoF9kNTcODSROBLcyVyk1pbc0N+CaVHdd88FhCD89BQJxD3ZJDM4-dFCeUA9BjK4vUsteJdxVC6QAAyOkQgbUdSAASUWJIE4xT2a0cI2XSUAP82AN9U8Jjl13z21SOP8MCFOJGxXW5wUwVn5yeRCKF1FW0wPjiLb09SD29XW19U72EPlzCT71DQnyH1iSvDO3eFyOoNQOqhNU82AkJRYPyX2GeyqO9m4KQV-DROwh6zaMEOdz33VhEPiwlh6OS0oSkJbRGLhz+UpOy2+TvxvlUIAEEAArLwfgPARYtUXAfEOALQIgHATjXuBwn-ItdPemJdGbfZcWSxCA1cJnaAnJcAl3JicJB43mVvO4y-TU+bGcWImWRcLA8YJIzbeg7bdIgE39Kg-9WJLXSfCoN4UEu0gBPwyDMYefR7NVXFV7OBFDRo0tPgxjHErDPE9o99To4kutSHNlckt6C-LqWIcYwVCg+kkXVQtwNAWAeQDAfATkpSHkvkgUknQFVREUrfbZbVXVEAqUq4wvfrJUwbQKes0MldKbUI-mNUhs5Ax47EyWPU29A094ujT44YlIldNI++BxTIsNCE6047IEvI+0mNJ09JRgkosYbaD0iWL083AlX0uoqCNfRo0UlonfbfWLd3BLSM73Po7pWMmk-peHe8pMgIK-JQvLGOVQqQKADM7wYkPAVQeQfEfk-gTjayBw+wynaU1wzPGsHPII2sweFFM44IQIq5WvCvMubUpArCp43sxvfshIuk4cjvYi+bNYMze+D2KzUNcNK08gjrAo82Jc0fKEmFTJJg6DLFB6So70vKTKELCpcLLfE83E3Bc80Qy8iHa8sk-o8-J83lCoHtN8xHeS5HZjOSJUDAAQLIDSY4VEJSUCsnJw1PH8enLRSAvYmA7rK5KA9U5+YbJxRspmCeeAzCqvM4yIjTTVPCl4pvQi7A0i74wK0zYFcnENC8R04E6FSKhc94Ri+bIovXEo3oHzLiqCQpZfYpXofi9fCWAMlwgQ4MsSjo0HatT3K8k-G85tO8xMhSwFWqyvWq6uVQyGGGOGPARkxSOANUAAE5KyVDsKMq2PFjMsrBgvZ2rKaF0D8NlPvFsobOL1QrL1cvFKwpBUQIAWeJvXQn00l0CpfXb3mzNPvhsSnMvDoqNhishPeFO2XPFjeFONn0N03Nmkyp9MxNWg+qaNeSDMRCEIrTwyJPBxTkqpktvJzjjOpIarcqas4VUIIBRggD0vkChlVG8H5LwDpAADox0iyVFwLhr7dyzn4dEawDEucEKLKmzpMlqpry9ec3LECwjq8dStr5xehMDBzDN9rJRgrfiKLtZripzsjYkEU7TwNXNWKLlXTxpNzmDcQ3quA9zPteChLmjItRLGkSqLygCSEQaJCwbqqIb5LHRy5r9GqBV3yfwQYUdB05VVRSsaRur5VYANBmBCyE9k8ycIL-8ibzLn5KyWZQCrkYTZqrK2c9F5rmy6aVqlM1qtyOzmZvL0DLgflhgvVX0DrfkQrCDLMpyZz6KJawTqpbSWKAEPNINyQETjd5btz8VhAaIBKGj9zvqywgyndiqwzSr7I9aWUDboc5LarMtLaRlYaJlVD1CngtCdDVBHg4w9KZF+A9LX9Mg0BMAicoAnhvASB7BcBbC8bMpVFaxnCsRXI6yF0WZNF6wZS7L7wb6Fr77o6sQuzb78Z3KFT6aUCl4fLtqCUqgH0AgTTpc+bUju8JyLSDs1DIUjZbqWLwS6LCiYTINsrq7poajkTeLKhaiVaH5vsW6IsQzS0Tyu9wzga+7ejDaBih7-Fob6ZmJLbJjbb64MBsB8BiAyAKBKBMY8awKNj1jfamhNExrLLAg4KrkZrX6nKpNzlabn7Y7Jt46X6vKt8U74jPiM7DqgrRzXc-j1qld+8RboVS7Yrqorr-50kXT9d4FUG04AtFbKhgtcrla0FhKNaiqtau6dbCMKr+7UtpDIbQtaGLglKeVNl4bYwEx8A3BUacANBjhVRv8ydeGBGnsxSLgJS5DrL7cjk6H5THKMUmzGd5Hmazj0KWaoSG9fKCL1HT4eagGoTjqqoMiSDbMLrYlmKTG3gxay70kkLXSaJyisRBx7HehnH0Tc0jz8DCq-qQySHu7JL9aKGB7-GTatT5LPQEyGGNF4aeAOr7hEwAA5Qyv-Asfh5dQR1wwTDwyarEbwsOtIQvGsJCy4qasptspRgXHC6Itm8OMYGiAB3AzRrO-1fm0K06kgwxi4OJKB8W6qRzSEgBaWqx9NNKnFQLMYJaXKw8-B4GX6touZnWo-HxpZvxik6hrqM25S7tFMpkFqmRNqqAeGe2zAKGeQLYDEIkZ4DqzjVdVROfQm0qTKYml88sC+kQUV856cDze53QaVxy2V2RvQVs+5648I0LDav7FOsYXatyzOglH499XRsK-R0NWBo7dJ+KpA4xhFraEvJ6mxpiHinc7ERu3K2sfKl1du-F7WiS3Wkkgk5Zsly2mseQ5+GlvQJk4ifgXHaGPHfELGj4QUsnUs8WTPVqER2sBnHsnJ5+Z5+VvN-Emnd+yR4IuvNZjVtPVRgc9Oj4vV+pnO8zfdM6gu1qS1-Yecm1q5cfditclF1gnuuu4paxvBnB7Fz7Y8txmZzuwMwksHWtKShtH3WSlZ8lxS0NgIGiMe15FqhSQC7Mjk4RPABVc8aNNwYwTjawVRIUyCmd4VjyMVwIA4ldO5yR6ax5iawp+C4tw9QB+O1V8prvKt-yhRnmtbJFci0K5p-vRqNp47Mx1JfYM1ztldE7Htp2Dc1FyKdFzFv03Bj17kES9x8tYHUh+dxZvzKqqh4NzJoJjrcNmaVQ3UOAVudkukUwLYfgPd7ADQTwD20ybMZJ05gVw-HYiVjcCV3cR+gTd9vRF9wt3Wm1Wppm-V79pO3Fn+w+Tmmtocutg14HI18F6D+DgDBB82eF8x+6yx5Kh7TDjEhWlEskCZlukFfDuzwjjujxkj+ZwIcsf10tQNmq6jjbdd+qrZq5Rj8PZSMrTAPAJUZkyrDwGPePfj9ZE5lrG9tutJuj9w0eKmbN8TDdGTlmOV+ThV1TkZZTzytTqCjTuI6tgzX9upvTnRgWvR6ii4Dt2cqFjp665FUzhKvppgmz-tt+wd0kXobBngvDtWn6wqjz4j-fbzsh4jElmM421d7kWjxULdssVQhuVhxGXHY4DMu4XANY724TtVO984jN8mq5C4yRgpiO31PJ+TgpxT1a1Tx0N57skan5mWNOhr4Fr44HrbccqqSckgpDrrjrTrhDwafr1iu1qx902z2u9FsdqbzH37VNvFs8qZ8M7xhd3xtb2hDblTrb3Bnb1YHdzjzHHMw949oIMYERdHYYB4THRJtL-GjL1J67t9nLvRMRldCRn9gI6mj95yr9j7gK5T5VqI-g1RtbPa3TkB-T1r9s9rxr1XKF6162d4eDwoqzuE562zjKhz3oV13D5u8dv7dz71zx312sPzxtUlwL6-ajdZmGsLxjSNtUGNqGPHbwHG9MPGs5t+k+pErLhEER3YrJ0qB7sXm7iXvRRPp+jyGXkD5Tj5+vf7qLLToH3mvV5vbOzmcHrDrXmzHrmH-YPX+H7EaH1JImJB-XUZh1qPsbrgbH63L67y+3-Hx3oktwl30-ZdoNj30eEL3m6niNphmZS0OZUwc8N4fEJN7nlN2b67oVrPcnLNrtym+yorobRVnz4p3B7Pr5v72r-U4DwF35UH008v41yv0g2Diguv+eQ3+ghvtD9FDDkbr0J3wJSTd0S3fO3E0HGhuN5uypUtKR17ordSSAXdbkFwiJT9MoM-MkKoWES4AIA8gEgC3Chh4Bx8Bgc7tz2Mq8836-PK5qPCfZTU5OE2PQI-RrCP1r6Z-H7vK0szhEDUefPKDqx05Asi+mjBtpRSFokE4ew+RHu20R5EwZ8VjTigAKIJACMWX1RUK5wGaTsHeM7cMsP2JaIC3eyAifo+Up6bsfeu3OfsgGwGGQIAJANnp4DODHNJ0l3L0Pz06y5cbmUfHNveALZF5vB9YdgUn3l6dlL+P4XUvhR6BvFtO3NVXtowJJGsqKZ1bpuaw6yN954Bda7Bdl-68D2+qdDBjuWEBOccGNvFxurUIZEcYBvNcMkS2J4PRKOg9FAZtxHo5ZVK+WcwWABlBI1r0CkPqoQFIDkAqAbUBwQ4TOa4UXBGbPLvvybKVgo6NNT9jZTP459MmFbe3Ko0B4aN7+gg0voaw16KCTW3NHXgEDeBpDzYlrABC317bZD9EuQ+umM3qK987eUAzQYty8ZkdyGeg0nhRlWZ8op+Jg6-KKj27o56eSYVuOiAsAYgqAsAGAKYBAp41j6DhAppHxyHR8cw1AilrQKZD0CTER-BmCf1XSZ9S0ynUtlwM1Z9kpBNTemP-QEFgdH+YDf4sQX7yN9RI1feHpwCZFIpOAFdKxsN0RKNkgBQQEAeUhyqTMJh-fYhj6yBovCEBAbfQf53qGNpGhQ5DAboEY4L9uq8ycNMIAIg8Mycwwssv7XvCB0ui7g3Wp4OP4p9L6OIj5ipWU7+DquplHgYEGWxc1Gu0QoQaCx2zyYpyDImeCkNy5HCp8GQiDMi2yHsFMGw7JuncJKG4IiG-1LQUtwlFRlXe7wmQg+QqCUseUFtX4cDE-LSpZU1AJUJVjYAGgoAyXbGMWQcKCd0EowwXudiNENgCuz8ErkXkbEhRyuHxOXsEMy5asKRTo7kHqypFkUn+lwukaGkhYHDEhvXDJDCx6b3UkWJROPoM0NH2dMG7IlQXlRm4FURRMYp4U7xxAu8l24NMnrKPQHyiGx9HN4BFy6pRc1IMXNwJVmMCPAoYJY5RIJx4wmUCq-PcakL1rGi8GBDorEYtVmHLVWxGpL7osMTq59r+t6EvpEICCA9PeMQ0tHELzotNzOhdBHlOM6a0FkOTQSccUWAir5shS+C3mANSaucakpQ6AW90BotIqh5HKUUmICaFhjB9HG2upSjD7dEwqgKGA8A0DygeW4fRUgiLUbXcUqIjUSfHyZCNjhGZo8XlL3EZn9CR5TEpr92WEkjLg3YmCXf2fQbCQWWw0KjsJf6jjE4cPUcKhKRT5DMhipBcYqSAHYgih6Jd1uuM9ZzdHhBJSofGPIyj8DxHw8nunBPH3h6OSo1oZQF3aAjFijPRkueCCC41PaQnbnj7UlYgpru8tB9ilMSmXA0+lYNPmTRxEBYbibY8CYXA7GpMVht-HSSD3KnXYn+hnQEm-wOF+j7SJwgaEEGR7JVUeCg1UvY04AFCpuVvHFlf03GzMxRLSInnROjJj93eb5YYpT3oaZjwurQxklGwD5xscaewNfiWScFpsdkGbYOiulDqvsfxsFHEYpLbInSFSCw1mpBLTRlT+xWjV0XpJ2xQcaKLbGeG226jSCessg84WBFs4hidyYY3KvZKxKRiS0ZQqibO0ZQeTF2tQldrKJCajEo09HSZGxOQBuBGSlAPADCkGF8MnB-GbRLd1rGZTV49AjcPQOphsD46VFIkSHXtF6YypcEkighN5pGtIe9Iuqe8Cwn684WH0+6hyOSplFNyOwkZoKOc4qdXOkA0ofPi3FfY4Be4mGePymlFSveIEjAaxJ4RyQ0ZGMnVL0A4wH0ycRBBEUOOSkGjzUEknoETKprPdw6nONCmf3-ZnEzpCvWbl2JunGlmusQjXjVI67szHCH-GvD6PmzRTLJYwAWbZxQpLi8hQMyBBGPtyDTp224okplDlmUM6hhgoKpTw7RvlGGKMtHBjn3bOAYAkI6EbFNNF8tL2b4piEI27SaJ+IV9LaA5ST5lcrZp-QCVNUCG-j7ZCpR2co0V5qT9AjozSSpxdGbD1eoVD0VDx9kN1JBDjHma8lXJwl2p3I65LyP5FpxV5rdZyXHM84JyWkq6EfvLMmlDFJ+yssNs0Pmk5yC5RcpMJCKeBPADuSoUwMMFkAXty5Gxd7Cc2rhn1u02-fiNvyDBR1Kw3gp5jiJtEIFCpXw0CfNhiJhDLgA8wvrdIf5HVqpEDQFPsJECcz4ewgJqRMkG4lFOAi843LiMCxBA+pODRyUKJQ5esB+XnHWnvN0GrAD5BgxWcA0p5+S5pK6OltDFhiMs8ASIK0M8BwA9UbB+ARkpxkPoOEDZFcxcclNJqFQ7uN8C2bm3-G+DOYoCpodaOKlv1VGBfW4qB3dmAo4hqpF-i9Pph2xp5QQMyfQQsXBzZaYczqQ504BRyROI7YoT+DKIaDqFTQStN5yILJykBh4tOaF3Nre92FXi8Js-kiZJg4m7+GAGcBsHYyvaH83Uem2rFR89+lCyYYPEbHbpW5QzM-u3NHCaKvQQHMkauDdlq8Wu+kvKWdQwWtQv+Y+AOVCR-6Bi1yAzQWeb0wZt8XF6JG4eAJ7pbyFubk7zqNNeH0SJpTCo+UYP8nbdTBl6HZngGoAY4oYaAHqlCLO56zuekiigcnxkWx95FpUH8YAuUUgL5h8dKroUXtF3p6ZSRW6cINpHhUokPswBJLSSisirF889FPIO5EdKdyXSgSjh36luKqFoowfjRKhkk9xlAS5hVDWmVU9ZlPQFqo-LQBZkoAhAlACNHWUlyeeiShEVXJOIEyzZyfE0diJkkkq5JK6KrrovbGQKoSV6GBXHwBZDzKR+ilToYpQXTkfZQQP2fGXqUVNjeny4MVcKHZOKN8TkxUAMvKGxxaFvneheNO8nJiHQAyKfq+VCYtCc5bgVUOiAgDMkeqhkfAOoULlYAueqiCsX9n55idR4EnTmFJILykqAJ5KmOsBNl7gK12NK9BFq1WHUseaDM+bFsk9nsrxBotaedC0loAIPlO1C4fYuXHrzVaFCzLhKvBnuT4BCY-cUbShWTLsKJ8jdvRzFStCisl40rNeI6pSA0A-5cwAgC1Hc8dRV-fnjXJkaErw5xK65M3ObU2yWyCk+OgUvoKhCqmVlRlQgsqnUiWZ7Kkxbr2DW8qAE3hWfKlQAGvUHOfzVcU4oIZRiwZ6fCoXGOTXSV-FPk2UZnPTEhKs5J0JkpgDIDMc0A7JAgCiCNV41r2qyJJQDSRFEEH2T69KUQSbXZTR4afQxHbL-ZFL5gqjaCYX3qaIKGmT-Jti0y9FGNg13K1inzKdgEK0GQq0kO-IEokSJ2FE1ybAI3V+LpRO6wJXCuCVEVVZqhYwBYSeBWEngMbDjueAObP5hgUAbwBev5LyAZEpA1RAlJDiPqf5o8P+ZzAAX4y7VX6imk6tgmdqilPa3+s7DKnAbB1U+ZBcONPloLqojS+BhhOwkFIzhcJf-t8qQ3oRSFvUmORuIeGeKhlOtZbimsYXpqMsNDWFXupFRHrWhT+F-PgCRj4hA+xq8sU4IlbSdUlj7WsRiIzz-ifxuefJYo3E2XLPV-A9YfWzdHmkFNAUtTTX3QkvK+uiWpvr00skESfpAAn5Svl6VfZXO20YzSCpoVO9uisqxMZCrw3QrAmsK+GfnDCbBT6W3C+GOxAUiYqUuZYjYrevSk6IjYIjXjfdQP6+Egtx0jtTSvVYurRSKdcOYypk0xaHpcWh5VkR9l2Tp5a2tLekP5U9A2ltnOdaGIBWjtDNX2BNWuqlW+tzNW63DQqrqpehKeKq+zffmCmhT924UvAFIBPZf5K1jg+9X7WNSx9dppUALdqhJk0CcRnAhmnQ1-VuqpmqjDSUBvKVMzGmnpXYQ1Dr5GxxxXMkNdrnSSzj8JfbJeX9PxR8jVx+mnHnaJckmasNZm8FTUJTmwz8Ns0qlgqPhWXAWqAAH9BH4BVALgXjgGG6pDg8AofLFa-OzCi7etrhE2S+u4GZLjs-417muqpmQ7uaynTuU7M7F9z6uKvAQQtrHI0iv0U5QNXOXW3dtNt9BNii0qdim8ABwzBzihsBnHaCOxW6WdTt9ZJyKtqaqjvhvq20lgm9HJjOrKjBntdmpGhSJEwvZk5xdAaPUZQJ35mVONTaw6ZLzbVTVu5v4vKWq15pLDXcM2+Hbor1Y+qoSfqyDgGtW1tQTd2ClDppvRTW7uRREzpTGrFlircGp28SkSVomjK5Vaa6rRmsXGsK2Fh6kOmmWMDDpZkqohZAc14iPz1pwpTaa4TMrAKG13g-raSqjqbURN+Il1YCmz0MKrpjZObYjvumjyds4G-vKhI2ZvL4ymO9LSNVwX4SuRxuXLVlRtyiyX9tvGrq3uGllVadFHenQrN73T9bN9HfQP8LzmJgzArcRQN9qGFOC8VAdHabWP2mNymBo8FgdYlC0TbABU2lRn3Mi1RCddLK5HXZ2W2v80tGO4NRgsKLhrgB2Qp-eN0O1Tcl19wjDVTvXU07N10Mv-YfOs1TLCNcdM+du1aF8BjgmIIwuQDc34DUorcGfRsQ34QDJdCBhtUgd-EC8W1wW6XonSpVb6sDZbS6SUv7WH6R5lSx6eytaZkGZ4l+87NfvSF37skAE6yfXt+WN6mDIMzDJRLO3UTIZHBiFfKsYk+7aM6TJGdmPmSyphEjJPAJoWETmAoAe7KGLcFVBwBNCbGgmr9qTQ7FZFG2fZUxEUUHCsRa+7YhvpU6q6-1lyrXYkR5qAaqp+uzXsLU5WWGko1hqxbYfQgIa15umskCKs2LdLgZQKynSVp3leGcNDEz4SzCn4D7VV58wPcgHzUlYVIRagABp3isggfJ8QJwu6pHiEH4jNsL1T3DaegyhjcMod3AQ62yXa1TEUugW9qMpZUiIRVML2ik4h1SlpkZNS0pbJxoa3HZltaPOKgBWWgSvltwqf7QVl0DvZKK71e6atd22FceNCXThVC+kWVCpCdqyoeAyx9nQtDxoJSI+Ui3fjHpbnPqrVe6PY2SukaLocRlKxGZgZtEXK9978g-U1wqUez9JRi-Ok8pg0G9Z5OEx6lY20010idQ7fLaKrjX9KPF-R3fbLI92Wae9PBmFXwdE0CGwlrQyetPSoDaULAIhzHDoQVSb1vA5hSws-ieD70sVWJrowiNGoCbn1WRvQDketlboeNOIz+vc0dPysjF1MjJS7NKXOiCDjJxCf6vi02ZR1Y4ig5yYKTUH0G2W7kV0qAHhnwx3RvpU7tKFTtt54p7DZKa4MTKZTQS5nQFQwEB7pkqMzVd1R1V6qkw6OfhRIEeCmEElcU3FZcwzZoiPITalA2SdyWMDTlmB85fQUuOSa8DRpBk0jsHEsmWmtSnZCZNy6WGiYrUuEg-sXztG-jDuuMxvITMrr3Dbeudt4bp3bqbtw9OUzMthNcB-hzJGIxyS5I4B8y-Afkh5o2Kmr+C13DJuccJVSdiZWIuPg6qYgZ7ldWfbQxdKhISb5w8JT0yBpA13KDdELJ5Q1LiohnILlu7JBN1oNzmyd5SHqeTq8V48xTgKJNUMaq3bm1mzEhU3CdaEar38RZ3VYmBuDHAtgGptAFebWMbHuQVA+s-5uJONrSTLMFRbbMKNnHM1O+tArgeuV6KfTrK7YUOf7xG6oWjR7+JQfN3UG4LEZwhU63xQrjFzsawFfGud1DTgTPdLC74ZGN7nszAQTZvucqDHrT1LHPADVnRyWBoDOMui84LxMvq9kSh4k091YvXTWzNkzQ16ov4w7K2fcnRbW2ZWCWIOJh-0xHCU0tTzFElips0YJS2KABajIAR8GQv5pHdLe9S-HNM0Xaf9UOa7X4eVVBHWhKAAEfu3CA4BhFeAIIAc3PCiK8aP+dLik3ot4nuN38I0fxu1TNmLE5J9s5VwuP2iAJBh-s0fuMM94RLNFdHTPF5WIcoLv4bk3ON20ADHDK+RvWhvU5AnSt4ojc7-q3OMSHtLCPmIZcH0hDOFDLeGEiDUh4CiAVoWLpxnIHZg3ChsraXQwtUbZCTN8J8+1f-FoGrkFJoit5Z4sLY1J2rfi32MIODn2Vxnfa5NccJjmoFMV5QXJdgztHOAb+qbiLPf0ZK1rAxvJZtbGU6XyeTO-dURtZ0gHWhCJx2lYPMvsscAmorFcOxLI4gERyNwAklZEYs3HzwOw-naobmK7LRBU3Q6mPC20nbj2u6LSyqcga9x5-eCG98jeljBK9bc4OV8uNziSgBZMQU3Z1c61hMbmVoftYBd4CRcruluUbueNuHWpqwYAALpAA`)),
c=new Aircraft(parts_JSON,weapon_JSON,!1),d=0,e=0;for(let m=0;m<a.acft.length;m++){var f=a.acft[m];let u=b[m];try{var g=LZString.decompressFromEncodedURIComponent(f),h=_stringToArrayBuffer(g),k=new Deserialize(h);c.deserialize(k);c.CalculateStats();var l=c.GetDerivedStats();if(u.name==c.name){var n=Object.keys(l);f=!0;for(let q of n)if(u[q]!=l[q]){console.log(StringFmt.Format("{0} {1} does not match {2} for {3}",q,l[q],u[q],c.name));f=!1;break}f&&d++}else console.log(StringFmt.Format("Name {0} does not match {1}",
c.name,u.name))}catch(q){console.log("Compressed Query Parameter Failed."),console.log(q),c.Reset()}e++}console.log(StringFmt.Format("{0} of {1} planes were correct.",d,e))}
class JSON2CSV{constructor(){this.errorMissingSeparator="Missing separator option.";this.errorEmpty="JSON is empty.";this.errorEmptyHeader="Could not detect header. Ensure first row contains your column headers.";this.errorNotAnArray="Your JSON must be an array or an object.";this.errorItemNotAnObject="Item in array is not an object: {0}"}flattenArray(a,b=[]){function c(l,n){l=l.slice(0);if(!Array.isArray(n))return l;for(let m=0;m<n.length;m++)-1===l.indexOf(n[m])&&l.push(n[m]);return l}function d(l,
n){l=l||{};for(let m in n)l[m]="object"===typeof n[m]?d(l[m],n[m]):n[m];return l}var e=[];for(let l=0;l<a.length;l++){var f=a[l];let n={},m={};var g=1;if(void 0!==f&&null!==f&&(!this.isObject(f)||Array.isArray(f)))throw this.errorItemNotAnObject.replace("{0}",JSON.stringify(f));for(var h=this.getKeys(f),k=0;k<h.length;k++){let u=f[h[k]],q=c(b,[h[k]]),x=q.join(".");Array.isArray(u)?(m[x]=this.flattenArray(u,q),g+=m[x].length):n[x]=u}if(1==g)e.push(n);else for(f=this.getKeys(m),g=0;g<f.length;g++)for(h=
f[g],k=0;k<m[h].length;k++)e.push(d(d({},n),m[h][k]))}return e}isObject(a){return a&&"object"==typeof a}getKeys(a){return this.isObject(a)?Object.keys(a):[]}convert(a,b){b||={};if(!this.isObject(a))throw this.errorNotAnArray;Array.isArray(a)||(a=[a]);var c=b.separator||",";if(!c)throw this.errorMissingSeparator;b.flatten&&(a=this.flattenArray(a));for(var d=[],e=[],f=0;f<a.length;f++){var g=a[f],h={};if(void 0!==g&&null!==g&&(!this.isObject(g)||Array.isArray(g)))throw this.errorItemNotAnObject.replace("{0}",
JSON.stringify(g));var k=this.getKeys(g);for(let l=0;l<k.length;l++){let n=k[l];-1===d.indexOf(n)&&d.push(n);let m=g[n];if(void 0!==m||null!==m)"string"==typeof m?(h[n]='"'+m.replace(/"/g,b.output_csvjson_variant?'\\"':'""')+'"',b.output_csvjson_variant&&(h[n]=h[n].replace(/\n/g,"\\n"))):(h[n]=JSON.stringify(m),b.output_csvjson_variant||!this.isObject(m)&&!Array.isArray(m)||(h[n]='"'+h[n].replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"'))}e.push(h)}a=[];for(f=0;f<d.length;f++)a.push('"'+d[f].replace(/"/g,
b.output_csvjson_variant?'\\"':'""')+'"');a=a.join(c)+"\n";for(f=0;f<e.length;f++){g=e[f];h=[];for(k=0;k<d.length;k++)h.push(g[d[k]]||(b.output_csvjson_variant?"null":""));a+=h.join(c)+(f<e.length-1?"\n":"")}return a}}
class AlterStats extends Part{constructor(){super();var a=JSON.parse(window.localStorage.getItem("CustomParts"));a||(a=[],window.localStorage.setItem("CustomParts",JSON.stringify([])));this.custom_parts=[];for(let b of a)this.custom_parts.push({name:b.name,stats:new Stats(b.stats),qty:0})}toJSON(){var a=[],b=[];for(let c of this.custom_parts)b.push({name:c.name,stats:c.stats.toJSON(),qty:c.qty}),0<c.qty&&a.push({name:c.name,stats:c.stats.toJSON(),qty:c.qty});window.localStorage.setItem("CustomParts",
JSON.stringify(b));return{part_list:a}}fromJSON(a,b){for(let c of this.custom_parts)c.qty=0;for(let c of a.part_list)a=this.custom_parts.findIndex(d=>d.name==c.name),-1==a?this.custom_parts.push({name:c.name,stats:new Stats(c.stats),qty:c.qty}):this.custom_parts[a].qty=c.qty}serialize(a){var b=[];for(let c of this.custom_parts)0<c.qty&&b.push({name:c.name,stats:c.stats,qty:c.qty});a.PushNum(b.length);for(let c of b)a.PushString(c.name),c.stats.serialize(a),a.PushNum(c.qty)}deserialize(a){for(var b of this.custom_parts)b.qty=
0;b=a.GetNum();for(let d=0;d<b;d++){let e=a.GetString(),f=new Stats;f.deserialize(a);let g=a.GetNum();var c=this.custom_parts.findIndex(h=>h.name==e);-1==c?(c=this.custom_parts.length,this.custom_parts.push({name:e,stats:f,qty:g})):this.custom_parts[c].qty=g}}ClearAll(){for(let a of this.custom_parts)a.qty=0}AddPart(a,b){var c=0+Math.abs(b.drag);c+=Math.abs(b.mass);c+=Math.abs(b.wetmass);c+=Math.abs(b.bomb_mass);c+=Math.abs(b.cost);c+=Math.abs(b.upkeep);c+=Math.abs(b.liftbleed);c+=Math.abs(b.wingarea);
c+=Math.abs(b.control);c+=Math.abs(b.pitchstab);c+=Math.abs(b.latstab);c+=Math.abs(b.maxstrain);c+=Math.abs(b.structure);c+=Math.abs(b.toughness);c+=Math.abs(b.power);c+=Math.abs(b.fuelconsumption);c+=Math.abs(b.fuel);c+=Math.abs(b.charge);c+=Math.abs(b.crashsafety);c+=Math.abs(b.visibility);c+=Math.abs(b.escape);c+=Math.abs(b.reliability);c+=Math.abs(b.warnings.length);0!=c&&(c=this.custom_parts.findIndex(d=>d.name==a),-1!=c?this.custom_parts[c].stats=b:this.custom_parts.push({name:a,stats:b,qty:0}),
this.custom_parts.sort((d,e)=>d.name.localeCompare(e.name)),this.CalculateStats())}RemovePart(a){var b=this.custom_parts.findIndex(c=>c.name==a);-1!=b&&this.custom_parts.splice(b,1);this.CalculateStats()}GetParts(){return this.custom_parts}SetUsedPart(a,b){this.custom_parts[a].qty=b;this.CalculateStats()}PartStats(){var a=new Stats;for(let b of this.custom_parts)if(0<b.qty){let c=b.stats.Clone();c=c.Multiply(b.qty);a=a.Add(c)}return a}GetElectrics(){var a=[];for(let b of this.custom_parts)0<b.qty&&
(a=this.FormatEquipment(a,b.name,b.stats.charge));return{storage:0,equipment:a}}SetCalculateStats(a){this.CalculateStats=a}}
class AlterStats_HTML extends Display{constructor(a){super();this.alter=a;a=window.getElementById("alter_table").insertRow();this.add_cell=a.insertCell();this.edit_cell=a.insertCell();this.InitAddCell();this.InitEditCell()}InitAddCell(){this.add_list=[];this.add_fs=CreateFlexSection(this.add_cell);let a=document.createElement("LABEL");a.textContent=lu("Alter Select Part");this.add_fs.div1.appendChild(a);let b=document.createElement("LABEL");b.textContent=lu("Alter Quantity");this.add_fs.div2.appendChild(b);
a.style.marginLeft="0.25em";a.style.marginRight="0.5em";b.style.marginLeft="0.25em";b.style.marginRight="0.5em"}InitEditCell(){this.name=document.createElement("INPUT");this.drag=document.createElement("INPUT");this.mass=document.createElement("INPUT");this.wmas=document.createElement("INPUT");this.bmas=document.createElement("INPUT");this.cost=document.createElement("INPUT");this.upkp=document.createElement("INPUT");this.lfbd=document.createElement("INPUT");this.area=document.createElement("INPUT");
this.ctrl=document.createElement("INPUT");this.pstb=document.createElement("INPUT");this.lstb=document.createElement("INPUT");this.rstn=document.createElement("INPUT");this.strc=document.createElement("INPUT");this.tugh=document.createElement("INPUT");this.powr=document.createElement("INPUT");this.fcon=document.createElement("INPUT");this.fuel=document.createElement("INPUT");this.chrg=document.createElement("INPUT");this.sfty=document.createElement("INPUT");this.visi=document.createElement("INPUT");
this.escp=document.createElement("INPUT");this.rely=document.createElement("INPUT");this.sprl=document.createElement("INPUT");var a=CreateFlexSection(this.edit_cell),b=CreateFlexSection(a.div1);FlexText(lu("Alter Part Name"),this.name,b);var c=CreateFlexSection(b.div1);b=CreateFlexSection(b.div2);a=CreateFlexSection(a.div2);FlexInput("Cost",this.cost,a);FlexInput("Mass",this.mass,c);FlexInput("Wet Mass",this.wmas,b);FlexInput("Bomb Mass",this.bmas,a);FlexInput("Drag",this.drag,c);FlexInput("Lift Bleed",
this.lfbd,b);FlexInput("Wing Area",this.area,a);FlexInput("Control",this.ctrl,c);FlexInput("Pitch Stability",this.pstb,b);FlexInput("Lateral Stability",this.lstb,a);FlexInput("Raw Strain",this.rstn,c);FlexInput("Structure",this.strc,b);FlexInput("Toughness",this.tugh,a);FlexInput("Power",this.powr,c);FlexInput("Fuel Consumption",this.fcon,b);FlexInput("Fuel",this.fuel,a);FlexInput("Visibility",this.visi,c);FlexInput("Crash Safety",this.sfty,b);FlexInput("Escape",this.escp,a);FlexInput("Charge",this.chrg,
c);FlexInput("Upkeep",this.upkp,b);FlexInput("Reliability",this.rely,a);CreateText(lu("Alter Part Special Rules"),this.sprl,this.edit_cell,!1);this.drag.min="";this.mass.min="";this.wmas.min="";this.bmas.min="";this.cost.min="";this.upkp.min="";this.lfbd.min="";this.area.min="";this.ctrl.min="";this.pstb.min="";this.lstb.min="";this.rstn.min="";this.strc.min="";this.tugh.min="";this.powr.min="";this.fcon.min="";this.fuel.min="";this.chrg.min="";this.sfty.min="";this.visi.min="";this.escp.min="";this.rely.min=
"";this.sprl.size=47;c=document.createElement("SPAN");this.sel=document.createElement("SELECT");c.appendChild(this.sel);this.sel.selectedIndex=-1;this.add=document.createElement("BUTTON");CreateButton("Add Part",this.add,c,!1);this.rem=document.createElement("BUTTON");CreateButton("Remove Part",this.rem,c,!1);this.edit_cell.appendChild(document.createElement("BR"));this.edit_cell.appendChild(c);this.add.onclick=()=>{let d=new Stats;d.drag=this.drag.valueAsNumber;d.mass=this.mass.valueAsNumber;d.wetmass=
this.wmas.valueAsNumber;d.bomb_mass=this.bmas.valueAsNumber;d.cost=this.cost.valueAsNumber;d.upkeep=this.upkp.valueAsNumber;d.liftbleed=this.lfbd.valueAsNumber;d.wingarea=this.area.valueAsNumber;d.control=this.ctrl.valueAsNumber;d.pitchstab=this.pstb.valueAsNumber;d.latstab=this.lstb.valueAsNumber;d.maxstrain=this.rstn.valueAsNumber;d.structure=this.strc.valueAsNumber;d.toughness=this.tugh.valueAsNumber;d.power=this.powr.valueAsNumber;d.fuelconsumption=this.fcon.valueAsNumber;d.fuel=this.fuel.valueAsNumber;
d.charge=this.chrg.valueAsNumber;d.crashsafety=this.sfty.valueAsNumber;d.visibility=this.visi.valueAsNumber;d.escape=this.escp.valueAsNumber;d.reliability=this.rely.valueAsNumber;this.sprl.value=this.sprl.value.trim();0<this.sprl.value.length&&d.warnings.push({source:this.name.value,warning:this.sprl.value,color:WARNING_COLOR.WHITE});this.alter.AddPart(this.name.value,d);this.UpdateSelect();this.sel.selectedIndex=-1};this.rem.onclick=()=>{this.alter.RemovePart(this.name.value);this.ResetInputs();
this.UpdateSelect();this.sel.selectedIndex=-1};this.sel.onchange=()=>{let d=this.alter.GetParts()[this.sel.selectedIndex];this.name.value=d.name;this.drag.valueAsNumber=d.stats.drag;this.mass.valueAsNumber=d.stats.mass;this.wmas.valueAsNumber=d.stats.wetmass;this.bmas.valueAsNumber=d.stats.bomb_mass;this.cost.valueAsNumber=d.stats.cost;this.upkp.valueAsNumber=d.stats.upkeep;this.lfbd.valueAsNumber=d.stats.liftbleed;this.area.valueAsNumber=d.stats.wingarea;this.ctrl.valueAsNumber=d.stats.control;this.pstb.valueAsNumber=
d.stats.pitchstab;this.lstb.valueAsNumber=d.stats.latstab;this.rstn.valueAsNumber=d.stats.maxstrain;this.strc.valueAsNumber=d.stats.structure;this.tugh.valueAsNumber=d.stats.toughness;this.powr.valueAsNumber=d.stats.power;this.fcon.valueAsNumber=d.stats.fuelconsumption;this.fuel.valueAsNumber=d.stats.fuel;this.chrg.valueAsNumber=d.stats.charge;this.sfty.valueAsNumber=d.stats.crashsafety;this.visi.valueAsNumber=d.stats.visibility;this.escp.valueAsNumber=d.stats.escape;this.rely.valueAsNumber=d.stats.reliability;
var e=[];for(let f of d.stats.warnings)e.push(f.warning);this.sprl.value=StringFmt.Join("   ",e);this.sel.selectedIndex=-1};this.ResetInputs();this.UpdateSelect()}ResetInputs(){this.name.value="Default";this.drag.valueAsNumber=0;this.mass.valueAsNumber=0;this.wmas.valueAsNumber=0;this.bmas.valueAsNumber=0;this.cost.valueAsNumber=0;this.upkp.valueAsNumber=0;this.lfbd.valueAsNumber=0;this.area.valueAsNumber=0;this.ctrl.valueAsNumber=0;this.pstb.valueAsNumber=0;this.lstb.valueAsNumber=0;this.rstn.valueAsNumber=
0;this.strc.valueAsNumber=0;this.tugh.valueAsNumber=0;this.powr.valueAsNumber=0;this.fcon.valueAsNumber=0;this.fuel.valueAsNumber=0;this.chrg.valueAsNumber=0;this.sfty.valueAsNumber=0;this.visi.valueAsNumber=0;this.escp.valueAsNumber=0;this.rely.valueAsNumber=0;this.sprl.value=""}UpdateSelect(){for(;this.sel.options.length;)this.sel.remove(this.sel.options.length-1);var a=this.alter.GetParts();for(let b of a)a=document.createElement("OPTION"),a.textContent=b.name,this.sel.add(a);this.sel.selectedIndex=
-1}UpdateDisplay(){this.UpdateSelect();var a=this.alter.GetParts();for(let b=0;b<a.length;b++){if(this.add_list.length<=b){let c={lbl:document.createElement("LABEL"),qty:document.createElement("INPUT")};c.lbl.style.marginLeft="0.25em";c.lbl.style.marginRight="0.5em";c.qty.type="number";c.qty.min="0";c.qty.step="1";c.qty.valueAsNumber=0;c.qty.onchange=()=>{this.alter.SetUsedPart(b,c.qty.valueAsNumber)};this.add_fs.div1.appendChild(c.lbl);this.add_fs.div2.appendChild(c.qty);this.add_list.push(c)}this.add_list[b].lbl.textContent=
a[b].name;this.add_list[b].qty.valueAsNumber=a[b].qty}for(;this.add_list.length>a.length;)this.add_list[this.add_list.length-1].lbl.remove(),this.add_list[this.add_list.length-1].qty.remove(),this.add_list.pop()}}
class Rotor_HTML extends Display{constructor(a){super();this.rotor=a;document.getElementById("lbl_rotor").textContent=lu("Rotor Section Title");this.div=document.getElementById("Rotors");this.wing_div=document.getElementById("Wings");this.reinforce_div=document.getElementById("Reinforcements");this.control_div=document.getElementById("ControlSurfaces");a=document.getElementById("rotor_table");var b=document.createDocumentFragment();this.InitAutogyro(b);this.InitHelicopter(b);a.appendChild(b)}InitAutogyro(a){this.auto_header=
insertRow(a);CreateTH(this.auto_header,lu("Rotor Rotor"));CreateTH(this.auto_header,lu("Rotor Material"));CreateTH(this.auto_header,lu("Rotor Accessories"));CreateTH(this.auto_header,lu("Rotor Stats"));this.auto_row=insertRow(a);a=this.auto_row.insertCell();a=CreateFlexSection(a);this.auto_min=document.createElement("LABEL");FlexDisplay(lu("Rotor Minimum Span"),this.auto_min,a);this.auto_span=document.createElement("INPUT");FlexInput(lu("Rotor Span"),this.auto_span,a);this.auto_span.onchange=()=>
{this.rotor.SetRotorSpan(this.auto_span.valueAsNumber)};a=this.auto_row.insertCell();a=CreateFlexSection(a);this.auto_mat=document.createElement("SELECT");FlexSelect(lu("Rotor Material"),this.auto_mat,a);for(var b of this.rotor.GetCantileverList())a=document.createElement("OPTION"),a.text=lu(b.name),this.auto_mat.add(a);this.auto_mat.onchange=()=>{this.rotor.SetCantilever(this.auto_mat.selectedIndex)};b=this.auto_row.insertCell();b=CreateFlexSection(b);this.auto_clutch=document.createElement("INPUT");
FlexCheckbox(lu("Rotor Clutched Rotor"),this.auto_clutch,b);this.auto_clutch.onchange=()=>{this.rotor.SetAccessory(this.auto_clutch.checked)};this.InitAutogyroStats(this.auto_row.insertCell())}InitAutogyroStats(a){a.className="inner_table";var b=document.createElement("TABLE");b.className="inner_table";a.appendChild(b);a=b.insertRow();CreateTH(a,lu("Stat Drag"));CreateTH(a,lu("Stat Mass"));CreateTH(a,lu("Stat Cost"));a=b.insertRow();this.a_drag=a.insertCell();this.a_mass=a.insertCell();this.a_cost=
a.insertCell();a=b.insertRow();CreateTH(a,lu("Rotor Area"));CreateTH(a,"");CreateTH(a,"");b=b.insertRow();this.a_area=b.insertCell();b.insertCell();b.insertCell()}UpdateAutogyroStats(){this.auto_span.valueAsNumber=this.rotor.GetRotorSpan();this.auto_mat.selectedIndex=this.rotor.GetCantilever();this.auto_min.innerText=""+this.rotor.GetSizingSpan();this.auto_clutch.checked=this.rotor.GetAccessory();var a=this.rotor.PartStats();BlinkIfChanged(this.a_drag,a.drag.toString(),!1);BlinkIfChanged(this.a_mass,
a.mass.toString(),!1);BlinkIfChanged(this.a_cost,a.cost.toString(),!1);BlinkIfChanged(this.a_area,a.wingarea.toString(),!0)}InitHelicopter(a){this.heli_header=insertRow(a);CreateTH(this.heli_header,lu("Rotor Rotor"));CreateTH(this.heli_header,lu("Rotor Material"));CreateTH(this.heli_header,lu("Rotor Accessories"));CreateTH(this.heli_header,lu("Rotor Stats"));this.heli_row=insertRow(a);a=this.heli_row.insertCell();a=CreateFlexSection(a);this.heli_count=document.createElement("INPUT");FlexInput(lu("Rotor Number of Rotors"),
this.heli_count,a);this.heli_count.onchange=()=>{this.rotor.SetRotorCount(this.heli_count.valueAsNumber)};this.heli_min=document.createElement("LABEL");FlexDisplay(lu("Rotor Ideal Rotor Span"),this.heli_min,a);this.heli_span=document.createElement("INPUT");FlexInput(lu("Rotor Span"),this.heli_span,a);this.heli_span.min="";this.heli_span.onchange=()=>{this.rotor.SetRotorSpan(this.heli_span.valueAsNumber)};this.heli_stagger=document.createElement("SELECT");FlexSelect(lu("Rotor Stagger"),this.heli_stagger,
a);var b=this.rotor.GetStaggerList();for(c of b)b=document.createElement("OPTION"),b.text=lu(c.name),this.heli_stagger.add(b);this.heli_stagger.onchange=()=>{this.rotor.SetStagger(this.heli_stagger.selectedIndex)};this.heli_blade_count=document.createElement("SELECT");FlexSelect(lu("Rotor Blade Count"),this.heli_blade_count,a);var c=this.rotor.GetBladeList();for(d of c)c=document.createElement("OPTION"),c.textContent=d.name,this.heli_blade_count.add(c);this.heli_blade_count.onchange=()=>{this.rotor.SetBladeCount(this.heli_blade_count.selectedIndex)};
var d=this.heli_row.insertCell();d=CreateFlexSection(d);this.heli_mat=document.createElement("SELECT");FlexSelect(lu("Rotor Rotor Material"),this.heli_mat,d);for(var e of this.rotor.GetCantileverList())d=document.createElement("OPTION"),d.text=lu(e.name),this.heli_mat.add(d);this.heli_mat.onchange=()=>{this.rotor.SetCantilever(this.heli_mat.selectedIndex)};e=this.heli_row.insertCell();e=CreateFlexSection(e);this.heli_shafts=document.createElement("INPUT");FlexCheckbox(lu("Rotor Motor Cross-link"),
this.heli_shafts,e);this.heli_shafts.onchange=()=>{this.rotor.SetAccessory(this.heli_shafts.checked)};this.InitHelicopterStats(this.heli_row.insertCell())}InitHelicopterStats(a){a.className="inner_table";var b=document.createElement("TABLE");b.className="inner_table";a.appendChild(b);a=b.insertRow();CreateTH(a,lu("Stat Drag"));CreateTH(a,lu("Stat Mass"));CreateTH(a,lu("Stat Cost"));a=b.insertRow();this.h_drag=a.insertCell();this.h_mass=a.insertCell();this.h_cost=a.insertCell();a=b.insertRow();CreateTH(a,
lu("Rotor Area"));CreateTH(a,lu("Stat Reliability"));CreateTH(a,lu("Reinforcement Aircraft Max Strain"));b=b.insertRow();this.h_area=b.insertCell();this.h_rely=b.insertCell();this.h_strn=b.insertCell()}UpdateHelicopterStats(){this.heli_count.valueAsNumber=this.rotor.GetRotorCount();1==this.rotor.GetRotorCount()?this.heli_count.step="1":this.heli_count.step="2";this.heli_min.innerText=""+this.rotor.GetSizingSpan();this.heli_span.valueAsNumber=this.rotor.GetRotorSpan();var a=this.rotor.CanStagger();
for(let b=0;b<a.length;b++)this.heli_stagger.options[b].disabled=!a[b];this.heli_stagger.selectedIndex=this.rotor.GetStagger();this.heli_mat.selectedIndex=this.rotor.GetCantilever();this.heli_shafts.checked=this.rotor.GetAccessory();this.heli_blade_count.selectedIndex=this.rotor.GetBladeCountIdx();a=this.rotor.PartStats();BlinkIfChanged(this.h_drag,a.drag.toString(),!1);BlinkIfChanged(this.h_mass,a.mass.toString(),!1);BlinkIfChanged(this.h_cost,a.cost.toString(),!1);BlinkIfChanged(this.h_area,a.wingarea.toString(),
!0);BlinkIfChanged(this.h_rely,a.reliability.toString(),!0)}UpdateMaxStrain(a){BlinkIfChanged(this.h_strn,a.toString(),!0)}UpdateDisplay(){switch(this.rotor.GetType()){case AIRCRAFT_TYPE.AIRPLANE:this.div.hidden=!0;this.wing_div.hidden=!1;this.reinforce_div.hidden=!1;this.control_div.hidden=!1;break;case AIRCRAFT_TYPE.AUTOGYRO:this.div.hidden=!1;this.wing_div.hidden=!1;this.reinforce_div.hidden=!1;this.control_div.hidden=!1;this.heli_header.hidden=!0;this.heli_row.hidden=!0;this.auto_header.hidden=
!1;this.auto_row.hidden=!1;this.UpdateAutogyroStats();break;case AIRCRAFT_TYPE.HELICOPTER:this.div.hidden=!1,this.wing_div.hidden=!0,this.reinforce_div.hidden=!0,this.control_div.hidden=!0,this.auto_header.hidden=!0,this.auto_row.hidden=!0,this.heli_header.hidden=!1,this.heli_row.hidden=!1,this.UpdateHelicopterStats()}}}
class Used_HTML extends Display{constructor(a){super();this.used=a;document.getElementById("lbl_used").textContent=lu("Used Section Title");this.tbl=document.getElementById("tbl_used");a=document.createDocumentFragment();var b=insertRow(a);CreateTH(b,lu("Used Effect"));CreateTH(b,lu("Used Description"));CreateTH(b,lu("Used Penalties(+) <br/> Benefits(-)"));this.InitTable(a);this.tbl.appendChild(a)}InitTable(a){this.burnt_out=document.createElement("INPUT");this.ragged=document.createElement("INPUT");
this.hefty=document.createElement("INPUT");this.sticky_guns=document.createElement("INPUT");this.weak=document.createElement("INPUT");this.fragile=document.createElement("INPUT");this.leaky=document.createElement("INPUT");this.sluggish=document.createElement("INPUT");var b=insertRow(a);b.insertCell().textContent=lu("Used Burnt Out");b.insertCell().textContent=lu("Used Burnt Out Description");b=b.insertCell();CreateInput("",this.burnt_out,b,!1);b=insertRow(a);b.insertCell().textContent=lu("Used Ragged");
b.insertCell().textContent=lu("Used Ragged Description");b=b.insertCell();CreateInput("",this.ragged,b,!1);b=insertRow(a);b.insertCell().textContent=lu("Used Hefty");b.insertCell().textContent=lu("Used Hefty Description");b=b.insertCell();CreateInput("",this.hefty,b,!1);b=insertRow(a);b.insertCell().textContent=lu("Used Sticky Guns");b.insertCell().textContent=lu("Used Sticky Guns Description");b=b.insertCell();CreateInput("",this.sticky_guns,b,!1);b=insertRow(a);b.insertCell().textContent=lu("Used Weak");
b.insertCell().textContent=lu("Used Weak Description");b=b.insertCell();CreateInput("",this.weak,b,!1);b=insertRow(a);b.insertCell().textContent=lu("Used Fragile");b.insertCell().textContent=lu("Used Fragile Description");b=b.insertCell();CreateInput("",this.fragile,b,!1);b=insertRow(a);b.insertCell().textContent=lu("Used Leaky");b.insertCell().textContent=lu("Used Leaky Description");b=b.insertCell();CreateInput("",this.leaky,b,!1);b=insertRow(a);b.insertCell().textContent=lu("Used Sluggish");b.insertCell().textContent=
lu("Used Sluggish Description");b=b.insertCell();CreateInput("",this.sluggish,b,!1);this.burnt_out.onchange=()=>{this.used.burnt_out=this.burnt_out.valueAsNumber;this.used.TriggerCS()};this.ragged.onchange=()=>{this.used.ragged=this.ragged.valueAsNumber;this.used.TriggerCS()};this.hefty.onchange=()=>{this.used.hefty=this.hefty.valueAsNumber;this.used.TriggerCS()};this.sticky_guns.onchange=()=>{this.used.sticky_guns=this.sticky_guns.valueAsNumber;this.used.TriggerCS()};this.weak.onchange=()=>{this.used.weak=
this.weak.valueAsNumber;this.used.TriggerCS()};this.fragile.onchange=()=>{this.used.fragile=this.fragile.valueAsNumber;this.used.TriggerCS()};this.leaky.onchange=()=>{this.used.leaky=this.leaky.valueAsNumber;this.used.TriggerCS()};this.sluggish.onchange=()=>{this.used.sluggish=this.sluggish.valueAsNumber;this.used.TriggerCS()};this.burnt_out.min="-1";this.burnt_out.max="1";this.ragged.min="-1";this.ragged.max="1";this.hefty.min="-1";this.hefty.max="1";this.sticky_guns.min="-1";this.sticky_guns.max=
"1";this.weak.min="-1";this.weak.max="1";this.fragile.min="-1";this.fragile.max="1";this.leaky.min="-1";this.leaky.max="1";this.sluggish.min="-1";this.sluggish.max="1"}UpdateDisplay(){this.burnt_out.valueAsNumber=this.used.burnt_out;this.ragged.valueAsNumber=this.used.ragged;this.hefty.valueAsNumber=this.used.hefty;this.sticky_guns.valueAsNumber=this.used.sticky_guns;this.weak.valueAsNumber=this.used.weak;this.fragile.valueAsNumber=this.used.fragile;this.leaky.valueAsNumber=this.used.leaky;this.sluggish.valueAsNumber=
this.used.sluggish}};
